

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="旺仔">
  <meta name="keywords" content="">
  
    <meta name="description" content="前言：我比师傅们的逆向都学的拉，所以我只能从buu开始学习基础呜呜  xorshift+F12字符串窗口然后F5反汇编看源代码 分析一下，该题是输入flag到v6，v6中数组前一项跟后一项进行异或运算赋给前一项然后我们需要找一下global到底代表什么，我们点进去看一下这并不是，我们再点进下面这串编码，这些字符串就是global接下来写脚本，运行就能出flag 12345678key&#x3D;[&amp;#x27">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUCTF RE（一）">
<meta property="og:url" content="http://mywangzai.github.io/2022/08/02/BUUCTFRE%EF%BC%88%E4%B8%80%EF%BC%89/index.html">
<meta property="og:site_name" content="旺仔的小窝">
<meta property="og:description" content="前言：我比师傅们的逆向都学的拉，所以我只能从buu开始学习基础呜呜  xorshift+F12字符串窗口然后F5反汇编看源代码 分析一下，该题是输入flag到v6，v6中数组前一项跟后一项进行异或运算赋给前一项然后我们需要找一下global到底代表什么，我们点进去看一下这并不是，我们再点进下面这串编码，这些字符串就是global接下来写脚本，运行就能出flag 12345678key&#x3D;[&amp;#x27">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/tj/image-20220802162641090.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/tj/000.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802163113186.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802163141826.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802163233975.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802163310796.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802163456073.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802163722444.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802163652150.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164105464.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164313166.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164342847.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164427584.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164456569.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164522904.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164606971.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164630589.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164651602.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164711649.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164744150.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164802604.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164824637.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164914270.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164936233.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164951780.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165031720.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165303162.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165107471.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165351178.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165424800.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165449596.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165527014.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165605546.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165626727.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165645888.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165710648.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170218561.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170246656.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170308338.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170342634.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170403553.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170446261.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170526409.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170541719.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170617438.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170642211.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170707159.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170725904.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170742997.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171422006.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170809245.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170845124.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170845124.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170904248.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170925527.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171004560.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171455619.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171535731.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171557822.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171632393.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171650853.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171707738.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171742989.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171801334.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171821364.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171839950.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171855179.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171917970.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171935375.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172003781.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172029608.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172052006.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172123497.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172143392.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172205313.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172249514.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172308875.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172337814.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172451025.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172526087.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172544107.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172601690.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172629979.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172652187.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172735875.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172943319.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172754180.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172811880.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802173027002.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802173041206.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802173059279.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802173119806.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802173139929.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802173158271.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802173212318.png">
<meta property="og:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802173241091.png">
<meta property="article:published_time" content="2022-08-02T03:05:02.000Z">
<meta property="article:modified_time" content="2022-11-28T14:53:07.654Z">
<meta property="article:author" content="旺仔">
<meta property="article:tag" content="BUUCTF">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/tj/image-20220802162641090.png">
  
  
  
  <title>BUUCTF RE（一） - 旺仔的小窝</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"mywangzai.github.io","root":"/","version":"1.9.3","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>f0re5ee&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="BUUCTF RE（一）"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-08-02 11:05" pubdate>
          2022年8月2日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          67k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          558 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">BUUCTF RE（一）</h1>
            
            
              <div class="markdown-body">
                
                <p>前言：我比师傅们的逆向都学的拉，所以我只能从buu开始学习基础呜呜<br /> </p>
<h2 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h2><p>shift+F12字符串窗口<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/tj/image-20220802162641090.png" srcset="/img/loading.gif" lazyload alt="image-20220802162641090"><br />然后F5反汇编看源代码<br /></p>
<p><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/tj/000.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />分析一下，该题是输入flag到v6，v6中数组前一项跟后一项进行异或运算赋给前一项<br />然后我们需要找一下global到底代表什么，我们点进去看一下<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802163113186.png" srcset="/img/loading.gif" lazyload alt="image-20220802163113186"><br />这并不是，我们再点进下面这串编码，这些字符串就是global<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802163141826.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />接下来写脚本，运行就能出flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">key=[<span class="hljs-string">&#x27;f&#x27;</span>,<span class="hljs-number">0xA</span>,<span class="hljs-string">&#x27;k&#x27;</span>,<span class="hljs-number">0xC</span>,<span class="hljs-string">&#x27;w&#x27;</span>,<span class="hljs-string">&#x27;&amp;&#x27;</span>,<span class="hljs-string">&#x27;O&#x27;</span>,<span class="hljs-string">&#x27;.&#x27;</span>,<span class="hljs-string">&#x27;@&#x27;</span>,<span class="hljs-number">0x11</span>,<span class="hljs-string">&#x27;x&#x27;</span>,<span class="hljs-number">0xD</span>,<span class="hljs-string">&#x27;Z&#x27;</span>,<span class="hljs-string">&#x27;;&#x27;</span>,<span class="hljs-string">&#x27;U&#x27;</span>,<span class="hljs-number">0x11</span>,<span class="hljs-string">&#x27;p&#x27;</span>,<span class="hljs-number">0x19</span>,<span class="hljs-string">&#x27;F&#x27;</span>,<span class="hljs-number">0x1F</span>,<span class="hljs-string">&#x27;v&#x27;</span>,<span class="hljs-string">&#x27;&quot;&#x27;</span>,<span class="hljs-string">&#x27;M&#x27;</span>,<span class="hljs-string">&#x27;#&#x27;</span>,<span class="hljs-string">&#x27;D&#x27;</span>,<span class="hljs-number">0xE</span>,<span class="hljs-string">&#x27;g&#x27;</span>,<span class="hljs-number">6</span>,<span class="hljs-string">&#x27;h&#x27;</span>,<span class="hljs-number">0xF</span>,<span class="hljs-string">&#x27;G&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;O&#x27;</span>]<br>flag = <span class="hljs-string">&#x27;f&#x27;</span>    <span class="hljs-comment">#取数组第一个值</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(key)):<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">isinstance</span>(key[i],<span class="hljs-built_in">int</span>)):  <br>        key[i]=<span class="hljs-built_in">chr</span>(key[i])          <span class="hljs-comment">#返回指定字符码所代表的字符</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(key)):<br>    flag+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(key[i]) ^ <span class="hljs-built_in">ord</span>(key[i-<span class="hljs-number">1</span>]))  <span class="hljs-comment">#a^b=c等价于a^c=b</span><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<p>这里记录几个函数（我菜鸡python不会但是还想用。。。）<br />isinstance(object, classinfo) object是值,classinfo是类型，<br />例如isinstance(1,int)返回的就是true，isinstance(1,str)返回的就是false</p>
<p>chr():<strong>chr</strong>函数来返回指定<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%AD%97%E7%AC%A6">字符</a>码所代表的字符，跟ASCII码有关。  比如chr(65)返回的就是大写字母A<br />ord():这里我简称逆chr()，就比如ord(‘A’)返回的就是65</p>
<h2 id="helloword"><a href="#helloword" class="headerlink" title="helloword"></a>helloword</h2><p>这道题是一道基础的apk逆向<br />使用APKIDE打开，找到主函数，里面就有<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802163233975.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<h2 id="reverse3"><a href="#reverse3" class="headerlink" title="reverse3"></a>reverse3</h2><p>1.先打开反汇编看源代码<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802163310796.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />2.点进去sub_4110BE函数查看，base64(其实真要说清楚我也说不清楚)，点进去aAbcdef<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802163456073.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<p>那一串看一下，知道这就是base64编码表<br /></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">.rdata:00417B30 aAbcdefghijklmn db <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#x27;</span><br></code></pre></td></tr></table></figure>

<p>3.查看一下主函数的str2是什么<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802163722444.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />这时候我们就有思路了，首先是先输入一串字符串也就是str，然后将这些字符串经过base64加密赋给v4，再将v4赋给Dest，再给Dest的每个字符后面加上下标值，最后判定Dest与str2是否一样，一样返回”right flag“<br />根据这个思路我们写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br>str2 = <span class="hljs-string">&quot;e3nifIH9b_C@n@dH&quot;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(str2)):<br>    flag += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(str2[i])-i)  <span class="hljs-comment">#把加的下标值减掉</span><br><span class="hljs-built_in">print</span>(base64.b64decode(flag))<br><br></code></pre></td></tr></table></figure>

<h2 id="不一样的flag"><a href="#不一样的flag" class="headerlink" title="不一样的flag"></a>不一样的flag</h2><p>(这道题我还不配深挖，只能先浅讲一下，记一下题型)<br />用IDA打开，打开字符串窗口，发现第一行是个奇怪的字符串，先记住它<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802163652150.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />我们还是照例看反汇编代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">char</span> v3; <span class="hljs-comment">// [esp+17h] [ebp-35h]</span><br>  <span class="hljs-keyword">int</span> v4; <span class="hljs-comment">// [esp+30h] [ebp-1Ch]</span><br>  <span class="hljs-keyword">int</span> v5; <span class="hljs-comment">// [esp+34h] [ebp-18h]</span><br>  <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// [esp+38h] [ebp-14h]</span><br>  <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [esp+3Ch] [ebp-10h]</span><br>  <span class="hljs-keyword">int</span> v8; <span class="hljs-comment">// [esp+40h] [ebp-Ch]</span><br><br>  __main();<br>  v4 = <span class="hljs-number">0</span>;<br>  v5 = <span class="hljs-number">0</span>;<br>  qmemcpy(&amp;v3, _data_start__, <span class="hljs-number">0x19</span>u); <span class="hljs-comment">//这里的datastart指的就是第一行字符串</span><br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;you can choose one action to execute&quot;</span>);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;1 up&quot;</span>);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;2 down&quot;</span>);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;3 left&quot;</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;4 right\n:&quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, &amp;v6);<br>    <span class="hljs-keyword">if</span> ( v6 == <span class="hljs-number">2</span> )    <span class="hljs-comment">//下</span><br>    &#123;<br>      ++v4;<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( v6 &gt; <span class="hljs-number">2</span> )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( v6 == <span class="hljs-number">3</span> )   <span class="hljs-comment">//左</span><br>      &#123;<br>        --v5;<br>      &#125;<br>      <span class="hljs-keyword">else</span>           <br>      &#123;<br>        <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">4</span> )<br>LABEL_13:<br>          <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>        ++v5;          <span class="hljs-comment">//右</span><br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      <span class="hljs-keyword">if</span> ( v6 != <span class="hljs-number">1</span> )  <br>        <span class="hljs-keyword">goto</span> LABEL_13;<br>      --v4;            <span class="hljs-comment">//上</span><br>    &#125;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">1</span>; ++i )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( *(&amp;v4 + i) &lt; <span class="hljs-number">0</span> || *(&amp;v4 + i) &gt; <span class="hljs-number">4</span> )    <span class="hljs-comment">// 不满足0&lt;=v4+i=&gt;4出局，也就是越界出局</span><br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( *((_BYTE *)&amp;v8 + <span class="hljs-number">5</span> * v4 + v5 - <span class="hljs-number">41</span>) == <span class="hljs-number">49</span> )  <span class="hljs-comment">//49是&quot;1&quot;，不能碰到&#x27;1&#x27;</span><br>      <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">if</span> ( *((_BYTE *)&amp;v8 + <span class="hljs-number">5</span> * v4 + v5 - <span class="hljs-number">41</span>) == <span class="hljs-number">35</span> )  <span class="hljs-comment">//35是&quot;#&quot;，碰到&#x27;#&#x27;就完成了迷宫</span><br>    &#123;<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\nok, the order you enter is the flag!&quot;</span>);<br>      <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>再看这个*11110100001010000101111#，一共25个字符，wp上说的是迷宫，确实是迷宫，但是我感觉我讲不透，不过还是把我明白的都详细地说一下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> ( *((_BYTE *)&amp;v8 + <span class="hljs-number">5</span> * v4 + v5 - <span class="hljs-number">41</span>) == <span class="hljs-number">49</span> )  <span class="hljs-comment">//49是&quot;1&quot;，不能碰到&#x27;1&#x27;</span><br>      <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">if</span> ( *((_BYTE *)&amp;v8 + <span class="hljs-number">5</span> * v4 + v5 - <span class="hljs-number">41</span>) == <span class="hljs-number">35</span> )  <span class="hljs-comment">//35是&quot;#&quot;，碰到&#x27;#&#x27;可获得flag</span><br>    &#123;<br>      <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\nok, the order you enter is the flag!&quot;</span>);<br>      <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>看上面的代码，v8这个变量只声明了，没有赋值，上面标注了v8在堆栈中是[esp+40h],但是最后又减了个十进制的41，转成十六进制就是0x29，40h-29h=17h，也就是说最后得到的是[esp+17h],<br />而v3对应的就是[esp+17h]。说这么多就是找一下v3和v8的关系。<br />迷宫就是这样子，就像上面注释的那样走就行</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-string">&quot;*1111&quot;</span><br><span class="hljs-string">&quot;01000&quot;</span><br><span class="hljs-string">&quot;01010&quot;</span><br><span class="hljs-string">&quot;00010&quot;</span><br><span class="hljs-string">&quot;1111#&quot;</span>   <br></code></pre></td></tr></table></figure>

<p>也就是222441144222，当然走完迷宫他并没有给flag，那就直接把这个’行走路线’当成flag输进去就是对的</p>
<h2 id="SimpleRev"><a href="#SimpleRev" class="headerlink" title="SimpleRev"></a>SimpleRev</h2><p>先看跟字符串有关的函数(加了点小小的注释)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">unsigned</span> __int64 <span class="hljs-title">Decry</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">char</span> v1; <span class="hljs-comment">// [rsp+Fh] [rbp-51h]</span><br>  <span class="hljs-keyword">int</span> v2; <span class="hljs-comment">// [rsp+10h] [rbp-50h]</span><br>  <span class="hljs-keyword">int</span> v3; <span class="hljs-comment">// [rsp+14h] [rbp-4Ch]</span><br>  <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [rsp+18h] [rbp-48h]</span><br>  <span class="hljs-keyword">int</span> v5; <span class="hljs-comment">// [rsp+1Ch] [rbp-44h]</span><br>  <span class="hljs-keyword">char</span> src[<span class="hljs-number">8</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-40h]</span><br>  __int64 v7; <span class="hljs-comment">// [rsp+28h] [rbp-38h]</span><br>  <span class="hljs-keyword">int</span> v8; <span class="hljs-comment">// [rsp+30h] [rbp-30h]</span><br>  __int64 v9; <span class="hljs-comment">// [rsp+40h] [rbp-20h]</span><br>  __int64 v10; <span class="hljs-comment">// [rsp+48h] [rbp-18h]</span><br>  <span class="hljs-keyword">int</span> v11; <span class="hljs-comment">// [rsp+50h] [rbp-10h]</span><br>  <span class="hljs-keyword">unsigned</span> __int64 v12; <span class="hljs-comment">// [rsp+58h] [rbp-8h]</span><br><br>  v12 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  *src = <span class="hljs-string">&#x27;SLCDN&#x27;</span>;   <span class="hljs-comment">//需要倒写，实际来说是NDCLS</span><br>  v7 = <span class="hljs-number">0LL</span>;<br>  v8 = <span class="hljs-number">0</span>;<br>  v9 = <span class="hljs-string">&#x27;wodah&#x27;</span>;<br>  v10 = <span class="hljs-number">0LL</span>;<br>  v11 = <span class="hljs-number">0</span>;<br>  text = join(key3, &amp;v9);                       <span class="hljs-comment">// text=&quot;killshadow&quot;</span><br>  <span class="hljs-built_in">strcpy</span>(key, key1);                            <span class="hljs-comment">// key1=&#x27;ADSFK&#x27;</span><br>  <span class="hljs-built_in">strcat</span>(key, src);                             <span class="hljs-comment">// key=&#x27;ADSFKNDCLS&#x27;</span><br>  v2 = <span class="hljs-number">0</span>;<br>  v3 = <span class="hljs-number">0</span>;<br>  getchar();<br>  v5 = <span class="hljs-built_in">strlen</span>(key);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; v5; ++i )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( key[v3 % v5] &gt; <span class="hljs-string">&#x27;@&#x27;</span> &amp;&amp; key[v3 % v5] &lt;= <span class="hljs-string">&#x27;Z&#x27;</span> )<br>      key[i] = key[v3 % v5] + <span class="hljs-number">32</span>;               <span class="hljs-comment">// 大写转小写</span><br>    ++v3;<br>  &#125;<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Please input your flag:&quot;</span>, src);<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    v1 = getchar();<br>    <span class="hljs-keyword">if</span> ( v1 == <span class="hljs-string">&#x27;\n&#x27;</span> )<br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">if</span> ( v1 == <span class="hljs-string">&#x27; &#x27;</span> )<br>    &#123;<br>      ++v2;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      <span class="hljs-keyword">if</span> ( v1 &lt;= <span class="hljs-number">96</span> || v1 &gt; <span class="hljs-number">122</span> )<br>      &#123;<br>        <span class="hljs-keyword">if</span> ( v1 &gt; <span class="hljs-number">64</span> &amp;&amp; v1 &lt;= <span class="hljs-number">90</span> )<br>          str2[v2] = (v1 - <span class="hljs-number">39</span> - key[v3++ % v5] + <span class="hljs-number">97</span>) % <span class="hljs-number">26</span> + <span class="hljs-number">97</span>;<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        str2[v2] = (v1 - <span class="hljs-number">39</span> - key[v3++ % v5] + <span class="hljs-number">97</span>) % <span class="hljs-number">26</span> + <span class="hljs-number">97</span>;<br>      &#125;<br>      <span class="hljs-keyword">if</span> ( !(v3 % v5) )<br>        <span class="hljs-built_in">putchar</span>(<span class="hljs-number">32</span>);<br>      ++v2;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strcmp</span>(text, str2) )<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Congratulation!\n&quot;</span>);<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Try again!\n&quot;</span>);<br>  <span class="hljs-keyword">return</span> __readfsqword(<span class="hljs-number">0x28</span>u) ^ v12;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>然后看关键加密的一段代码  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    v1 = getchar();<br>    <span class="hljs-keyword">if</span> ( v1 == <span class="hljs-string">&#x27;\n&#x27;</span> ) <span class="hljs-comment">//回车表示结束</span><br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">if</span> ( v1 == <span class="hljs-string">&#x27; &#x27;</span> )  <span class="hljs-comment">//表示该数组应该是A B C D这种输入进去的</span><br>    &#123;<br>      ++v2;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      <span class="hljs-keyword">if</span> ( v1 &lt;= <span class="hljs-number">96</span> || v1 &gt; <span class="hljs-number">122</span> ) <br>      &#123;<br>        <span class="hljs-keyword">if</span> ( v1 &gt; <span class="hljs-number">64</span> &amp;&amp; v1 &lt;= <span class="hljs-number">90</span> ) <span class="hljs-comment">//判断是否大写字母</span><br>          str2[v2] = (v1 - <span class="hljs-number">39</span> - key[v3++ % v5] + <span class="hljs-number">97</span>) % <span class="hljs-number">26</span> + <span class="hljs-number">97</span>;<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        str2[v2] = (v1 - <span class="hljs-number">39</span> - key[v3++ % v5] + <span class="hljs-number">97</span>) % <span class="hljs-number">26</span> + <span class="hljs-number">97</span>;<br>      &#125;<br>         <span class="hljs-keyword">if</span> ( !(v3 % v5) )<br>        <span class="hljs-built_in">putchar</span>(<span class="hljs-number">32</span>);<br>      ++v2;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strcmp</span>(text, str2) )  <span class="hljs-comment">//加密过后的的跟text一样就对了</span><br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Congratulation!\n&quot;</span>);<br></code></pre></td></tr></table></figure>

<p>也就是根据这些加密条件把v1逆出来，写python脚本爆破一下(他们都这么说哈哈)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">key = <span class="hljs-string">&quot;ADSFKNDCLS&quot;</span><br>text = <span class="hljs-string">&quot;killshadow&quot;</span><br>key = key.lower()<br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(text)):<br>    <span class="hljs-keyword">for</span> v1 <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">65</span>,<span class="hljs-number">91</span>):<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">ord</span>(text[i]) == (v1 - <span class="hljs-number">39</span> - <span class="hljs-built_in">ord</span>(key[i]) + <span class="hljs-number">97</span>) % <span class="hljs-number">26</span> + <span class="hljs-number">97</span>) :<br>            flag+=<span class="hljs-built_in">chr</span>(v1)<br><span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure>

<p>倒写具体看心得部分，虽然说的也很简单吧哈哈</p>
<h2 id="Java逆向解密"><a href="#Java逆向解密" class="headerlink" title="Java逆向解密"></a>Java逆向解密</h2><p>这个后缀class的文件需要用Java Decompiler打开，打开后代码如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.PrintStream;<br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.Scanner;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Reverse</span></span><br><span class="hljs-class"></span>&#123;<br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span></span><br><span class="hljs-function">  </span>&#123;<br>    Scanner s = <span class="hljs-keyword">new</span> Scanner(System.in);<br>    System.out.println(<span class="hljs-string">&quot;Please input the flag ：&quot;</span>);<br>    String str = s.next();<br>    System.out.println(<span class="hljs-string">&quot;Your input is ：&quot;</span>);<br>    System.out.println(str);<br>    <span class="hljs-keyword">char</span>[] stringArr = str.toCharArray();<br>    Encrypt(stringArr);<br>  &#125;<br>  <br>  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Encrypt</span><span class="hljs-params">(<span class="hljs-keyword">char</span>[] arr)</span></span><br><span class="hljs-function">  </span>&#123;<br>    ArrayList&lt;Integer&gt; Resultlist = <span class="hljs-keyword">new</span> ArrayList();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++)<br>    &#123;<br>      <span class="hljs-keyword">int</span> result = arr[i] + <span class="hljs-string">&#x27;@&#x27;</span> ^ <span class="hljs-number">0x20</span>;<br>      Resultlist.add(Integer.valueOf(result));<br>    &#125;<br>    <span class="hljs-keyword">int</span>[] KEY = &#123; <span class="hljs-number">180</span>, <span class="hljs-number">136</span>, <span class="hljs-number">137</span>, <span class="hljs-number">147</span>, <span class="hljs-number">191</span>, <span class="hljs-number">137</span>, <span class="hljs-number">147</span>, <span class="hljs-number">191</span>, <span class="hljs-number">148</span>, <span class="hljs-number">136</span>, <span class="hljs-number">133</span>, <span class="hljs-number">191</span>, <span class="hljs-number">134</span>, <span class="hljs-number">140</span>, <span class="hljs-number">129</span>, <span class="hljs-number">135</span>, <span class="hljs-number">191</span>, <span class="hljs-number">65</span> &#125;;<br>    ArrayList&lt;Integer&gt; KEYList = <span class="hljs-keyword">new</span> ArrayList();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; KEY.length; j++) &#123;<br>      KEYList.add(Integer.valueOf(KEY[j]));<br>    &#125;<br>    System.out.println(<span class="hljs-string">&quot;Result:&quot;</span>);<br>    <span class="hljs-keyword">if</span> (Resultlist.equals(KEYList)) &#123;<br>      System.out.println(<span class="hljs-string">&quot;Congratulations！&quot;</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      System.err.println(<span class="hljs-string">&quot;Error！&quot;</span>);<br>    &#125;<br>  &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>我们挑出核心代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++)<br>    &#123;<br>      <span class="hljs-keyword">int</span> result = arr[i] + <span class="hljs-string">&#x27;@&#x27;</span> ^ <span class="hljs-number">0x20</span>;<br>      Resultlist.add(Integer.valueOf(result));<br>    &#125;<br>    <span class="hljs-keyword">int</span>[] KEY = &#123; <span class="hljs-number">180</span>, <span class="hljs-number">136</span>, <span class="hljs-number">137</span>, <span class="hljs-number">147</span>, <span class="hljs-number">191</span>, <span class="hljs-number">137</span>, <span class="hljs-number">147</span>, <span class="hljs-number">191</span>, <span class="hljs-number">148</span>, <span class="hljs-number">136</span>, <span class="hljs-number">133</span>, <span class="hljs-number">191</span>, <span class="hljs-number">134</span>, <span class="hljs-number">140</span>, <span class="hljs-number">129</span>, <span class="hljs-number">135</span>, <span class="hljs-number">191</span>, <span class="hljs-number">65</span> &#125;;<br>    ArrayList&lt;Integer&gt; KEYList = <span class="hljs-keyword">new</span> ArrayList();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> j = <span class="hljs-number">0</span>; j &lt; KEY.length; j++) &#123;<br>      KEYList.add(Integer.valueOf(KEY[j]));<br>    &#125;<br>    System.out.println(<span class="hljs-string">&quot;Result:&quot;</span>);<br>    <span class="hljs-keyword">if</span> (Resultlist.equals(KEYList)) &#123;<br>      System.out.println(<span class="hljs-string">&quot;Congratulations！&quot;</span>);<br>    &#125; <br></code></pre></td></tr></table></figure>

<p>要让Resultlist与KEYList一样，而result就是输入的字符串+‘@’^0x20 这样加密过后的添加到Resultlist，这时候还是要用到爆破思想写python脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">KEY = [<span class="hljs-number">180</span>, <span class="hljs-number">136</span>, <span class="hljs-number">137</span>, <span class="hljs-number">147</span>, <span class="hljs-number">191</span>, <span class="hljs-number">137</span>, <span class="hljs-number">147</span>, <span class="hljs-number">191</span>, <span class="hljs-number">148</span>, <span class="hljs-number">136</span>, <span class="hljs-number">133</span>, <span class="hljs-number">191</span>, <span class="hljs-number">134</span>, <span class="hljs-number">140</span>, <span class="hljs-number">129</span>, <span class="hljs-number">135</span>, <span class="hljs-number">191</span>, <span class="hljs-number">65</span>]<br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(KEY)):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">300</span>):<br>        temp = x + <span class="hljs-number">64</span> ^ <span class="hljs-number">0x20</span><br>        <span class="hljs-keyword">if</span> temp==KEY[i]:<br>            flag+=<span class="hljs-built_in">chr</span>(x)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h2 id="GXYCTF2019-luck-guy"><a href="#GXYCTF2019-luck-guy" class="headerlink" title="[GXYCTF2019]luck_guy"></a>[GXYCTF2019]luck_guy</h2><p>这道题写的纯属主观臆测，直接看主要函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">unsigned</span> __int64 <span class="hljs-title">get_flag</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v0; <span class="hljs-comment">// eax</span><br>    <span class="hljs-keyword">char</span> v1; <span class="hljs-comment">// al</span><br>    <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [rsp+4h] [rbp-3Ch]</span><br>    <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> j; <span class="hljs-comment">// [rsp+8h] [rbp-38h]</span><br>    __int64 s; <span class="hljs-comment">// [rsp+10h] [rbp-30h]</span><br>    <span class="hljs-keyword">char</span> v6; <span class="hljs-comment">// [rsp+18h] [rbp-28h]</span><br>    <span class="hljs-keyword">unsigned</span> __int64 v7; <span class="hljs-comment">// [rsp+38h] [rbp-8h]</span><br>    <br>    v7 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>    v0 = time(<span class="hljs-number">0LL</span>);<br>    srand(v0);<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">4</span>; ++i )<br>    &#123;<br>        <span class="hljs-keyword">switch</span> ( rand() % <span class="hljs-number">200</span> )<br>        &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>                <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;OK, it&#x27;s flag:&quot;</span>);<br>                <span class="hljs-built_in">memset</span>(&amp;s, <span class="hljs-number">0</span>, <span class="hljs-number">0x28</span>uLL);<br>                <span class="hljs-built_in">strcat</span>((<span class="hljs-keyword">char</span> *)&amp;s, f1);<br>                <span class="hljs-built_in">strcat</span>((<span class="hljs-keyword">char</span> *)&amp;s, &amp;f2);<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, &amp;s);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Solar not like you&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Solar want a girlfriend&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>                v6 = <span class="hljs-number">0</span>;<br>                s = <span class="hljs-string">&#x27;fo`guci&#x27;</span>;<br>                <span class="hljs-built_in">strcat</span>(&amp;f2, (<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *)&amp;s);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:<br>                <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">7</span>; ++j )<br>                &#123;<br>                    <span class="hljs-keyword">if</span> ( j % <span class="hljs-number">2</span> == <span class="hljs-number">1</span> )<br>                        v1 = *(&amp;f2 + j) - <span class="hljs-number">2</span>;<br>                    <span class="hljs-keyword">else</span><br>                        v1 = *(&amp;f2 + j) - <span class="hljs-number">1</span>;<br>                    *(&amp;f2 + j) = v1;<br>                &#125;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">default</span>:<br>                <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;emmm,you can&#x27;t find flag 23333&quot;</span>);<br>                <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> __readfsqword(<span class="hljs-number">0x28</span>u) ^ v7;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>当时没想这么多，点进去f1有赋值，f2没有，直接从以下代码里猜测出f2。首先是case4，f2=f2+s，得到f2=’icug`of ‘，这个case5肯定不是等闲之辈，肯定是把f2又加密了，加密过后的f2才是case1里真正的f2</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br><span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;OK, it&#x27;s flag:&quot;</span>);<br><span class="hljs-built_in">memset</span>(&amp;s, <span class="hljs-number">0</span>, <span class="hljs-number">0x28</span>uLL);<br><span class="hljs-built_in">strcat</span>((<span class="hljs-keyword">char</span> *)&amp;s, f1);   <span class="hljs-comment">//f1 = &#x27;GXY&#123;do_not_&#x27;</span><br><span class="hljs-built_in">strcat</span>((<span class="hljs-keyword">char</span> *)&amp;s, &amp;f2);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, &amp;s);<br><span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>                v6 = <span class="hljs-number">0</span>;<br>                s = <span class="hljs-string">&#x27; fo`guci&#x27;</span>; <span class="hljs-comment">//ida的问题，应该是&#x27;icug`of &#x27;</span><br>                <span class="hljs-built_in">strcat</span>(&amp;f2, (<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *)&amp;s);<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:<br>                <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">7</span>; ++j )<br>                &#123;<br>                    <span class="hljs-keyword">if</span> ( j % <span class="hljs-number">2</span> == <span class="hljs-number">1</span> )<br>                        v1 = *(&amp;f2 + j) - <span class="hljs-number">2</span>;<br>                    <span class="hljs-keyword">else</span><br>                        v1 = *(&amp;f2 + j) - <span class="hljs-number">1</span>;<br>                    *(&amp;f2 + j) = v1;<br>                &#125;<br>                <span class="hljs-keyword">break</span>;<br></code></pre></td></tr></table></figure>

<p>根据case5代码直接写脚本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c">f1 = <span class="hljs-string">&#x27;GXY&#123;do_not_&#x27;</span><br>f2 = <span class="hljs-string">&#x27;icug`of &#x27;</span><br>bflag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i in range(<span class="hljs-number">0</span>,<span class="hljs-number">8</span>):<br>    <span class="hljs-keyword">if</span> i%<span class="hljs-number">2</span>==<span class="hljs-number">1</span>:<br>          v1 = ord(f2[i])<span class="hljs-number">-2</span><br>    <span class="hljs-keyword">else</span>:<br>            v1 = ord(f2[i])<span class="hljs-number">-1</span><br>    bflag+=chr(v1)<br>print(f1+bflag)<br><br></code></pre></td></tr></table></figure>

<p>不知为何，脚本的最后输出有点小问题，不过也不耽误事，就当右花括号就可以了<br /></p>
<h3 id="心得："><a href="#心得：" class="headerlink" title="心得："></a>心得：</h3><p>先浅浅的总结以下出现的一个最大问题就是十进制转化为倒序字符串<br />倒叙字符串就是当它数据类型是int64什么的它就是倒序的，用的时候需要把它顺序颠倒回来<br />当然并不是转化过程中都是倒序的，char类型的就是正常顺序，可以直接用<br />接下来都是废话了，吐槽的<br />就做SimpleRev这道题，看到strcat(key,src)，当时我也没见过这个函数，就去查，去小熊猫试了老大会这个函数都是正常字符串连接顺序，看到用strcat连接key+src，特别纳闷大佬的wp为什么最后src又倒序，大佬最后也没说。最后做到luck guy看到大佬的wp提到这个问题才算是茅塞顿开，反正我也不喜欢太深究，也不想知道里面究竟有什么知识点，累了</p>
<h2 id="BJDCTF2020-JustRE"><a href="#BJDCTF2020-JustRE" class="headerlink" title="[BJDCTF2020]JustRE"></a>[BJDCTF2020]JustRE</h2><p>这道题说难也很简单，说简单也特别难，想完完全全弄会这道题就很难，靠猜测推断的话就很简单，我是后者哈哈<br />1 首先ida打开跟进字符串窗口<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164105464.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />2 然后反汇编看源代码，看19999那块，点进sprintf里面的aBjdDD…看一下<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164313166.png" srcset="/img/loading.gif" lazyload alt="image-20220802164313166"><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164342847.png" srcset="/img/loading.gif" lazyload alt="image-20220802164342847"><br />3 大胆猜测%d%d指的就是19999和0，尝试一下就是正确flag<br />如果尝试跟进spintf函数，里面很复杂，也懒得看了<br />flag{1999902069a45792d233ac}</p>
<h2 id="刮开有奖"><a href="#刮开有奖" class="headerlink" title="刮开有奖"></a>刮开有奖</h2><p>这道题也说起来是比较难的一道题了，不是真会，借鉴了<a target="_blank" rel="noopener" href="https://blog.csdn.net/afanzcf/article/details/119682630?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165640049516782248575556%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=165640049516782248575556&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-119682630-null-null.142%5Ev24%5Ehuaweicloudv2,157%5Ev15%5Enew_3&utm_term=buu+%E5%88%AE%E5%BC%80&spm=1018.2226.3001.4187">大佬的wp</a>，勉强算会了<br />1 首先ida打开字符串窗口跟进这个可疑字符<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164427584.png" srcset="/img/loading.gif" lazyload alt="image-20220802164427584"><br />2 F5看反汇编代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs c">BOOL __userpurge DialogFunc@&lt;eax&gt;(<span class="hljs-keyword">int</span> a1@&lt;edi&gt;, <span class="hljs-keyword">int</span> a2@&lt;esi&gt;, HWND hDlg, UINT a4, WPARAM a5, LPARAM a6)<br>&#123;<br>  <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *v6; <span class="hljs-comment">// esi</span><br>  <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *v7; <span class="hljs-comment">// edi</span><br>  <span class="hljs-keyword">int</span> v9; <span class="hljs-comment">// [esp+4h] [ebp-20030h]</span><br>  <span class="hljs-keyword">int</span> v10; <span class="hljs-comment">// [esp+8h] [ebp-2002Ch]</span><br>  <span class="hljs-keyword">int</span> v11; <span class="hljs-comment">// [esp+Ch] [ebp-20028h]</span><br>  <span class="hljs-keyword">int</span> v12; <span class="hljs-comment">// [esp+10h] [ebp-20024h]</span><br>  <span class="hljs-keyword">int</span> v13; <span class="hljs-comment">// [esp+14h] [ebp-20020h]</span><br>  <span class="hljs-keyword">int</span> v14; <span class="hljs-comment">// [esp+18h] [ebp-2001Ch]</span><br>  <span class="hljs-keyword">int</span> v15; <span class="hljs-comment">// [esp+1Ch] [ebp-20018h]</span><br>  <span class="hljs-keyword">int</span> v16; <span class="hljs-comment">// [esp+20h] [ebp-20014h]</span><br>  <span class="hljs-keyword">int</span> v17; <span class="hljs-comment">// [esp+24h] [ebp-20010h]</span><br>  <span class="hljs-keyword">int</span> v18; <span class="hljs-comment">// [esp+28h] [ebp-2000Ch]</span><br>  <span class="hljs-keyword">int</span> v19; <span class="hljs-comment">// [esp+2Ch] [ebp-20008h]</span><br>  CHAR String; <span class="hljs-comment">// [esp+30h] [ebp-20004h]</span><br>  <span class="hljs-keyword">char</span> v21; <span class="hljs-comment">// [esp+31h] [ebp-20003h]</span><br>  <span class="hljs-keyword">char</span> v22; <span class="hljs-comment">// [esp+32h] [ebp-20002h]</span><br>  <span class="hljs-keyword">char</span> v23; <span class="hljs-comment">// [esp+33h] [ebp-20001h]</span><br>  <span class="hljs-keyword">char</span> v24; <span class="hljs-comment">// [esp+34h] [ebp-20000h]</span><br>  <span class="hljs-keyword">char</span> v25; <span class="hljs-comment">// [esp+10030h] [ebp-10004h]</span><br>  <span class="hljs-keyword">char</span> v26; <span class="hljs-comment">// [esp+10031h] [ebp-10003h]</span><br>  <span class="hljs-keyword">char</span> v27; <span class="hljs-comment">// [esp+10032h] [ebp-10002h]</span><br>  <span class="hljs-keyword">int</span> v28; <span class="hljs-comment">// [esp+20028h] [ebp-Ch]</span><br>  <span class="hljs-keyword">int</span> v29; <span class="hljs-comment">// [esp+2002Ch] [ebp-8h]</span><br><br>  __alloca_probe();<br>  <span class="hljs-keyword">if</span> ( a4 == <span class="hljs-number">272</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>  v29 = a2;<br>  v28 = a1;<br>  <span class="hljs-keyword">if</span> ( a4 != <span class="hljs-number">273</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> ( (_WORD)a5 == <span class="hljs-number">1001</span> )<br>  &#123;<br>    <span class="hljs-built_in">memset</span>(&amp;String, <span class="hljs-number">0</span>, <span class="hljs-number">0xFFFF</span>u);<br>    GetDlgItemTextA(hDlg, <span class="hljs-number">1000</span>, &amp;String, <span class="hljs-number">0xFFFF</span>); <span class="hljs-comment">//String是我们输入进去的</span><br>    <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strlen</span>(&amp;String) == <span class="hljs-number">8</span> )<br>    &#123;<br>      v9 = <span class="hljs-number">90</span>;<br>      v10 = <span class="hljs-number">74</span>;<br>      v11 = <span class="hljs-number">83</span>;<br>      v12 = <span class="hljs-number">69</span>;<br>      v13 = <span class="hljs-number">67</span>;<br>      v14 = <span class="hljs-number">97</span>;<br>      v15 = <span class="hljs-number">78</span>;<br>      v16 = <span class="hljs-number">72</span>;<br>      v17 = <span class="hljs-number">51</span>;<br>      v18 = <span class="hljs-number">110</span>;<br>      v19 = <span class="hljs-number">103</span>;<br>      sub_4010F0((<span class="hljs-keyword">int</span>)&amp;v9, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>);              <span class="hljs-comment">// v9=&#x27;3CEHJNSZagn&#x27;</span><br>      <span class="hljs-built_in">memset</span>(&amp;v25, <span class="hljs-number">0</span>, <span class="hljs-number">0xFFFF</span>u);<br>      v6 = sub_401000((<span class="hljs-keyword">int</span>)&amp;v25, <span class="hljs-built_in">strlen</span>(&amp;v25));<br>      <span class="hljs-built_in">memset</span>(&amp;v25, <span class="hljs-number">0</span>, <span class="hljs-number">0xFFFF</span>u);<br>      v26 = v23;<br>      v25 = v22;<br>      v27 = v24;<br>      v7 = sub_401000((<span class="hljs-keyword">int</span>)&amp;v25, <span class="hljs-built_in">strlen</span>(&amp;v25));<br>      <span class="hljs-keyword">if</span> ( String == v9 + <span class="hljs-number">34</span><br>        &amp;&amp; v21 == v13<br>        &amp;&amp; <span class="hljs-number">4</span> * v22 - <span class="hljs-number">141</span> == <span class="hljs-number">3</span> * v11<br>        &amp;&amp; v23 / <span class="hljs-number">4</span> == <span class="hljs-number">2</span> * (v16 / <span class="hljs-number">9</span>)<br>        &amp;&amp; !<span class="hljs-built_in">strcmp</span>(v6, <span class="hljs-string">&quot;ak1w&quot;</span>)<br>        &amp;&amp; !<span class="hljs-built_in">strcmp</span>(v7, <span class="hljs-string">&quot;V1Ax&quot;</span>) )<br>      &#123;<br>        MessageBoxA(hDlg, <span class="hljs-string">&quot;U g3t 1T!&quot;</span>, <span class="hljs-string">&quot;@_@&quot;</span>, <span class="hljs-number">0</span>);<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( (_WORD)a5 != <span class="hljs-number">1</span> &amp;&amp; (_WORD)a5 != <span class="hljs-number">2</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  EndDialog(hDlg, (<span class="hljs-keyword">unsigned</span> __int16)a5);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>3 先看一下给v9加密的sub_4010F0这个函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">sub_4010F0</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a1, <span class="hljs-keyword">int</span> a2, <span class="hljs-keyword">int</span> a3)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">int</span> result; <span class="hljs-comment">// eax</span><br>  <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// esi</span><br>  <span class="hljs-keyword">int</span> v5; <span class="hljs-comment">// ecx</span><br>  <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// edx</span><br><br>  result = a3;<br>  <span class="hljs-keyword">for</span> ( i = a2; i &lt;= a3; a2 = i )<br>  &#123;<br>    v5 = <span class="hljs-number">4</span> * i;<br>    v6 = *(_DWORD *)(<span class="hljs-number">4</span> * i + a1);<br>    <span class="hljs-keyword">if</span> ( a2 &lt; result &amp;&amp; i &lt; result )<br>    &#123;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        <span class="hljs-keyword">if</span> ( v6 &gt; *(_DWORD *)(a1 + <span class="hljs-number">4</span> * result) )<br>        &#123;<br>          <span class="hljs-keyword">if</span> ( i &gt;= result )<br>            <span class="hljs-keyword">break</span>;<br>          ++i;<br>          *(_DWORD *)(v5 + a1) = *(_DWORD *)(a1 + <span class="hljs-number">4</span> * result);<br>          <span class="hljs-keyword">if</span> ( i &gt;= result )<br>            <span class="hljs-keyword">break</span>;<br>          <span class="hljs-keyword">while</span> ( *(_DWORD *)(a1 + <span class="hljs-number">4</span> * i) &lt;= v6 )<br>          &#123;<br>            <span class="hljs-keyword">if</span> ( ++i &gt;= result )<br>              <span class="hljs-keyword">goto</span> LABEL_13;<br>          &#125;<br>          <span class="hljs-keyword">if</span> ( i &gt;= result )<br>            <span class="hljs-keyword">break</span>;<br>          v5 = <span class="hljs-number">4</span> * i;<br>          *(_DWORD *)(a1 + <span class="hljs-number">4</span> * result) = *(_DWORD *)(<span class="hljs-number">4</span> * i + a1);<br>        &#125;<br>        --result;<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( i &lt; result );<br>    &#125;<br>LABEL_13:<br>    *(_DWORD *)(a1 + <span class="hljs-number">4</span> * result) = v6;<br>    sub_4010F0(a1, a2, i - <span class="hljs-number">1</span>);<br>    result = a3;<br>    ++i;<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>可以将这个代码化为c语言代码运行，原来代码右键隐藏casts，把(_DWORD <em>)这个汇编标记隐藏掉，最重要的一点来了，可以看到下面c代码a1 + 4 * result，v5 = 4 * i;表达式里面的”4</em>“没有了，这也是从大佬wp收获的重要的东西，原因是int占四个字节，所以需要*4，如果是char类型则不需要</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-keyword">int</span>  <span class="hljs-title">sub_4010F0</span><span class="hljs-params">(<span class="hljs-keyword">char</span>* a1, <span class="hljs-keyword">int</span> a2, <span class="hljs-keyword">int</span> a3)</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-keyword">int</span> result; <span class="hljs-comment">// eax</span><br>	<span class="hljs-keyword">int</span> i; <span class="hljs-comment">// esi</span><br>	<span class="hljs-keyword">int</span> v5; <span class="hljs-comment">// ecx</span><br>	<span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// edx</span><br>	<br>	result = a3;                                 <br>	<span class="hljs-keyword">for</span> (i = a2; i &lt;= a3; a2 = i)<br>	&#123;<br>		v5 = i;<br>		v6 = a1[i];<br>		<span class="hljs-keyword">if</span> (a2 &lt; result &amp;&amp; i &lt; result)<br>		&#123;<br>			<span class="hljs-keyword">do</span><br>			&#123;<br>				<span class="hljs-keyword">if</span> (v6 &gt; a1[result])<br>				&#123;<br>					<span class="hljs-keyword">if</span> (i &gt;= result)<br>						<span class="hljs-keyword">break</span>;<br>					++i;<br>					a1[v5] = a1[result];<br>					<span class="hljs-keyword">if</span> (i &gt;= result)<br>						<span class="hljs-keyword">break</span>;<br>					<span class="hljs-keyword">while</span> (a1[i] &lt;= v6)<br>					&#123;<br>						<span class="hljs-keyword">if</span> (++i &gt;= result)<br>							<span class="hljs-keyword">goto</span> LABEL_13;<br>					&#125;<br>					<span class="hljs-keyword">if</span> (i &gt;= result)<br>						<span class="hljs-keyword">break</span>;<br>					v5 = i;<br>					a1[result] = a1[i];<br>				&#125;<br>				--result;<br>			&#125; <span class="hljs-keyword">while</span> (i &lt; result);<br>		&#125;<br>		LABEL_13:<br>			a1[result] = v6;<br>			sub_4010F0(a1, a2, i - <span class="hljs-number">1</span>);<br>			result = a3;<br>			++i;<br>	&#125;<br>	<span class="hljs-keyword">return</span> result;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-keyword">char</span> v[] = <span class="hljs-string">&quot;ZJSECaNH3ng&quot;</span>;  <span class="hljs-comment">//v9~v19化为字符串就是这样</span><br>	<br>	sub_4010F0(v,<span class="hljs-number">0</span>,<span class="hljs-number">10</span>);<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s&quot;</span>, v);<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>运行出来是这样的，也就是v9[]=’3CEHJNSZagn’<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164456569.png" srcset="/img/loading.gif" lazyload alt="image-20220802164456569"><br />4 再看后面的这个sub_401000函数，</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function">_BYTE *__cdecl <span class="hljs-title">sub_401000</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a1, <span class="hljs-keyword">int</span> a2)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">int</span> v2; <span class="hljs-comment">// eax</span><br>  <span class="hljs-keyword">int</span> v3; <span class="hljs-comment">// esi</span><br>  <span class="hljs-keyword">size_t</span> v4; <span class="hljs-comment">// ebx</span><br>  _BYTE *v5; <span class="hljs-comment">// eax</span><br>  _BYTE *v6; <span class="hljs-comment">// edi</span><br>  <span class="hljs-keyword">int</span> v7; <span class="hljs-comment">// eax</span><br>  _BYTE *v8; <span class="hljs-comment">// ebx</span><br>  <span class="hljs-keyword">int</span> v9; <span class="hljs-comment">// edi</span><br>  <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> v10; <span class="hljs-comment">// edx</span><br>  <span class="hljs-keyword">int</span> v11; <span class="hljs-comment">// edi</span><br>  <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> v12; <span class="hljs-comment">// eax</span><br>  <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> v13; <span class="hljs-comment">// esi</span><br>  _BYTE *result; <span class="hljs-comment">// eax</span><br>  _BYTE *v15; <span class="hljs-comment">// [esp+Ch] [ebp-10h]</span><br>  _BYTE *v16; <span class="hljs-comment">// [esp+10h] [ebp-Ch]</span><br>  <span class="hljs-keyword">int</span> v17; <span class="hljs-comment">// [esp+14h] [ebp-8h]</span><br>  <span class="hljs-keyword">int</span> v18; <span class="hljs-comment">// [esp+18h] [ebp-4h]</span><br><br>  v2 = a2 / <span class="hljs-number">3</span>;<br>  v3 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">if</span> ( a2 % <span class="hljs-number">3</span> &gt; <span class="hljs-number">0</span> )<br>    ++v2;<br>  v4 = <span class="hljs-number">4</span> * v2 + <span class="hljs-number">1</span>;<br>  v5 = <span class="hljs-built_in">malloc</span>(v4);<br>  v6 = v5;<br>  v15 = v5;<br>  <span class="hljs-keyword">if</span> ( !v5 )<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  <span class="hljs-built_in">memset</span>(v5, <span class="hljs-number">0</span>, v4);<br>  v7 = a2;<br>  v8 = v6;<br>  v16 = v6;<br>  <span class="hljs-keyword">if</span> ( a2 &gt; <span class="hljs-number">0</span> )<br>  &#123;<br>    <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>    &#123;<br>      v9 = <span class="hljs-number">0</span>;<br>      v10 = <span class="hljs-number">0</span>;<br>      v18 = <span class="hljs-number">0</span>;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        <span class="hljs-keyword">if</span> ( v3 &gt;= v7 )<br>          <span class="hljs-keyword">break</span>;<br>        ++v10;<br>        v9 = *(v3++ + a1) | (v9 &lt;&lt; <span class="hljs-number">8</span>);<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v10 &lt; <span class="hljs-number">3</span> );<br>      v11 = v9 &lt;&lt; <span class="hljs-number">8</span> * (<span class="hljs-number">3</span> - v10);<br>      v12 = <span class="hljs-number">0</span>;<br>      v17 = v3;<br>      v13 = <span class="hljs-number">18</span>;<br>      <span class="hljs-keyword">do</span><br>      &#123;<br>        <span class="hljs-keyword">if</span> ( v10 &gt;= v12 )<br>        &#123;<br>          *(&amp;v18 + v12) = (v11 &gt;&gt; v13) &amp; <span class="hljs-number">0x3F</span>;<br>          v8 = v16;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>          *(&amp;v18 + v12) = <span class="hljs-number">64</span>;<br>        &#125;<br>        *v8++ = byte_407830[*(&amp;v18 + v12)];<br>        v13 -= <span class="hljs-number">6</span>;<br>        ++v12;<br>        v16 = v8;<br>      &#125;<br>      <span class="hljs-keyword">while</span> ( v13 &gt; <span class="hljs-number">-6</span> );<br>      v3 = v17;<br>      <span class="hljs-keyword">if</span> ( v17 &gt;= a2 )<br>        <span class="hljs-keyword">break</span>;<br>      v7 = a2;<br>    &#125;<br>    v6 = v15;<br>  &#125;<br>  result = v6;<br>  *v8 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>虽然看着确实摸不着头脑，但是细心观察47和58行，点进65行的byte_407830看一下<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164522904.png" srcset="/img/loading.gif" lazyload alt="image-20220802164522904"><br />是base64编码表，不过差了个’A’，41h就是’A’，太坏辣出题人<br />分析这么多我也就分析出个base64加密<br />接下来再看这两行代码，效果也就是把v6和v7base64加密了一下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs c">v6 = sub_401000(&amp;v25, <span class="hljs-built_in">strlen</span>(&amp;v25));<br>v7 = sub_401000(&amp;v25, <span class="hljs-built_in">strlen</span>(&amp;v25));<br></code></pre></td></tr></table></figure>

<p>最后看关键加密代码，v21,v22,v23就是String里面的，因为String是[esp+30h],v21是[esp+31h]<br />v22是[esp+32h]，v23是[esp+33h]</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> ( String == v9 + <span class="hljs-number">34</span>   <span class="hljs-comment">//String第一位就是加密后的v9+34=51+34=85=&#x27;U&#x27;</span><br>        &amp;&amp; v21 == v13    <span class="hljs-comment">//v21=加密过后的v13=&#x27;J&#x27;，后面的都是加密过后的</span><br>        &amp;&amp; <span class="hljs-number">4</span> * v22 - <span class="hljs-number">141</span> == <span class="hljs-number">3</span> * v11  v22=(<span class="hljs-number">3</span>*<span class="hljs-number">69</span>+<span class="hljs-number">141</span>)=<span class="hljs-number">87</span>=<span class="hljs-string">&#x27;W&#x27;</span><br>        &amp;&amp; v23 / <span class="hljs-number">4</span> == <span class="hljs-number">2</span> * (v16 / <span class="hljs-number">9</span>)  v23=<span class="hljs-number">8</span>*<span class="hljs-number">90</span>/<span class="hljs-number">9</span>=<span class="hljs-number">80</span>=<span class="hljs-string">&#x27;P&#x27;</span> <br>        &amp;&amp; !<span class="hljs-built_in">strcmp</span>(v6, <span class="hljs-string">&quot;ak1w&quot;</span>)       解码后V6=<span class="hljs-string">&#x27;jMp&#x27;</span><br>        &amp;&amp; !<span class="hljs-built_in">strcmp</span>(v7, <span class="hljs-string">&quot;V1Ax&quot;</span>) )           v7=<span class="hljs-string">&#x27;WP1&#x27;</span><br>      &#123;<br>        MessageBoxA(hDlg, <span class="hljs-string">&quot;U g3t 1T!&quot;</span>, <span class="hljs-string">&quot;@_@&quot;</span>, <span class="hljs-number">0</span>);<br>      &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p>最后拼接在一块是’UJWP1jMp’，因为前面已经有了’WP’，所以v7肯定在前面，v6在后面</p>
<h2 id="简单注册器"><a href="#简单注册器" class="headerlink" title="简单注册器"></a>简单注册器</h2><p>思维难度不算难，就是没接触过相关知识<br />首先文件是apk安装包，这里要用到JEB来对其进行反汇编，用JEB打开文件后，需要按Tab看反汇编java代码<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164606971.png" srcset="/img/loading.gif" lazyload alt="image-20220802164606971"><br />找到核心加密代码，也就是对v5做了一系列变化，变化后的v5就是</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span>(v2 == <span class="hljs-number">1</span>) &#123;<br>                    <span class="hljs-keyword">char</span>[] v5 = <span class="hljs-string">&quot;dd2940c04462b4dd7c450528835cca15&quot;</span>.toCharArray();<br>                    v5[v9] = ((<span class="hljs-keyword">char</span>)(v5[v9] + v5[<span class="hljs-number">3</span>] - <span class="hljs-number">50</span>)); <span class="hljs-comment">//v9=2</span><br>                    v5[<span class="hljs-number">4</span>] = ((<span class="hljs-keyword">char</span>)(v5[v9] + v5[<span class="hljs-number">5</span>] - <span class="hljs-number">0x30</span>));<br>                    v5[<span class="hljs-number">30</span>] = ((<span class="hljs-keyword">char</span>)(v5[v11] + v5[<span class="hljs-number">9</span>] - <span class="hljs-number">0x30</span>));<span class="hljs-comment">//v11=0x1F</span><br>                    v5[<span class="hljs-number">14</span>] = ((<span class="hljs-keyword">char</span>)(v5[<span class="hljs-number">27</span>] + v5[<span class="hljs-number">28</span>] - <span class="hljs-number">97</span>));<br>                    <span class="hljs-keyword">int</span> v4;<br>                    <span class="hljs-keyword">for</span>(v4 = <span class="hljs-number">0</span>; v4 &lt; <span class="hljs-number">16</span>; ++v4) &#123;<br>                        <span class="hljs-keyword">char</span> v0 = v5[<span class="hljs-number">0x1F</span> - v4];<br>                        v5[<span class="hljs-number">0x1F</span> - v4] = v5[v4];<br>                        v5[v4] = v0;<br>                    &#125;<br><br>                    <span class="hljs-keyword">this</span>.val$textview.setText(<span class="hljs-string">&quot;flag&#123;&quot;</span> + String.valueOf(v5) + <span class="hljs-string">&quot;&#125;&quot;</span>);<br></code></pre></td></tr></table></figure>

<p>根据这个写脚本，python学的太拉了，所以特地给自己注释了一下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java">#字符串数组用列表<br>v5=[<span class="hljs-string">&#x27;d&#x27;</span>,<span class="hljs-string">&#x27;d&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;9&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;0&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>,<span class="hljs-string">&#x27;0&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;6&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;d&#x27;</span>,<span class="hljs-string">&#x27;d&#x27;</span>,<span class="hljs-string">&#x27;7&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>,<span class="hljs-string">&#x27;4&#x27;</span>,<span class="hljs-string">&#x27;5&#x27;</span>,<span class="hljs-string">&#x27;0&#x27;</span>,<span class="hljs-string">&#x27;5&#x27;</span>,<span class="hljs-string">&#x27;2&#x27;</span>,<span class="hljs-string">&#x27;8&#x27;</span>,<span class="hljs-string">&#x27;8&#x27;</span>,<span class="hljs-string">&#x27;3&#x27;</span>,<span class="hljs-string">&#x27;5&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>,<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;1&#x27;</span>,<span class="hljs-string">&#x27;5&#x27;</span>]<br>v5[<span class="hljs-number">2</span>]= chr(ord(v5[<span class="hljs-number">2</span>]) + ord(v5[<span class="hljs-number">3</span>]) - <span class="hljs-number">50</span>)<br>v5[<span class="hljs-number">4</span>] = chr(ord(v5[<span class="hljs-number">2</span>]) + ord(v5[<span class="hljs-number">5</span>]) - <span class="hljs-number">0x30</span>)<br>v5[<span class="hljs-number">30</span>] = chr(ord(v5[<span class="hljs-number">0x1F</span>]) + ord(v5[<span class="hljs-number">9</span>]) - <span class="hljs-number">0x30</span>)<br>v5[<span class="hljs-number">14</span>] = chr(ord(v5[<span class="hljs-number">27</span>]) + ord(v5[<span class="hljs-number">28</span>]) - <span class="hljs-number">97</span>)<br><span class="hljs-function"><span class="hljs-keyword">for</span> v4 in <span class="hljs-title">range</span><span class="hljs-params">(<span class="hljs-number">16</span>)</span>:</span><br><span class="hljs-function">    v0 </span>= v5[<span class="hljs-number">0x1F</span> - v4]<br>    v5[<span class="hljs-number">0x1F</span> - v4] = v5[v4]<br>    v5[v4] = <span class="hljs-function">v0</span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-keyword">for</span> i in <span class="hljs-title">range</span><span class="hljs-params">(<span class="hljs-number">0</span>,len(v5)</span>):</span><br><span class="hljs-function">    <span class="hljs-title">print</span><span class="hljs-params">(v5[i],end=<span class="hljs-string">&quot;&quot;</span>)</span>  #end</span>=<span class="hljs-string">&quot;&quot;</span>表示输出不换行<br></code></pre></td></tr></table></figure>

<p>输出的即为flag<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164630589.png" srcset="/img/loading.gif" lazyload alt="image-20220802164630589"></p>
<h2 id="GWCTF-2019-pyre"><a href="#GWCTF-2019-pyre" class="headerlink" title="[GWCTF 2019]pyre"></a>[GWCTF 2019]pyre</h2><p>文件是pyc后缀，反编译后就是py，可以使用<a target="_blank" rel="noopener" href="https://tool.lu/pyc/">在线pyc反编译</a><br />也可以在ubantu里执行如下命令</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">pip install uncompyle6<br>uncompyle6 -o xx.py xx.pyc <br></code></pre></td></tr></table></figure>

<p>反汇编出来的代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># uncompyle6 version 3.8.0</span><br><span class="hljs-comment"># Python bytecode 2.7 (62211)</span><br><span class="hljs-comment"># Decompiled from: Python 3.5.2 (default, Jan 26 2021, 13:30:48) </span><br><span class="hljs-comment"># [GCC 5.4.0 20160609]</span><br><span class="hljs-comment"># Embedded file name: encode.py</span><br><span class="hljs-comment"># Compiled at: 2019-08-19 06:01:57</span><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;Welcome to Re World!&#x27;</span><br><span class="hljs-built_in">print</span> <span class="hljs-string">&#x27;Your input1 is your flag~&#x27;</span><br>l = <span class="hljs-built_in">len</span>(input1)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l):<br>    num = ((input1[i] + i) % <span class="hljs-number">128</span> + <span class="hljs-number">128</span>) % <span class="hljs-number">128</span> <span class="hljs-comment">#其实完全可以是(input[i]+i)%128</span><br>    code += num<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(l - <span class="hljs-number">1</span>):<br>    code[i] = code[i] ^ code[(i + <span class="hljs-number">1</span>)]<br><br><span class="hljs-built_in">print</span> code<br>code = [<span class="hljs-string">&#x27;\x1f&#x27;</span>, <span class="hljs-string">&#x27;\x12&#x27;</span>, <span class="hljs-string">&#x27;\x1d&#x27;</span>, <span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-string">&#x27;\x01&#x27;</span>, <span class="hljs-string">&#x27;\x06&#x27;</span>, <span class="hljs-string">&#x27;\x14&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-string">&#x27;\x1b&#x27;</span>, <span class="hljs-string">&#x27;U&#x27;</span>, <span class="hljs-string">&#x27;?&#x27;</span>, <span class="hljs-string">&#x27;o&#x27;</span>, <span class="hljs-string">&#x27;6&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>, <span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;\x01&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;;&#x27;</span>, <span class="hljs-string">&#x27;%&#x27;</span>, <span class="hljs-string">&#x27;\x13&#x27;</span>]<br></code></pre></td></tr></table></figure>

<p>根据代码写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">flag = <span class="hljs-string">&quot;&quot;</span><br>code = [<span class="hljs-string">&#x27;\x1f&#x27;</span>, <span class="hljs-string">&#x27;\x12&#x27;</span>, <span class="hljs-string">&#x27;\x1d&#x27;</span>, <span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-string">&#x27;\x01&#x27;</span>, <span class="hljs-string">&#x27;\x06&#x27;</span>, <span class="hljs-string">&#x27;\x14&#x27;</span>, <span class="hljs-string">&#x27;4&#x27;</span>, <span class="hljs-string">&#x27;,&#x27;</span>, <span class="hljs-string">&#x27;\x1b&#x27;</span>, <span class="hljs-string">&#x27;U&#x27;</span>, <span class="hljs-string">&#x27;?&#x27;</span>, <span class="hljs-string">&#x27;o&#x27;</span>, <span class="hljs-string">&#x27;6&#x27;</span>, <span class="hljs-string">&#x27;*&#x27;</span>, <span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-string">&#x27;\x01&#x27;</span>, <span class="hljs-string">&#x27;D&#x27;</span>, <span class="hljs-string">&#x27;;&#x27;</span>, <span class="hljs-string">&#x27;%&#x27;</span>, <span class="hljs-string">&#x27;\x13&#x27;</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(code)-<span class="hljs-number">2</span>,-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>):<br>    code[i] = <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(code[i]) ^ <span class="hljs-built_in">ord</span>(code[(i + <span class="hljs-number">1</span>)]))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(code)):<br>    num=(<span class="hljs-built_in">ord</span>(code[i])-i)%<span class="hljs-number">128</span><br>    flag+=<span class="hljs-built_in">chr</span>(num)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<p>运行脚本生成flag<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164651602.png" srcset="/img/loading.gif" lazyload alt="image-20220802164651602"></p>
<h2 id="ACTF新生赛2020-easyre"><a href="#ACTF新生赛2020-easyre" class="headerlink" title="[ACTF新生赛2020]easyre"></a>[ACTF新生赛2020]easyre</h2><p>查壳，发现是UPX，那就先脱壳<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164711649.png" srcset="/img/loading.gif" lazyload alt="image-20220802164711649"><br />脱完壳用ida打开，进入到main函数，F5反汇编</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">int</span> __cdecl main(<span class="hljs-built_in">int</span> argc, const char **argv, const char **envp)<br>&#123;<br>  char v4; // [esp+12h] [ebp-2Eh]<br>  char v5; // [esp+13h] [ebp-2Dh]<br>  char v6; // [esp+14h] [ebp-2Ch]<br>  char v7; // [esp+15h] [ebp-2Bh]<br>  char v8; // [esp+16h] [ebp-2Ah]<br>  char v9; // [esp+17h] [ebp-29h]<br>  char v10; // [esp+18h] [ebp-28h]<br>  char v11; // [esp+19h] [ebp-27h]<br>  char v12; // [esp+1Ah] [ebp-26h]<br>  char v13; // [esp+1Bh] [ebp-25h]<br>  char v14; // [esp+1Ch] [ebp-24h]<br>  char v15; // [esp+1Dh] [ebp-23h]<br>  <span class="hljs-built_in">int</span> v16; // [esp+1Eh] [ebp-22h]<br>  <span class="hljs-built_in">int</span> v17; // [esp+22h] [ebp-1Eh]<br>  <span class="hljs-built_in">int</span> v18; // [esp+26h] [ebp-1Ah]<br>  __int16 v19; // [esp+2Ah] [ebp-16h]<br>  char v20; // [esp+2Ch] [ebp-14h]<br>  char v21; // [esp+2Dh] [ebp-13h]<br>  char v22; // [esp+2Eh] [ebp-12h]<br>  <span class="hljs-built_in">int</span> v23; // [esp+2Fh] [ebp-11h]<br>  <span class="hljs-built_in">int</span> v24; // [esp+33h] [ebp-Dh]<br>  <span class="hljs-built_in">int</span> v25; // [esp+37h] [ebp-9h]<br>  char v26; // [esp+3Bh] [ebp-5h]<br>  <span class="hljs-built_in">int</span> i; // [esp+3Ch] [ebp-4h]<br><br>  sub_401A10();<br>  v4 = <span class="hljs-number">42</span>;<br>  v5 = <span class="hljs-number">70</span>;<br>  v6 = <span class="hljs-number">39</span>;<br>  v7 = <span class="hljs-number">34</span>;<br>  v8 = <span class="hljs-number">78</span>;<br>  v9 = <span class="hljs-number">44</span>;<br>  v10 = <span class="hljs-number">34</span>;<br>  v11 = <span class="hljs-number">40</span>;<br>  v12 = <span class="hljs-number">73</span>;<br>  v13 = <span class="hljs-number">63</span>;<br>  v14 = <span class="hljs-number">43</span>;<br>  v15 = <span class="hljs-number">64</span>;<br>  printf(<span class="hljs-string">&quot;Please input:&quot;</span>);<br>  scanf(<span class="hljs-string">&quot;%s&quot;</span>, &amp;v19);<br>  <span class="hljs-keyword">if</span> ( (_BYTE)v19 != <span class="hljs-number">65</span> || HIBYTE(v19) != <span class="hljs-number">67</span> || v20 != <span class="hljs-number">84</span> || v21 != <span class="hljs-number">70</span> || v22 != <span class="hljs-number">123</span> || v26 != <span class="hljs-number">125</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  v16 = v23;<br>  v17 = v24;<br>  v18 = v25;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">11</span>; ++i )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( *(&amp;v4 + i) != byte_402000[*((char *)&amp;v16 + i) - <span class="hljs-number">1</span>] )<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>  printf(<span class="hljs-string">&quot;You are correct!&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这道题我被迷惑了很大一阵子，主要原因是被v16+i给迷住了，我以为v16+1=v17,像这种编号问题真的不该犯。应该根据ida给的注释来说，比如v16是在[esp+1E],而v17是[esp+22]，差四位。<br />接下来总体分析一下，就是输入值赋给v19，主要是v23，v24，v25对应的数对应byte_402000数组中的编号，然后跟v4数组里面的数进行比较，除了ACTF{}，还有12位字符待输入。<br />看一看byte_402000对应的表<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164744150.png" srcset="/img/loading.gif" lazyload alt="image-20220802164744150"><br />接下来写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">biao=<span class="hljs-string">&#x27;~&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/.-,+*)(&#x27;</span>+<span class="hljs-built_in">chr</span>(<span class="hljs-number">0x27</span>)+<span class="hljs-string">&#x27;&amp;%$# !&quot;&#x27;</span><br>v4=[<span class="hljs-number">42</span>,<span class="hljs-number">70</span>,<span class="hljs-number">39</span>,<span class="hljs-number">34</span>,<span class="hljs-number">78</span>,<span class="hljs-number">44</span>,<span class="hljs-number">34</span>,<span class="hljs-number">40</span>,<span class="hljs-number">73</span>,<span class="hljs-number">63</span>,<span class="hljs-number">43</span>,<span class="hljs-number">64</span>]<br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(v4)):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(biao)):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">ord</span>(biao[j])==v4[i]:<br>            flag+=<span class="hljs-built_in">chr</span>(j+<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<p>得到flag<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164802604.png" srcset="/img/loading.gif" lazyload alt="image-20220802164802604"></p>
<h2 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h2><p>这道题确实一点不会，纯看大佬的wp，只是尝试复现(虽然复现也没能复现出来)<br />首先记事本打开，然后复制，<a target="_blank" rel="noopener" href="http://tool.chacuo.net/cryptrsakeyparse">在线rsa公私钥解析</a><br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164824637.png" srcset="/img/loading.gif" lazyload alt="image-20220802164824637"><br />e=65537(指数)<br />n=86934482296048119190666062003494800588905656017203025617216654058378322103517  (模数转十进制)  <br />然后<a target="_blank" rel="noopener" href="http://www.factordb.com/">在线质因数分解</a>，分解出p，q<br />p=285960468890451637935629440372639283459<br />q=304008741604601924494328155975272418463<br />脚本就跟我没关系了，纯纯搬运<br />参考链接:<a target="_blank" rel="noopener" href="https://www.cnblogs.com/hhh5460/p/5243410.html">https://www.cnblogs.com/hhh5460/p/5243410.html</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">import</span> rsa<br>e=<span class="hljs-number">65537</span><br>n=<span class="hljs-number">86934482296048119190666062003494800588905656017203025617216654058378322103517</span><br>p=<span class="hljs-number">285960468890451637935629440372639283459</span><br>q=<span class="hljs-number">304008741604601924494328155975272418463</span><br>o=(p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d=gmpy2.invert(e,o)<br>key = rsa.PrivateKey(n, e, <span class="hljs-built_in">int</span>(d), p, q)<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.enc&quot;</span>, <span class="hljs-string">&quot;rb+&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    f = f.read()<br>    <span class="hljs-built_in">print</span>(rsa.decrypt(f, key))<br></code></pre></td></tr></table></figure>

<h2 id="ACTF新生赛2020-rome"><a href="#ACTF新生赛2020-rome" class="headerlink" title="[ACTF新生赛2020]rome"></a>[ACTF新生赛2020]rome</h2><p>先看主要加密函数的反汇编</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">func</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">int</span> result; <span class="hljs-comment">// eax</span><br>  <span class="hljs-keyword">int</span> v1; <span class="hljs-comment">// [esp+14h] [ebp-44h]</span><br>  <span class="hljs-keyword">int</span> v2; <span class="hljs-comment">// [esp+18h] [ebp-40h]</span><br>  <span class="hljs-keyword">int</span> v3; <span class="hljs-comment">// [esp+1Ch] [ebp-3Ch]</span><br>  <span class="hljs-keyword">int</span> v4; <span class="hljs-comment">// [esp+20h] [ebp-38h]</span><br>  <span class="hljs-keyword">unsigned</span> __int8 v5; <span class="hljs-comment">// [esp+24h] [ebp-34h]</span><br>  <span class="hljs-keyword">unsigned</span> __int8 v6; <span class="hljs-comment">// [esp+25h] [ebp-33h]</span><br>  <span class="hljs-keyword">unsigned</span> __int8 v7; <span class="hljs-comment">// [esp+26h] [ebp-32h]</span><br>  <span class="hljs-keyword">unsigned</span> __int8 v8; <span class="hljs-comment">// [esp+27h] [ebp-31h]</span><br>  <span class="hljs-keyword">unsigned</span> __int8 v9; <span class="hljs-comment">// [esp+28h] [ebp-30h]</span><br>  <span class="hljs-keyword">int</span> v10; <span class="hljs-comment">// [esp+29h] [ebp-2Fh]</span><br>  <span class="hljs-keyword">int</span> v11; <span class="hljs-comment">// [esp+2Dh] [ebp-2Bh]</span><br>  <span class="hljs-keyword">int</span> v12; <span class="hljs-comment">// [esp+31h] [ebp-27h]</span><br>  <span class="hljs-keyword">int</span> v13; <span class="hljs-comment">// [esp+35h] [ebp-23h]</span><br>  <span class="hljs-keyword">unsigned</span> __int8 v14; <span class="hljs-comment">// [esp+39h] [ebp-1Fh]</span><br>  <span class="hljs-keyword">char</span> v15; <span class="hljs-comment">// [esp+3Bh] [ebp-1Dh]</span><br>  <span class="hljs-keyword">char</span> v16; <span class="hljs-comment">// [esp+3Ch] [ebp-1Ch]</span><br>  <span class="hljs-keyword">char</span> v17; <span class="hljs-comment">// [esp+3Dh] [ebp-1Bh]</span><br>  <span class="hljs-keyword">char</span> v18; <span class="hljs-comment">// [esp+3Eh] [ebp-1Ah]</span><br>  <span class="hljs-keyword">char</span> v19; <span class="hljs-comment">// [esp+3Fh] [ebp-19h]</span><br>  <span class="hljs-keyword">char</span> v20; <span class="hljs-comment">// [esp+40h] [ebp-18h]</span><br>  <span class="hljs-keyword">char</span> v21; <span class="hljs-comment">// [esp+41h] [ebp-17h]</span><br>  <span class="hljs-keyword">char</span> v22; <span class="hljs-comment">// [esp+42h] [ebp-16h]</span><br>  <span class="hljs-keyword">char</span> v23; <span class="hljs-comment">// [esp+43h] [ebp-15h]</span><br>  <span class="hljs-keyword">char</span> v24; <span class="hljs-comment">// [esp+44h] [ebp-14h]</span><br>  <span class="hljs-keyword">char</span> v25; <span class="hljs-comment">// [esp+45h] [ebp-13h]</span><br>  <span class="hljs-keyword">char</span> v26; <span class="hljs-comment">// [esp+46h] [ebp-12h]</span><br>  <span class="hljs-keyword">char</span> v27; <span class="hljs-comment">// [esp+47h] [ebp-11h]</span><br>  <span class="hljs-keyword">char</span> v28; <span class="hljs-comment">// [esp+48h] [ebp-10h]</span><br>  <span class="hljs-keyword">char</span> v29; <span class="hljs-comment">// [esp+49h] [ebp-Fh]</span><br>  <span class="hljs-keyword">char</span> v30; <span class="hljs-comment">// [esp+4Ah] [ebp-Eh]</span><br>  <span class="hljs-keyword">char</span> v31; <span class="hljs-comment">// [esp+4Bh] [ebp-Dh]</span><br>  <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [esp+4Ch] [ebp-Ch]</span><br><br>  v15 = <span class="hljs-number">81</span>;<br>  v16 = <span class="hljs-number">115</span>;<br>  v17 = <span class="hljs-number">119</span>;<br>  v18 = <span class="hljs-number">51</span>;<br>  v19 = <span class="hljs-number">115</span>;<br>  v20 = <span class="hljs-number">106</span>;<br>  v21 = <span class="hljs-number">95</span>;<br>  v22 = <span class="hljs-number">108</span>;<br>  v23 = <span class="hljs-number">122</span>;<br>  v24 = <span class="hljs-number">52</span>;<br>  v25 = <span class="hljs-number">95</span>;<br>  v26 = <span class="hljs-number">85</span>;<br>  v27 = <span class="hljs-number">106</span>;<br>  v28 = <span class="hljs-number">119</span>;<br>  v29 = <span class="hljs-number">64</span>;<br>  v30 = <span class="hljs-number">108</span>;<br>  v31 = <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Please input:&quot;</span>);<br>  <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, &amp;v5);<br>  result = v5;<br>  <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">65</span> )<br>  &#123;<br>    result = v6;<br>    <span class="hljs-keyword">if</span> ( v6 == <span class="hljs-number">67</span> )<br>    &#123;<br>      result = v7;<br>      <span class="hljs-keyword">if</span> ( v7 == <span class="hljs-number">84</span> )<br>      &#123;<br>        result = v8;<br>        <span class="hljs-keyword">if</span> ( v8 == <span class="hljs-number">70</span> )<br>        &#123;<br>          result = v9;<br>          <span class="hljs-keyword">if</span> ( v9 == <span class="hljs-number">123</span> )<br>          &#123;<br>            result = v14;<br>            <span class="hljs-keyword">if</span> ( v14 == <span class="hljs-number">125</span> )<br>            &#123;<br>              v1 = v10;<br>              v2 = v11;<br>              v3 = v12;<br>              v4 = v13;<br>              <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">15</span>; ++i )<br>              &#123;<br>                <span class="hljs-keyword">if</span> ( *(&amp;v1 + i) &gt; <span class="hljs-number">64</span> &amp;&amp; *(&amp;v1 + i) &lt;= <span class="hljs-number">90</span> )<br>                  *(&amp;v1 + i) = (*(&amp;v1 + i) - <span class="hljs-number">51</span>) % <span class="hljs-number">26</span> + <span class="hljs-number">65</span>;<br>                <span class="hljs-keyword">if</span> ( *(&amp;v1 + i) &gt; <span class="hljs-number">96</span> &amp;&amp; *(&amp;v1 + i) &lt;= <span class="hljs-number">122</span> )<br>                  *(&amp;v1 + i) = (*(&amp;v1 + i) - <span class="hljs-number">79</span>) % <span class="hljs-number">26</span> + <span class="hljs-number">97</span>;<br>              &#125;<br>              <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">15</span>; ++i )<br>              &#123;<br>                result = *(&amp;v15 + i);<br>                <span class="hljs-keyword">if</span> ( *(&amp;v1 + i) != result )<br>                  <span class="hljs-keyword">return</span> result;<br>              &#125;<br>              result = <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;You are correct!&quot;</span>);<br>            &#125;<br>          &#125;<br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这里说两句废话，不出所料的话，先给出的v5,v6,v7,v8,v9,v14应该就是flag的前后缀</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs c">a=[<span class="hljs-number">65</span>, <span class="hljs-number">67</span>, <span class="hljs-number">84</span>, <span class="hljs-number">70</span>,<span class="hljs-number">123</span>, <span class="hljs-number">125</span>]<br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i in range(len(a)):<br>    flag+=chr(a[i])<br>print(flag)<br></code></pre></td></tr></table></figure>

<p><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164914270.png" srcset="/img/loading.gif" lazyload alt="image-20220802164914270"><br />接下来就不说废话了，v1<del>v4以及v10</del>v13之间都可以存储16个数据，后面就是它给它拷贝一下，然后加密，加密过后跟v15~v30作比较，相同就是flag<br />看核心加密代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">15</span>; ++i )<br>              &#123;<br>                <span class="hljs-keyword">if</span> ( *(&amp;v1 + i) &gt; <span class="hljs-number">64</span> &amp;&amp; *(&amp;v1 + i) &lt;= <span class="hljs-number">90</span> )<br>                  *(&amp;v1 + i) = (*(&amp;v1 + i) - <span class="hljs-number">51</span>) % <span class="hljs-number">26</span> + <span class="hljs-number">65</span>;<br>                <span class="hljs-keyword">if</span> ( *(&amp;v1 + i) &gt; <span class="hljs-number">96</span> &amp;&amp; *(&amp;v1 + i) &lt;= <span class="hljs-number">122</span> )<br>                  *(&amp;v1 + i) = (*(&amp;v1 + i) - <span class="hljs-number">79</span>) % <span class="hljs-number">26</span> + <span class="hljs-number">97</span>;<br>              &#125;<br></code></pre></td></tr></table></figure>

<p>这道题要用爆破思想，这里我想错了，结果写的脚本也就错了</p>
<h3 id="正确："><a href="#正确：" class="headerlink" title="正确："></a>正确：</h3><p>先写正确的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">result=[<span class="hljs-number">81</span>,<span class="hljs-number">115</span>,<span class="hljs-number">119</span>,<span class="hljs-number">51</span>,<span class="hljs-number">115</span>,<span class="hljs-number">106</span>,<span class="hljs-number">95</span>,<span class="hljs-number">108</span>,<span class="hljs-number">122</span>,<span class="hljs-number">52</span>,<span class="hljs-number">95</span>,<span class="hljs-number">85</span>,<span class="hljs-number">106</span>,<span class="hljs-number">119</span>,<span class="hljs-number">64</span>,<span class="hljs-number">108</span>]<br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(result)):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">123</span>):<br>            f=j<br>            <span class="hljs-keyword">if</span> j&gt;<span class="hljs-number">64</span> <span class="hljs-keyword">and</span> j&lt;=<span class="hljs-number">90</span>:<br>                j=(j-<span class="hljs-number">51</span>)%<span class="hljs-number">26</span>+<span class="hljs-number">65</span><br>            <span class="hljs-keyword">if</span> j&gt;<span class="hljs-number">96</span> <span class="hljs-keyword">and</span> j&lt;=<span class="hljs-number">122</span>:<br>                j=(j-<span class="hljs-number">79</span>)%<span class="hljs-number">26</span>+<span class="hljs-number">97</span><br>            <span class="hljs-keyword">if</span> j==result[i]:<br>                flag+=<span class="hljs-built_in">chr</span>(f)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<p>正确的运行结果<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164936233.png" srcset="/img/loading.gif" lazyload alt="image-20220802164936233"></p>
<h3 id="错误："><a href="#错误：" class="headerlink" title="错误："></a>错误：</h3><p>错误的脚本也写出来，刚开始没想着用爆破思想，就是想着硬推，结果交上去不对纳闷了半天</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">result=[<span class="hljs-number">81</span>,<span class="hljs-number">115</span>,<span class="hljs-number">119</span>,<span class="hljs-number">51</span>,<span class="hljs-number">115</span>,<span class="hljs-number">106</span>,<span class="hljs-number">95</span>,<span class="hljs-number">108</span>,<span class="hljs-number">122</span>,<span class="hljs-number">52</span>,<span class="hljs-number">95</span>,<span class="hljs-number">85</span>,<span class="hljs-number">106</span>,<span class="hljs-number">119</span>,<span class="hljs-number">64</span>,<span class="hljs-number">108</span>]<br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(result)):<br>    <span class="hljs-keyword">if</span> result[i]&gt;<span class="hljs-number">64</span> <span class="hljs-keyword">and</span> result[i]&lt;=<span class="hljs-number">90</span>:<br>        result[i]=(result[i]-<span class="hljs-number">65</span>)%<span class="hljs-number">26</span>+<span class="hljs-number">51</span><br>    <span class="hljs-keyword">elif</span> result[i]&gt;<span class="hljs-number">96</span> <span class="hljs-keyword">and</span> result[i]&lt;=<span class="hljs-number">122</span>:<br>        result[i]=(result[i]-<span class="hljs-number">97</span>)%<span class="hljs-number">26</span>+<span class="hljs-number">79</span><br>    flag+=<span class="hljs-built_in">chr</span>(result[i])<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<p>错的就是这样<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802164951780.png" srcset="/img/loading.gif" lazyload alt="image-20220802164951780"><br />虽然脚本错了，但是可以修正正确(虽然跟爆破比确实有点麻烦)，不过我也摸不清到底怎么回事。。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">result=[<span class="hljs-number">81</span>,<span class="hljs-number">115</span>,<span class="hljs-number">119</span>,<span class="hljs-number">51</span>,<span class="hljs-number">115</span>,<span class="hljs-number">106</span>,<span class="hljs-number">95</span>,<span class="hljs-number">108</span>,<span class="hljs-number">122</span>,<span class="hljs-number">52</span>,<span class="hljs-number">95</span>,<span class="hljs-number">85</span>,<span class="hljs-number">106</span>,<span class="hljs-number">119</span>,<span class="hljs-number">64</span>,<span class="hljs-number">108</span>]<br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(result)):<br>    <span class="hljs-keyword">if</span> result[i]&gt;<span class="hljs-number">64</span> <span class="hljs-keyword">and</span> result[i]&lt;=<span class="hljs-number">90</span>:<br>        result[i]=(result[i]-<span class="hljs-number">65</span>)%<span class="hljs-number">26</span>+<span class="hljs-number">51</span><br>    <span class="hljs-keyword">if</span> result[i]&gt;<span class="hljs-number">96</span> <span class="hljs-keyword">and</span> result[i]&lt;=<span class="hljs-number">122</span>:<br>        result[i]=(result[i]-<span class="hljs-number">97</span>)%<span class="hljs-number">26</span>+<span class="hljs-number">79</span><br>        <span class="hljs-keyword">if</span> result[i]&lt;=<span class="hljs-number">96</span>:<br>            result[i]+=<span class="hljs-number">26</span><br>    flag+=<span class="hljs-built_in">chr</span>(result[i])<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<p>根据这个修正后的脚本我们可以知道一点原因，就比如说输出错误的’X’,就是说<br />(88-79)%26=(114-79)%26=9，错的原因就是没有考虑到小写字母加密还是小写，大写字母加密还是大写，吃了取余的亏，所以能爆破尽量不要硬逆</p>
<h2 id="CrackRTF"><a href="#CrackRTF" class="headerlink" title="CrackRTF"></a>CrackRTF</h2><p>新题型不咋会，草草地看了大佬的wp<br />这里我写的也是最懒蛋的写法，得益于<a target="_blank" rel="noopener" href="https://www.somd5.com/">https://www.somd5.com/</a>这个网站，<br />直接用网站解出这两段md5<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165031720.png" srcset="/img/loading.gif" lazyload alt="image-20220802165031720"><br />也就是<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165303162.png" srcset="/img/loading.gif" lazyload alt="image-20220802165303162"></p>
<p><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165107471.png" srcset="/img/loading.gif" lazyload><br />结合反汇编代码可知，两次输入的密码，第一次是123321，第二次是 <del>!3a@0  <br />将exe文件拖入cmd运行，然后就会自动生成一个rtf文件<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165351178.png" srcset="/img/loading.gif" lazyload alt="image-20220802165351178"><br />更详细的看这位大佬的[wp](<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45892237/article/details/117672692?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=buucrackrtf&amp;utm_medium=distribute.pc_search_result.none-task-blog-2">https://blog.csdn.net/qq_45892237/article/details/117672692?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=buucrackrtf&amp;utm_medium=distribute.pc_search_result.none-task-blog-2</a></del>all<del>sobaiduweb</del>default-4-117672692.142^v31^pc_rank_34,185^v2^control&amp;spm=1018.2226.3001.4187)</p>
<h2 id="FlareOn4-login"><a href="#FlareOn4-login" class="headerlink" title="[FlareOn4]login"></a>[FlareOn4]login</h2><p> 1.用记事本打开html文件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">Html</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>FLARE On 2017<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;flag&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;flag&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Enter the flag&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;prompt&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;Click to check the flag&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text/javascript&quot;</span>&gt;</span><span class="javascript"></span><br><span class="javascript">            <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;prompt&quot;</span>).onclick = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="javascript">                <span class="hljs-keyword">var</span> flag = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;flag&quot;</span>).value;</span><br><span class="javascript">                <span class="hljs-keyword">var</span> rotFlag = flag.replace(<span class="hljs-regexp">/[a-zA-Z]/g</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c</span>)</span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>.fromCharCode((c &lt;= <span class="hljs-string">&quot;Z&quot;</span> ? <span class="hljs-number">90</span> : <span class="hljs-number">122</span>) &gt;= (c = c.charCodeAt(<span class="hljs-number">0</span>) + <span class="hljs-number">13</span>) ? c : c - <span class="hljs-number">26</span>);&#125;);</span><br><span class="javascript">                <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;</span> == rotFlag) &#123;</span><br><span class="javascript">                    alert(<span class="hljs-string">&quot;Correct flag!&quot;</span>);</span><br><span class="javascript">                &#125; <span class="hljs-keyword">else</span> &#123; </span><br><span class="javascript">                    alert(<span class="hljs-string">&quot;Incorrect flag, rot again&quot;</span>);</span><br><span class="javascript">                &#125;</span><br><span class="javascript">            &#125;</span><br><span class="javascript">        </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></td></tr></table></figure>

<p>2.看关键加密代码</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html">var rotFlag = flag.replace(/[a-zA-Z]/g, <br>function(c)&#123;return String.fromCharCode<br>((c &lt;= &quot;Z&quot; ? 90 : 122) &gt;= (c = c.charCodeAt(0) + 13) ? c : c - 26);&#125;);<br></code></pre></td></tr></table></figure>

<p>主要意思就是如果c&lt;=”Z”就是90大于就是122，然后90或者122如果&gt;=(c=c+13),就为c<br />否则就是c-26<br />也就是说如果输入的字符中(A<del>M&amp;a</del>m)中的字符加13，(N<del>Z&amp;n</del>z)中的字符减13<br />根据if (“<a href="mailto:&#x50;&#121;&#x76;&#x72;&#x61;&#x67;&#x46;&#x76;&#x71;&#114;&#89;&#x62;&#116;&#118;&#97;&#x66;&#78;&#101;&#x72;&#x52;&#x6e;&#102;&#x6c;&#64;&#x73;&#121;&#x6e;&#101;&#x72;&#45;&#98;&#97;&#x2e;&#112;&#x62;&#x7a;">&#x50;&#121;&#x76;&#x72;&#x61;&#x67;&#x46;&#x76;&#x71;&#114;&#89;&#x62;&#116;&#118;&#97;&#x66;&#78;&#101;&#x72;&#x52;&#x6e;&#102;&#x6c;&#64;&#x73;&#121;&#x6e;&#101;&#x72;&#45;&#98;&#97;&#x2e;&#112;&#x62;&#x7a;</a>“ == rotFlag) {                   alert(“Correct flag!”);                }可以写脚本</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs html">c = &quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;<br>result=&quot;&quot;<br>for i in range(len(c)):<br>    if (c[i]&gt;=&#x27;A&#x27; and c[i]&lt;=&quot;M&quot;) or (c[i]&gt;=&#x27;a&#x27; and c[i]&lt;=&#x27;m&#x27;):<br>        v=ord(c[i])+13<br>    elif (c[i]&gt;=&#x27;N&#x27; and c[i]&lt;=&quot;Z&quot;) or (c[i]&gt;=&#x27;n&#x27; and c[i]&lt;=&#x27;z&#x27;):<br>        v=ord(c[i])-13<br>    else:<br>        v=ord(c[i])<br>    result+=chr(v)<br>print(&quot;flag&#123;&quot;+result+&quot;&#125;&quot;)<br></code></pre></td></tr></table></figure>

<p> 运行结果<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165424800.png" srcset="/img/loading.gif" lazyload alt="image-20220802165424800"></p>
<h2 id="GUET-CTF2019-re"><a href="#GUET-CTF2019-re" class="headerlink" title="[GUET-CTF2019]re"></a>[GUET-CTF2019]re</h2><p>先脱壳，用吾爱的脱壳没找到合适的，用kali自带的，可以看到还是64位<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165449596.png" srcset="/img/loading.gif" lazyload alt="image-20220802165449596"><br />看反汇编</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function">__int64 <span class="hljs-title">sub_400E28</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *v0; <span class="hljs-comment">// rdi</span><br>    __int64 result; <span class="hljs-comment">// rax</span><br>    __int64 v2; <span class="hljs-comment">// rdx</span><br>    <span class="hljs-keyword">unsigned</span> __int64 v3; <span class="hljs-comment">// rt1</span><br>    __int64 v4; <span class="hljs-comment">// [rsp+0h] [rbp-30h]</span><br>    __int64 v5; <span class="hljs-comment">// [rsp+8h] [rbp-28h]</span><br>    __int64 v6; <span class="hljs-comment">// [rsp+10h] [rbp-20h]</span><br>    __int64 v7; <span class="hljs-comment">// [rsp+18h] [rbp-18h]</span><br>    <span class="hljs-keyword">unsigned</span> __int64 v8; <span class="hljs-comment">// [rsp+28h] [rbp-8h]</span><br>    <br>    v8 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>    v4 = <span class="hljs-number">0LL</span>;<br>    v5 = <span class="hljs-number">0LL</span>;<br>    v6 = <span class="hljs-number">0LL</span>;<br>    v7 = <span class="hljs-number">0LL</span>;<br>    sub_40F950(<span class="hljs-string">&quot;input your flag:&quot;</span>, <span class="hljs-number">0LL</span>, <span class="hljs-number">0LL</span>, <span class="hljs-number">0LL</span>, <span class="hljs-number">0LL</span>);<br>    sub_40FA80(<span class="hljs-string">&quot;%s&quot;</span>, &amp;v4);<br>    <span class="hljs-keyword">if</span> ( sub_4009AE(&amp;v4) )<br>    &#123;<br>        v0 = <span class="hljs-string">&quot;Correct!&quot;</span>;<br>        sub_410350(<span class="hljs-string">&quot;Correct!&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        v0 = <span class="hljs-string">&quot;Wrong!&quot;</span>;<br>        sub_410350(<span class="hljs-string">&quot;Wrong!&quot;</span>);<br>    &#125;<br>    result = <span class="hljs-number">0LL</span>;<br>    v3 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>    v2 = v3 ^ v8;<br>    <span class="hljs-keyword">if</span> ( v3 != v8 )<br>        sub_443550(v0, &amp;v4, v2);<br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>然后我们看20行的sub_4009AE，需要满足返回为true，点进去看看这个函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function">_BOOL8 __fastcall <span class="hljs-title">sub_4009AE</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *a1)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">1629056</span> * *a1 != <span class="hljs-number">166163712</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">6771600</span> * a1[<span class="hljs-number">1</span>] != <span class="hljs-number">731332800</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">3682944</span> * a1[<span class="hljs-number">2</span>] != <span class="hljs-number">357245568</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">10431000</span> * a1[<span class="hljs-number">3</span>] != <span class="hljs-number">1074393000</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">3977328</span> * a1[<span class="hljs-number">4</span>] != <span class="hljs-number">489211344</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">5138336</span> * a1[<span class="hljs-number">5</span>] != <span class="hljs-number">518971936</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">7532250</span> * a1[<span class="hljs-number">7</span>] != <span class="hljs-number">406741500</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">5551632</span> * a1[<span class="hljs-number">8</span>] != <span class="hljs-number">294236496</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">3409728</span> * a1[<span class="hljs-number">9</span>] != <span class="hljs-number">177305856</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">13013670</span> * a1[<span class="hljs-number">10</span>] != <span class="hljs-number">650683500</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">6088797</span> * a1[<span class="hljs-number">11</span>] != <span class="hljs-number">298351053</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">7884663</span> * a1[<span class="hljs-number">12</span>] != <span class="hljs-number">386348487</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">8944053</span> * a1[<span class="hljs-number">13</span>] != <span class="hljs-number">438258597</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">5198490</span> * a1[<span class="hljs-number">14</span>] != <span class="hljs-number">249527520</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">4544518</span> * a1[<span class="hljs-number">15</span>] != <span class="hljs-number">445362764</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">3645600</span> * a1[<span class="hljs-number">17</span>] != <span class="hljs-number">174988800</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">10115280</span> * a1[<span class="hljs-number">16</span>] != <span class="hljs-number">981182160</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">9667504</span> * a1[<span class="hljs-number">18</span>] != <span class="hljs-number">493042704</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">5364450</span> * a1[<span class="hljs-number">19</span>] != <span class="hljs-number">257493600</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">13464540</span> * a1[<span class="hljs-number">20</span>] != <span class="hljs-number">767478780</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">5488432</span> * a1[<span class="hljs-number">21</span>] != <span class="hljs-number">312840624</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">14479500</span> * a1[<span class="hljs-number">22</span>] != <span class="hljs-number">1404511500</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">6451830</span> * a1[<span class="hljs-number">23</span>] != <span class="hljs-number">316139670</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">6252576</span> * a1[<span class="hljs-number">24</span>] != <span class="hljs-number">619005024</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">7763364</span> * a1[<span class="hljs-number">25</span>] != <span class="hljs-number">372641472</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">7327320</span> * a1[<span class="hljs-number">26</span>] != <span class="hljs-number">373693320</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">8741520</span> * a1[<span class="hljs-number">27</span>] != <span class="hljs-number">498266640</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">8871876</span> * a1[<span class="hljs-number">28</span>] != <span class="hljs-number">452465676</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">4086720</span> * a1[<span class="hljs-number">29</span>] != <span class="hljs-number">208422720</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-number">9374400</span> * a1[<span class="hljs-number">30</span>] == <span class="hljs-number">515592000</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">5759124</span> * a1[<span class="hljs-number">31</span>] == <span class="hljs-number">719890500</span>;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这道题出的有点马虎，a[6]的值都不给，有大佬直接爆出来了为1，<br />直接写脚本，抄大佬的   。^   。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs c">a = []<br>a.append(<span class="hljs-number">166163712</span> <span class="hljs-comment">// 1629056)</span><br>a.append(<span class="hljs-number">731332800</span> <span class="hljs-comment">// 6771600)</span><br>a.append(<span class="hljs-number">357245568</span> <span class="hljs-comment">// 3682944)</span><br>a.append(<span class="hljs-number">1074393000</span> <span class="hljs-comment">// 10431000)</span><br>a.append(<span class="hljs-number">489211344</span> <span class="hljs-comment">// 3977328)</span><br>a.append(<span class="hljs-number">518971936</span> <span class="hljs-comment">// 5138336)</span><br>a.append(ord(<span class="hljs-string">&#x27;1&#x27;</span>))<br>a.append(<span class="hljs-number">406741500</span> <span class="hljs-comment">// 7532250)</span><br>a.append(<span class="hljs-number">294236496</span> <span class="hljs-comment">// 5551632)</span><br>a.append(<span class="hljs-number">177305856</span> <span class="hljs-comment">// 3409728)</span><br>a.append(<span class="hljs-number">650683500</span> <span class="hljs-comment">// 13013670)</span><br>a.append(<span class="hljs-number">298351053</span> <span class="hljs-comment">// 6088797)</span><br>a.append(<span class="hljs-number">386348487</span> <span class="hljs-comment">// 7884663)</span><br>a.append(<span class="hljs-number">438258597</span> <span class="hljs-comment">// 8944053)</span><br>a.append(<span class="hljs-number">249527520</span> <span class="hljs-comment">// 5198490)</span><br>a.append(<span class="hljs-number">445362764</span> <span class="hljs-comment">// 4544518)</span><br>a.append(<span class="hljs-number">981182160</span> <span class="hljs-comment">// 10115280)</span><br>a.append(<span class="hljs-number">174988800</span> <span class="hljs-comment">// 3645600)</span><br>a.append(<span class="hljs-number">493042704</span> <span class="hljs-comment">// 9667504)</span><br>a.append(<span class="hljs-number">257493600</span> <span class="hljs-comment">// 5364450)</span><br>a.append(<span class="hljs-number">767478780</span> <span class="hljs-comment">// 13464540)</span><br>a.append(<span class="hljs-number">312840624</span> <span class="hljs-comment">// 5488432)</span><br>a.append(<span class="hljs-number">1404511500</span> <span class="hljs-comment">// 14479500)</span><br>a.append(<span class="hljs-number">316139670</span> <span class="hljs-comment">// 6451830)</span><br>a.append(<span class="hljs-number">619005024</span> <span class="hljs-comment">// 6252576)</span><br>a.append(<span class="hljs-number">372641472</span> <span class="hljs-comment">// 7763364)</span><br>a.append(<span class="hljs-number">373693320</span> <span class="hljs-comment">// 7327320)</span><br>a.append(<span class="hljs-number">498266640</span> <span class="hljs-comment">// 8741520)</span><br>a.append(<span class="hljs-number">452465676</span> <span class="hljs-comment">// 8871876)</span><br>a.append(<span class="hljs-number">208422720</span> <span class="hljs-comment">// 4086720)</span><br>a.append(<span class="hljs-number">515592000</span> <span class="hljs-comment">// 9374400)</span><br>a.append(<span class="hljs-number">719890500</span> <span class="hljs-comment">// 5759124)</span><br><br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> x in a:<br>    flag = flag + chr(x)<br>print(flag)     <span class="hljs-meta"># flag&#123;e165421110ba03099a1c039337&#125;</span><br><br></code></pre></td></tr></table></figure>

<h2 id="2019红帽杯-easyRE"><a href="#2019红帽杯-easyRE" class="headerlink" title="[2019红帽杯]easyRE"></a>[2019红帽杯]easyRE</h2><p>用ida看反汇编</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">signed</span> __int64 <span class="hljs-title">sub_4009C6</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">char</span> *v0; <span class="hljs-comment">// rsi</span><br>  <span class="hljs-keyword">char</span> *v1; <span class="hljs-comment">// rdi</span><br>  __int64 v2; <span class="hljs-comment">// rax</span><br>  <span class="hljs-keyword">signed</span> __int64 result; <span class="hljs-comment">// rax</span><br>  <span class="hljs-keyword">unsigned</span> __int64 v4; <span class="hljs-comment">// rax</span><br>  __int64 v5; <span class="hljs-comment">// rax</span><br>  __int64 v6; <span class="hljs-comment">// ST10_8</span><br>  __int64 v7; <span class="hljs-comment">// ST18_8</span><br>  __int64 v8; <span class="hljs-comment">// ST20_8</span><br>  __int64 v9; <span class="hljs-comment">// ST28_8</span><br>  __int64 v10; <span class="hljs-comment">// ST30_8</span><br>  __int64 v11; <span class="hljs-comment">// ST38_8</span><br>  __int64 v12; <span class="hljs-comment">// ST40_8</span><br>  __int64 v13; <span class="hljs-comment">// ST48_8</span><br>  __int64 v14; <span class="hljs-comment">// ST50_8</span><br>  __int64 v15; <span class="hljs-comment">// ST58_8</span><br>  <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [rsp+Ch] [rbp-114h]</span><br>  <span class="hljs-keyword">char</span> v17; <span class="hljs-comment">// [rsp+60h] [rbp-C0h]</span><br>  <span class="hljs-keyword">char</span> v18; <span class="hljs-comment">// [rsp+61h] [rbp-BFh]</span><br>  <span class="hljs-keyword">char</span> v19; <span class="hljs-comment">// [rsp+62h] [rbp-BEh]</span><br>  <span class="hljs-keyword">char</span> v20; <span class="hljs-comment">// [rsp+63h] [rbp-BDh]</span><br>  <span class="hljs-keyword">char</span> v21; <span class="hljs-comment">// [rsp+64h] [rbp-BCh]</span><br>  <span class="hljs-keyword">char</span> v22; <span class="hljs-comment">// [rsp+65h] [rbp-BBh]</span><br>  <span class="hljs-keyword">char</span> v23; <span class="hljs-comment">// [rsp+66h] [rbp-BAh]</span><br>  <span class="hljs-keyword">char</span> v24; <span class="hljs-comment">// [rsp+67h] [rbp-B9h]</span><br>  <span class="hljs-keyword">char</span> v25; <span class="hljs-comment">// [rsp+68h] [rbp-B8h]</span><br>  <span class="hljs-keyword">char</span> v26; <span class="hljs-comment">// [rsp+69h] [rbp-B7h]</span><br>  <span class="hljs-keyword">char</span> v27; <span class="hljs-comment">// [rsp+6Ah] [rbp-B6h]</span><br>  <span class="hljs-keyword">char</span> v28; <span class="hljs-comment">// [rsp+6Bh] [rbp-B5h]</span><br>  <span class="hljs-keyword">char</span> v29; <span class="hljs-comment">// [rsp+6Ch] [rbp-B4h]</span><br>  <span class="hljs-keyword">char</span> v30; <span class="hljs-comment">// [rsp+6Dh] [rbp-B3h]</span><br>  <span class="hljs-keyword">char</span> v31; <span class="hljs-comment">// [rsp+6Eh] [rbp-B2h]</span><br>  <span class="hljs-keyword">char</span> v32; <span class="hljs-comment">// [rsp+6Fh] [rbp-B1h]</span><br>  <span class="hljs-keyword">char</span> v33; <span class="hljs-comment">// [rsp+70h] [rbp-B0h]</span><br>  <span class="hljs-keyword">char</span> v34; <span class="hljs-comment">// [rsp+71h] [rbp-AFh]</span><br>  <span class="hljs-keyword">char</span> v35; <span class="hljs-comment">// [rsp+72h] [rbp-AEh]</span><br>  <span class="hljs-keyword">char</span> v36; <span class="hljs-comment">// [rsp+73h] [rbp-ADh]</span><br>  <span class="hljs-keyword">char</span> v37; <span class="hljs-comment">// [rsp+74h] [rbp-ACh]</span><br>  <span class="hljs-keyword">char</span> v38; <span class="hljs-comment">// [rsp+75h] [rbp-ABh]</span><br>  <span class="hljs-keyword">char</span> v39; <span class="hljs-comment">// [rsp+76h] [rbp-AAh]</span><br>  <span class="hljs-keyword">char</span> v40; <span class="hljs-comment">// [rsp+77h] [rbp-A9h]</span><br>  <span class="hljs-keyword">char</span> v41; <span class="hljs-comment">// [rsp+78h] [rbp-A8h]</span><br>  <span class="hljs-keyword">char</span> v42; <span class="hljs-comment">// [rsp+79h] [rbp-A7h]</span><br>  <span class="hljs-keyword">char</span> v43; <span class="hljs-comment">// [rsp+7Ah] [rbp-A6h]</span><br>  <span class="hljs-keyword">char</span> v44; <span class="hljs-comment">// [rsp+7Bh] [rbp-A5h]</span><br>  <span class="hljs-keyword">char</span> v45; <span class="hljs-comment">// [rsp+7Ch] [rbp-A4h]</span><br>  <span class="hljs-keyword">char</span> v46; <span class="hljs-comment">// [rsp+7Dh] [rbp-A3h]</span><br>  <span class="hljs-keyword">char</span> v47; <span class="hljs-comment">// [rsp+7Eh] [rbp-A2h]</span><br>  <span class="hljs-keyword">char</span> v48; <span class="hljs-comment">// [rsp+7Fh] [rbp-A1h]</span><br>  <span class="hljs-keyword">char</span> v49; <span class="hljs-comment">// [rsp+80h] [rbp-A0h]</span><br>  <span class="hljs-keyword">char</span> v50; <span class="hljs-comment">// [rsp+81h] [rbp-9Fh]</span><br>  <span class="hljs-keyword">char</span> v51; <span class="hljs-comment">// [rsp+82h] [rbp-9Eh]</span><br>  <span class="hljs-keyword">char</span> v52; <span class="hljs-comment">// [rsp+83h] [rbp-9Dh]</span><br>  <span class="hljs-keyword">char</span> v53[<span class="hljs-number">32</span>]; <span class="hljs-comment">// [rsp+90h] [rbp-90h]</span><br>  <span class="hljs-keyword">int</span> v54; <span class="hljs-comment">// [rsp+B0h] [rbp-70h]</span><br>  <span class="hljs-keyword">char</span> v55; <span class="hljs-comment">// [rsp+B4h] [rbp-6Ch]</span><br>  <span class="hljs-keyword">char</span> v56; <span class="hljs-comment">// [rsp+C0h] [rbp-60h]</span><br>  <span class="hljs-keyword">char</span> v57; <span class="hljs-comment">// [rsp+E7h] [rbp-39h]</span><br>  <span class="hljs-keyword">char</span> v58; <span class="hljs-comment">// [rsp+100h] [rbp-20h]</span><br>  <span class="hljs-keyword">unsigned</span> __int64 v59; <span class="hljs-comment">// [rsp+108h] [rbp-18h]</span><br><br>  v59 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  v17 = <span class="hljs-number">73</span>;<br>  v18 = <span class="hljs-number">111</span>;<br>  v19 = <span class="hljs-number">100</span>;<br>  v20 = <span class="hljs-number">108</span>;<br>  v21 = <span class="hljs-number">62</span>;<br>  v22 = <span class="hljs-number">81</span>;<br>  v23 = <span class="hljs-number">110</span>;<br>  v24 = <span class="hljs-number">98</span>;<br>  v25 = <span class="hljs-number">40</span>;<br>  v26 = <span class="hljs-number">111</span>;<br>  v27 = <span class="hljs-number">99</span>;<br>  v28 = <span class="hljs-number">121</span>;<br>  v29 = <span class="hljs-number">127</span>;<br>  v30 = <span class="hljs-number">121</span>;<br>  v31 = <span class="hljs-number">46</span>;<br>  v32 = <span class="hljs-number">105</span>;<br>  v33 = <span class="hljs-number">127</span>;<br>  v34 = <span class="hljs-number">100</span>;<br>  v35 = <span class="hljs-number">96</span>;<br>  v36 = <span class="hljs-number">51</span>;<br>  v37 = <span class="hljs-number">119</span>;<br>  v38 = <span class="hljs-number">125</span>;<br>  v39 = <span class="hljs-number">119</span>;<br>  v40 = <span class="hljs-number">101</span>;<br>  v41 = <span class="hljs-number">107</span>;<br>  v42 = <span class="hljs-number">57</span>;<br>  v43 = <span class="hljs-number">123</span>;<br>  v44 = <span class="hljs-number">105</span>;<br>  v45 = <span class="hljs-number">121</span>;<br>  v46 = <span class="hljs-number">61</span>;<br>  v47 = <span class="hljs-number">126</span>;<br>  v48 = <span class="hljs-number">121</span>;<br>  v49 = <span class="hljs-number">76</span>;<br>  v50 = <span class="hljs-number">64</span>;<br>  v51 = <span class="hljs-number">69</span>;<br>  v52 = <span class="hljs-number">67</span>;<br>  <span class="hljs-built_in">memset</span>(v53, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(v53));<br>  v54 = <span class="hljs-number">0</span>;<br>  v55 = <span class="hljs-number">0</span>;<br>  v0 = v53;<br>  sub_4406E0(<span class="hljs-number">0LL</span>, v53, <span class="hljs-number">37LL</span>);<br>  v55 = <span class="hljs-number">0</span>;<br>  v1 = v53;<br>  LODWORD(v2) = sub_424BA0(v53);<br>  <span class="hljs-keyword">if</span> ( v2 == <span class="hljs-number">36</span> )<br>  &#123;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; ; ++i )<br>    &#123;<br>      v1 = v53;<br>      LODWORD(v4) = sub_424BA0(v53);<br>      <span class="hljs-keyword">if</span> ( i &gt;= v4 )<br>        <span class="hljs-keyword">break</span>;<br>      <span class="hljs-keyword">if</span> ( (v53[i] ^ i) != *(&amp;v17 + i) )<br>      &#123;<br>        result = <span class="hljs-number">4294967294LL</span>;<br>        <span class="hljs-keyword">goto</span> LABEL_13;<br>      &#125;<br>    &#125;<br>    sub_410CC0(<span class="hljs-string">&quot;continue!&quot;</span>);<br>    <span class="hljs-built_in">memset</span>(&amp;v56, <span class="hljs-number">0</span>, <span class="hljs-number">0x40</span>uLL);<br>    v58 = <span class="hljs-number">0</span>;<br>    v0 = &amp;v56;<br>    sub_4406E0(<span class="hljs-number">0LL</span>, &amp;v56, <span class="hljs-number">64LL</span>);<br>    v57 = <span class="hljs-number">0</span>;<br>    v1 = &amp;v56;<br>    LODWORD(v5) = sub_424BA0(&amp;v56);<br>    <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">39</span> )<br>    &#123;<br>      v6 = sub_400E44(&amp;v56);<br>      v7 = sub_400E44(v6);<br>      v8 = sub_400E44(v7);<br>      v9 = sub_400E44(v8);<br>      v10 = sub_400E44(v9);<br>      v11 = sub_400E44(v10);<br>      v12 = sub_400E44(v11);<br>      v13 = sub_400E44(v12);<br>      v14 = sub_400E44(v13);<br>      v15 = sub_400E44(v14);<br>      v0 = off_6CC090;<br>      v1 = v15;<br>      <span class="hljs-keyword">if</span> ( !sub_400360(v15, off_6CC090) )<br>      &#123;<br>        sub_410CC0(<span class="hljs-string">&quot;You found me!!!&quot;</span>);<br>        v1 = <span class="hljs-string">&quot;bye bye~&quot;</span>;<br>        sub_410CC0(<span class="hljs-string">&quot;bye bye~&quot;</span>);<br>      &#125;<br>      result = <span class="hljs-number">0LL</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      result = <span class="hljs-number">4294967293LL</span>;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    result = <span class="hljs-number">0xFFFFFFFF</span>LL;<br>  &#125;<br>LABEL_13:<br>  <span class="hljs-keyword">if</span> ( __readfsqword(<span class="hljs-number">0x28</span>u) != v59 )<br>    sub_444020(v1, v0);<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>先把v53解出来，给我们提示说flag前四位是”flag”</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">v17 = [<span class="hljs-number">73</span>,<span class="hljs-number">111</span>,<span class="hljs-number">100</span>,<span class="hljs-number">108</span>,<span class="hljs-number">62</span>,<span class="hljs-number">81</span>,<span class="hljs-number">110</span>,<span class="hljs-number">98</span>,<span class="hljs-number">40</span>,<span class="hljs-number">111</span>,<span class="hljs-number">99</span>,<span class="hljs-number">121</span>,<span class="hljs-number">127</span>,<span class="hljs-number">121</span>,<span class="hljs-number">46</span>,<span class="hljs-number">105</span>,<span class="hljs-number">127</span>,<span class="hljs-number">100</span>,<span class="hljs-number">96</span>,<span class="hljs-number">51</span>,<span class="hljs-number">119</span>,<span class="hljs-number">125</span>,<span class="hljs-number">119</span>,<span class="hljs-number">101</span>,<span class="hljs-number">107</span>,<span class="hljs-number">57</span>,<span class="hljs-number">123</span>,<span class="hljs-number">105</span>,<span class="hljs-number">121</span>,<span class="hljs-number">61</span>,<span class="hljs-number">126</span>,<span class="hljs-number">121</span>,<span class="hljs-number">76</span>,<span class="hljs-number">64</span>,<span class="hljs-number">69</span>,<span class="hljs-number">67</span>]<br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(v17)):<br>    flag+=<span class="hljs-built_in">chr</span>(v17[i]^i)<br><span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure>

<p><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165527014.png" srcset="/img/loading.gif" lazyload alt="image-20220802165527014"><br />然后接着看sub_400E44这个函数<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165605546.png" srcset="/img/loading.gif" lazyload alt="image.png"><br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165626727.png" srcset="/img/loading.gif" lazyload alt="image-20220802165626727"><br />很明显是base64加密，而且还加密了10次，那就把off_6CC090里面的数据解码10次</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> ( v3 == <span class="hljs-number">39</span> )<br>&#123;<br>    v4 = sub_400E44(&amp;v54);<br>    v5 = sub_400E44(v4);<br>    v6 = sub_400E44(v5);<br>    v7 = sub_400E44(v6);<br>    v8 = sub_400E44(v7);<br>    v9 = sub_400E44(v8);<br>    v10 = sub_400E44(v9);<br>    v11 = sub_400E44(v10);<br>    v12 = sub_400E44(v11);<br>    v13 = sub_400E44(v12);<br>    <span class="hljs-keyword">if</span> ( !sub_400360(v13, off_6CC090) )<br>    &#123;<br>        sub_410CC0(<span class="hljs-string">&quot;You found me!!!&quot;</span>);<br>        sub_410CC0(<span class="hljs-string">&quot;bye bye~&quot;</span>);<br>      &#125;<br></code></pre></td></tr></table></figure>

<p>看一下off_6CC090里面的数据<img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165645888.png" srcset="/img/loading.gif" lazyload alt="image-20220802165645888"><br />后面有省略号，说明不止这些，再点进去看看，也是能经得起10次加密的长度了<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802165710648.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />写个脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br>a=<span class="hljs-string">&quot;Vm0wd2VHUXhTWGhpUm1SWVYwZDRWVll3Wkc5WFJsbDNXa1pPVlUxV2NIcFhhMk0xVmpKS1NHVkdXbFpOYmtKVVZtcEtTMUl5VGtsaVJtUk9ZV3hhZVZadGVHdFRNVTVYVW01T2FGSnRVbGhhVjNoaFZWWmtWMXBFVWxSTmJFcElWbTAxVDJGV1NuTlhia0pXWWxob1dGUnJXbXRXTVZaeVdrWm9hVlpyV1hwV1IzaGhXVmRHVjFOdVVsWmlhMHBZV1ZSR1lWZEdVbFZTYlhSWFRWWndNRlZ0TVc5VWJGcFZWbXR3VjJKSFVYZFdha1pXWlZaT2NtRkhhRk5pVjJoWVYxZDBhMVV3TlhOalJscFlZbGhTY1ZsclduZGxiR1J5VmxSR1ZXSlZjRWhaTUZKaFZqSktWVkZZYUZkV1JWcFlWV3BHYTFkWFRrZFRiV3hvVFVoQ1dsWXhaRFJpTWtsM1RVaG9hbEpYYUhOVmJUVkRZekZhY1ZKcmRGTk5Wa3A2VjJ0U1ExWlhTbFpqUldoYVRVWndkbFpxUmtwbGJVWklZVVprYUdFeGNHOVhXSEJIWkRGS2RGSnJhR2hTYXpWdlZGVm9RMlJzV25STldHUlZUVlpXTlZadE5VOVdiVXBJVld4c1dtSllUWGhXTUZwell6RmFkRkpzVWxOaVNFSktWa1phVTFFeFduUlRhMlJxVWxad1YxWnRlRXRXTVZaSFVsUnNVVlZVTURrPQ==&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    a = <span class="hljs-built_in">str</span>(base64.b64decode(a), <span class="hljs-string">&quot;utf-8&quot;</span>)<br><span class="hljs-built_in">print</span>(a)<br></code></pre></td></tr></table></figure>

<p>结果是一个网站<br /><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-254172.htm">https://bbs.pediy.com/thread-254172.htm</a><br />他真的很擅长主动防御<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170218561.png" srcset="/img/loading.gif" lazyload alt="image-20220802170218561"><br />看来这个函数坑小孩的，mad，根据提示我们知道前四位是flag，然后这串字符串很可疑，<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170246656.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />跟进调用它的函数，看反汇编</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function">__int64 <span class="hljs-title">sub_400D35</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    __int64 result; <span class="hljs-comment">// rax</span><br>    <span class="hljs-keyword">unsigned</span> __int64 v1; <span class="hljs-comment">// rt1</span><br>    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v2; <span class="hljs-comment">// [rsp+Ch] [rbp-24h]</span><br>    <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [rsp+10h] [rbp-20h]</span><br>    <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> j; <span class="hljs-comment">// [rsp+14h] [rbp-1Ch]</span><br>    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v5; <span class="hljs-comment">// [rsp+24h] [rbp-Ch]</span><br>    <span class="hljs-keyword">unsigned</span> __int64 v6; <span class="hljs-comment">// [rsp+28h] [rbp-8h]</span><br>    <br>    v6 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>    v2 = sub_43FD20(<span class="hljs-number">0LL</span>) - qword_6CEE38;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">1233</span>; ++i )<br>    &#123;<br>        sub_40F790(v2);<br>        sub_40FE60();<br>        sub_40FE60();<br>        v2 = sub_40FE60() ^ <span class="hljs-number">0x98765432</span>;<br>    &#125;<br>    v5 = v2;<br>    <span class="hljs-keyword">if</span> ( (v2 ^ byte_6CC0A0[<span class="hljs-number">0</span>]) == <span class="hljs-number">102</span> &amp;&amp; (HIBYTE(v5) ^ byte_6CC0A3) == <span class="hljs-number">103</span> )<br>    &#123;<br>        <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">24</span>; ++j )<br>            sub_410E90((byte_6CC0A0[j] ^ *(&amp;v5 + j % <span class="hljs-number">4</span>)));<br>    &#125;<br>    v1 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>    result = v1 ^ v6;<br>    <span class="hljs-keyword">if</span> ( v1 != v6 )<br>        sub_444020();<br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>102，103对应的ascii码是’f’,’g’，这个应该是了，后面这个加密不是太明白<br />HIBYTE()是取最后一个字节，v6的求法也就是让byte_6CC0A3与’flag’进行异或逆出来v6，然后v6再跟byte_6CC0A0异或得到v0</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">if</span> ( (v3 ^ byte_6CC0A0[<span class="hljs-number">0</span>]) == <span class="hljs-string">&#x27;f&#x27;</span> &amp;&amp; (HIBYTE(v6) ^ byte_6CC0A3) == <span class="hljs-string">&#x27;g&#x27;</span> )<br>  &#123;<br>    <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">24</span>; ++j )<br>    &#123;<br>      v0 = (byte_6CC0A0[j] ^ *(&amp;v6 + j % <span class="hljs-number">4</span>));<br>      sub_410E90(v0);<br>    &#125;<br>  &#125;<br></code></pre></td></tr></table></figure>

<p>写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">c=[<span class="hljs-number">0x40</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x2F</span>,<br>  <span class="hljs-number">0x24</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x6E</span>,<br>  <span class="hljs-number">0x72</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x5B</span>]<br>d=[<span class="hljs-string">&#x27;f&#x27;</span>,<span class="hljs-string">&#x27;l&#x27;</span>,<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;g&#x27;</span>]<br>e=[]<br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>    e.append((<span class="hljs-built_in">chr</span>(c[i]^<span class="hljs-built_in">ord</span>(d[i]))))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(c)):<br>    flag+=<span class="hljs-built_in">chr</span>(c[i]^<span class="hljs-built_in">ord</span>(e[i%<span class="hljs-number">4</span>]))<br><span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure>

<h2 id="WUSTCTF2020-level1"><a href="#WUSTCTF2020-level1" class="headerlink" title="[WUSTCTF2020]level1"></a>[WUSTCTF2020]level1</h2><p>1.首先看main函数反汇编</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function"></span>&#123;<br>  FILE *stream; <span class="hljs-comment">// ST08_8</span><br>  <span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [rsp+4h] [rbp-2Ch]</span><br>  <span class="hljs-keyword">char</span> ptr[<span class="hljs-number">24</span>]; <span class="hljs-comment">// [rsp+10h] [rbp-20h]</span><br>  <span class="hljs-keyword">unsigned</span> __int64 v7; <span class="hljs-comment">// [rsp+28h] [rbp-8h]</span><br><br>  v7 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  stream = fopen(<span class="hljs-string">&quot;flag&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>);<br>  fread(ptr, <span class="hljs-number">1uLL</span>, <span class="hljs-number">0x14</span>uLL, stream);<br>  fclose(stream);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">19</span>; ++i )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( i &amp; <span class="hljs-number">1</span> )<br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%ld\n&quot;</span>, (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)(ptr[i] &lt;&lt; i));<br>    <span class="hljs-keyword">else</span><br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%ld\n&quot;</span>, (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)(i * ptr[i]));<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>2.这是涉及到了输入输出流吧(其实我也不懂)，文件中还给了一串数字<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170308338.png" srcset="/img/loading.gif" lazyload alt="image-20220802170308338"><br />3.根据这一串加密的我们逆出来解密过程，可以发现数组中的第一个元素没有使用，那我们逆的时候在数组中最前面要添上一个数，随便什么都可以</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> ( i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">19</span>; ++i )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( i &amp; <span class="hljs-number">1</span> )<br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%ld\n&quot;</span>, (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)(ptr[i] &lt;&lt; i));<br>    <span class="hljs-keyword">else</span><br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%ld\n&quot;</span>, (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)(i * ptr[i]));<br>  &#125;<br></code></pre></td></tr></table></figure>

<p>4.脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[<span class="hljs-number">0</span>,<span class="hljs-number">198</span>,<span class="hljs-number">232</span>,<span class="hljs-number">816</span>,<span class="hljs-number">200</span>,<span class="hljs-number">1536</span>,<span class="hljs-number">300</span>,<span class="hljs-number">6144</span>,<span class="hljs-number">984</span>,<span class="hljs-number">51200</span>,<span class="hljs-number">570</span>,<span class="hljs-number">92160</span>,<span class="hljs-number">1200</span>,<span class="hljs-number">565248</span>,<span class="hljs-number">756</span>,<span class="hljs-number">1474560</span>,<span class="hljs-number">800</span>,<span class="hljs-number">6291456</span>,<span class="hljs-number">1782</span>,<span class="hljs-number">65536000</span>]<br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(a)):<br>    <span class="hljs-keyword">if</span> i&amp;<span class="hljs-number">1</span>:<br>       flag+=<span class="hljs-built_in">chr</span>(a[i]&gt;&gt;i)<br>    <span class="hljs-keyword">else</span>:<br>        flag+=<span class="hljs-built_in">chr</span>(a[i]//i)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h2 id="MRCTF2020-Transform"><a href="#MRCTF2020-Transform" class="headerlink" title="[MRCTF2020]Transform"></a>[MRCTF2020]Transform</h2><p>1.看main的反汇编</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-comment">// local variable allocation has failed, the output may be wrong!</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function"></span>&#123;<br>  __int64 v3; <span class="hljs-comment">// rdx</span><br>  __int64 v4; <span class="hljs-comment">// rdx</span><br>  <span class="hljs-keyword">char</span> v6[<span class="hljs-number">104</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-70h]</span><br>  <span class="hljs-keyword">int</span> j; <span class="hljs-comment">// [rsp+88h] [rbp-8h]</span><br>  <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [rsp+8Ch] [rbp-4h]</span><br><br>  sub_402230(argc, argv, envp);<br>  sub_40E640(argc, argv, v3, <span class="hljs-string">&quot;Give me your code:\n&quot;</span>);<br>  sub_40E5F0(argc, argv, v6, <span class="hljs-string">&quot;%s&quot;</span>);<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strlen</span>(*&amp;argc) != <span class="hljs-number">33</span> )  <span class="hljs-comment">//判断输入字符串长度是否为33</span><br>  &#123;<br>    sub_40E640(argc, argv, v4, <span class="hljs-string">&quot;Wrong!\n&quot;</span>);<br>    system(*&amp;argc);<br>    <span class="hljs-built_in">exit</span>(argc);<br>  &#125;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">32</span>; ++i )<br>  &#123;<br>    byte_414040[i] = v6[dword_40F040[i]];  <br>    v4 = i;<br>    byte_414040[i] ^= LOBYTE(dword_40F040[i]); <span class="hljs-comment">// LOBYTE在这里其实没什么作用</span><br>  &#125;<br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">32</span>; ++j )<br>  &#123;<br>    v4 = j;<br>    <span class="hljs-keyword">if</span> ( aGyURsywBFbLwya[j] != byte_414040[j] ) <br>    &#123;<br>      sub_40E640(argc, argv, j, <span class="hljs-string">&quot;Wrong!\n&quot;</span>);<br>      system(*&amp;argc);<br>      <span class="hljs-built_in">exit</span>(argc);<br>    &#125;<br>  &#125;<br>  sub_40E640(argc, argv, v4, <span class="hljs-string">&quot;Right!Good Job!\n&quot;</span>);<br>  sub_40E640(argc, argv, v6, <span class="hljs-string">&quot;Here is your flag: %s\n&quot;</span>);<br>  system(*&amp;argc);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>2.看主要加密代码，主要意思就是输入的字符数组的第（dword_40F040[i]-1）个元素赋给byte_414040[i]，然后再让byte_414040[i]与dword_40F040[i]进行异或加密<br />最后跟aGyURsywBFbLwya这个数组进行比较（这些数组都可以点进去查看）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">32</span>; ++i )<br>  &#123;<br>    byte_414040[i] = v6[dword_40F040[i]];<br>    v4 = i;<br>    byte_414040[i] ^= LOBYTE(dword_40F040[i]);<br>  &#125;<br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">32</span>; ++j )<br>  &#123;<br>    v4 = j;<br>    <span class="hljs-keyword">if</span> ( aGyURsywBFbLwya[j] != byte_414040[j] )<br>    &#123;<br>      sub_40E640(argc, argv, j, <span class="hljs-string">&quot;Wrong!\n&quot;</span>);<br>      system(*&amp;argc);<br>      <span class="hljs-built_in">exit</span>(argc);<br>    &#125;<br>  &#125;<br></code></pre></td></tr></table></figure>

<p>3.写脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">a=[ <span class="hljs-number">9</span>,  <span class="hljs-number">10</span>,   <span class="hljs-number">15</span>,     <span class="hljs-number">23</span>,   <span class="hljs-number">7</span>,    <span class="hljs-number">24</span>,  <span class="hljs-number">12</span>,   <span class="hljs-number">6</span>,       <span class="hljs-number">1</span>,  <span class="hljs-number">16</span>,    <span class="hljs-number">3</span>,  <span class="hljs-number">17</span>,  <span class="hljs-number">32</span>,     <span class="hljs-number">29</span>,  <span class="hljs-number">11</span>,    <span class="hljs-number">30</span>,  <span class="hljs-number">27</span>,  <span class="hljs-number">22</span>,      <span class="hljs-number">4</span>,  <span class="hljs-number">13</span>,    <span class="hljs-number">19</span>,  <span class="hljs-number">20</span>,  <span class="hljs-number">21</span>,       <span class="hljs-number">2</span>,  <span class="hljs-number">25</span>,     <span class="hljs-number">5</span>,  <span class="hljs-number">31</span>,   <span class="hljs-number">8</span>,      <span class="hljs-number">18</span>,  <span class="hljs-number">26</span>,    <span class="hljs-number">28</span>,  <span class="hljs-number">14</span>,<span class="hljs-number">0</span>]<br>b=[<span class="hljs-number">103</span>, <span class="hljs-number">121</span>, <span class="hljs-number">123</span>, <span class="hljs-number">127</span>, <span class="hljs-number">117</span>,  <span class="hljs-number">43</span>,  <span class="hljs-number">60</span>,  <span class="hljs-number">82</span>,  <span class="hljs-number">83</span>, <span class="hljs-number">121</span>,<br>   <span class="hljs-number">87</span>,  <span class="hljs-number">94</span>,  <span class="hljs-number">93</span>,  <span class="hljs-number">66</span>, <span class="hljs-number">123</span>,  <span class="hljs-number">45</span>,  <span class="hljs-number">42</span>, <span class="hljs-number">102</span>,  <span class="hljs-number">66</span>, <span class="hljs-number">126</span>,<br>   <span class="hljs-number">76</span>,  <span class="hljs-number">87</span>, <span class="hljs-number">121</span>,  <span class="hljs-number">65</span>, <span class="hljs-number">107</span>, <span class="hljs-number">126</span>, <span class="hljs-number">101</span>,  <span class="hljs-number">60</span>,  <span class="hljs-number">92</span>,  <span class="hljs-number">69</span>,<br>  <span class="hljs-number">111</span>,  <span class="hljs-number">98</span>,  <span class="hljs-number">77</span>]<br><br>flag=[<span class="hljs-number">0</span>]*<span class="hljs-number">33</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    b[i]^=a[i]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(b)):<br>    flag[a[i]]=b[i]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(flag[i]),end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure>

<h2 id="WUSTCTF2020-level2"><a href="#WUSTCTF2020-level2" class="headerlink" title="[WUSTCTF2020]level2"></a>[WUSTCTF2020]level2</h2><p>1.upx的壳，用kail自带的脱壳</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">upx -d 文件名<br></code></pre></td></tr></table></figure>

<p><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170342634.png" srcset="/img/loading.gif" lazyload alt="image-20220802170342634"><br />2.用ida打开看main函数，发现直接有flag<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170403553.png" srcset="/img/loading.gif" lazyload alt="image-20220802170403553"></p>
<h2 id="ACTF新生赛2020-usualCrypt"><a href="#ACTF新生赛2020-usualCrypt" class="headerlink" title="[ACTF新生赛2020]usualCrypt"></a>[ACTF新生赛2020]usualCrypt</h2><p>1.ida看main函数的反汇编代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">int</span> __cdecl main(<span class="hljs-built_in">int</span> argc, const char **argv, const char **envp)<br>&#123;<br>  <span class="hljs-built_in">int</span> v3; // esi<br>  <span class="hljs-built_in">int</span> result; // eax<br>  <span class="hljs-built_in">int</span> v5; // [esp+8h] [ebp-74h]<br>  <span class="hljs-built_in">int</span> v6; // [esp+Ch] [ebp-70h]<br>  <span class="hljs-built_in">int</span> v7; // [esp+10h] [ebp-6Ch]<br>  __int16 v8; // [esp+14h] [ebp-68h]<br>  char v9; // [esp+16h] [ebp-66h]<br>  char v10; // [esp+18h] [ebp-64h]<br><br>  sub_403CF8(&amp;unk_40E140);<br>  scanf(aS, &amp;v10);<br>  v5 = <span class="hljs-number">0</span>;<br>  v6 = <span class="hljs-number">0</span>;<br>  v7 = <span class="hljs-number">0</span>;<br>  v8 = <span class="hljs-number">0</span>;<br>  v9 = <span class="hljs-number">0</span>;<br>  sub_401080(&amp;v10, strlen(&amp;v10), &amp;v5);<br>  v3 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">while</span> ( *(&amp;v5 + v3) == byte_40E0E4[v3] )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( ++v3 &gt; strlen(&amp;v5) )<br>      goto LABEL_6;<br>  &#125;<br>  sub_403CF8(aError);<br>LABEL_6:<br>  <span class="hljs-keyword">if</span> ( v3 - <span class="hljs-number">1</span> == strlen(byte_40E0E4) )<br>    result = sub_403CF8(aAreYouHappyYes);<br>  <span class="hljs-keyword">else</span><br>    result = sub_403CF8(aAreYouHappyNo);<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>2.然后我们看sub_401080，当时以为就纯纯base64，大意了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">int</span> __cdecl sub_401080(<span class="hljs-built_in">int</span> a1, <span class="hljs-built_in">int</span> a2, <span class="hljs-built_in">int</span> a3)<br>&#123;<br>  <span class="hljs-built_in">int</span> v3; // edi<br>  <span class="hljs-built_in">int</span> v4; // esi<br>  <span class="hljs-built_in">int</span> v5; // edx<br>  <span class="hljs-built_in">int</span> v6; // eax<br>  <span class="hljs-built_in">int</span> v7; // ecx<br>  <span class="hljs-built_in">int</span> v8; // esi<br>  <span class="hljs-built_in">int</span> v9; // esi<br>  <span class="hljs-built_in">int</span> v10; // esi<br>  <span class="hljs-built_in">int</span> v11; // esi<br>  _BYTE *v12; // ecx<br>  <span class="hljs-built_in">int</span> v13; // esi<br>  <span class="hljs-built_in">int</span> v15; // [esp+18h] [ebp+8h]<br><br>  v3 = <span class="hljs-number">0</span>;<br>  v4 = <span class="hljs-number">0</span>;<br>  sub_401000();<br>  v5 = a2 % <span class="hljs-number">3</span>;<br>  v6 = a1;<br>  v7 = a2 - a2 % <span class="hljs-number">3</span>;<br>  v15 = a2 % <span class="hljs-number">3</span>;<br>  <span class="hljs-keyword">if</span> ( v7 &gt; <span class="hljs-number">0</span> )<br>  &#123;<br>    do<br>    &#123;<br>      LOBYTE(v5) = *(_BYTE *)(a1 + v3);<br>      v3 += <span class="hljs-number">3</span>;<br>      v8 = v4 + <span class="hljs-number">1</span>;<br>      *(_BYTE *)(v8++ + a3 - <span class="hljs-number">1</span>) = byte_40E0A0[(v5 &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">0x3F</span>];<br>      *(_BYTE *)(v8++ + a3 - <span class="hljs-number">1</span>) = byte_40E0A0[<span class="hljs-number">16</span> * (*(_BYTE *)(a1 + v3 - <span class="hljs-number">3</span>) &amp; <span class="hljs-number">3</span>)<br>                                            + (((signed <span class="hljs-built_in">int</span>)*(unsigned __int8 *)(a1 + v3 - <span class="hljs-number">2</span>) &gt;&gt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0xF</span>)];<br>      *(_BYTE *)(v8 + a3 - <span class="hljs-number">1</span>) = byte_40E0A0[<span class="hljs-number">4</span> * (*(_BYTE *)(a1 + v3 - <span class="hljs-number">2</span>) &amp; <span class="hljs-number">0xF</span>)<br>                                          + (((signed <span class="hljs-built_in">int</span>)*(unsigned __int8 *)(a1 + v3 - <span class="hljs-number">1</span>) &gt;&gt; <span class="hljs-number">6</span>) &amp; <span class="hljs-number">3</span>)];<br>      v5 = *(_BYTE *)(a1 + v3 - <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0x3F</span>;<br>      v4 = v8 + <span class="hljs-number">1</span>;<br>      *(_BYTE *)(v4 + a3 - <span class="hljs-number">1</span>) = byte_40E0A0[v5];<br>    &#125;<br>    <span class="hljs-keyword">while</span> ( v3 &lt; v7 );<br>    v5 = v15;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">1</span> )<br>  &#123;<br>    LOBYTE(v7) = *(_BYTE *)(v3 + a1);<br>    v9 = v4 + <span class="hljs-number">1</span>;<br>    *(_BYTE *)(v9 + a3 - <span class="hljs-number">1</span>) = byte_40E0A0[(v7 &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">0x3F</span>];<br>    v10 = v9 + <span class="hljs-number">1</span>;<br>    *(_BYTE *)(v10 + a3 - <span class="hljs-number">1</span>) = byte_40E0A0[<span class="hljs-number">16</span> * (*(_BYTE *)(v3 + a1) &amp; <span class="hljs-number">3</span>)];<br>    *(_BYTE *)(v10 + a3) = <span class="hljs-number">61</span>;<br>LABEL_8:<br>    v13 = v10 + <span class="hljs-number">1</span>;<br>    *(_BYTE *)(v13 + a3) = <span class="hljs-number">61</span>;<br>    v4 = v13 + <span class="hljs-number">1</span>;<br>    goto LABEL_9;<br>  &#125;<br>  <span class="hljs-keyword">if</span> ( v5 == <span class="hljs-number">2</span> )<br>  &#123;<br>    v11 = v4 + <span class="hljs-number">1</span>;<br>    *(_BYTE *)(v11 + a3 - <span class="hljs-number">1</span>) = byte_40E0A0[((signed <span class="hljs-built_in">int</span>)*(unsigned __int8 *)(v3 + a1) &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">0x3F</span>];<br>    v12 = (_BYTE *)(v3 + a1 + <span class="hljs-number">1</span>);<br>    LOBYTE(v6) = *v12;<br>    v10 = v11 + <span class="hljs-number">1</span>;<br>    *(_BYTE *)(v10 + a3 - <span class="hljs-number">1</span>) = byte_40E0A0[<span class="hljs-number">16</span> * (*(_BYTE *)(v3 + a1) &amp; <span class="hljs-number">3</span>) + ((v6 &gt;&gt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0xF</span>)];<br>    *(_BYTE *)(v10 + a3) = byte_40E0A0[<span class="hljs-number">4</span> * (*v12 &amp; <span class="hljs-number">0xF</span>)];<br>    goto LABEL_8;<br>  &#125;<br>LABEL_9:<br>  *(_BYTE *)(v4 + a3) = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">return</span> sub_401030(a3);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>3.然后再点进sub_401000看一下，其中byte_40E0AA是base64编码表中的K<del>/<br />byte_40E0A0是A</del>J，这里函数起到的作用就是让GHIJKLMNOP与QRSTUVWXYZ交换位置</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python">signed <span class="hljs-built_in">int</span> sub_401000()<br>&#123;<br>  signed <span class="hljs-built_in">int</span> result; // eax<br>  char v1; // cl<br><br>  result = <span class="hljs-number">6</span>;<br>  do<br>  &#123;<br>    v1 = byte_40E0AA[result];<br>    byte_40E0AA[result] = byte_40E0A0[result];<br>    byte_40E0A0[result++] = v1;<br>  &#125;<br>  <span class="hljs-keyword">while</span> ( result &lt; <span class="hljs-number">15</span> );<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>4.返回上一级代码看最后一行函数sub_401030，很明显，小写换大写，大写换小写</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">int</span> __cdecl sub_401030(const char *a1)<br>&#123;<br>  __int64 v1; // rax<br>  char v2; // al<br><br>  v1 = 0i64;<br>  <span class="hljs-keyword">if</span> ( strlen(a1) != <span class="hljs-number">0</span> )<br>  &#123;<br>    do<br>    &#123;<br>      v2 = a1[HIDWORD(v1)];<br>      <span class="hljs-keyword">if</span> ( v2 &lt; <span class="hljs-number">97</span> || v2 &gt; <span class="hljs-number">122</span> )<br>      &#123;<br>        <span class="hljs-keyword">if</span> ( v2 &lt; <span class="hljs-number">65</span> || v2 &gt; <span class="hljs-number">90</span> )<br>          goto LABEL_9;<br>        LOBYTE(v1) = v2 + <span class="hljs-number">32</span>;<br>      &#125;<br>      <span class="hljs-keyword">else</span><br>      &#123;<br>        LOBYTE(v1) = v2 - <span class="hljs-number">32</span>;<br>      &#125;<br>      a1[HIDWORD(v1)] = v1;<br>LABEL_9:<br>      LODWORD(v1) = <span class="hljs-number">0</span>;<br>      ++HIDWORD(v1);<br>    &#125;<br>    <span class="hljs-keyword">while</span> ( HIDWORD(v1) &lt; strlen(a1) );<br>  &#125;<br>  <span class="hljs-keyword">return</span> v1;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>5.最后就是我们输入的flag经过base64【改】加密与byte_40E0E4</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">.data:0040E0E4 byte_40E0E4     db 7Ah                  ; DATA XREF: _main+5C↑r<br>.data:0040E0E4                                         ; _main:loc_401238↑o<br>.data:0040E0E5 aMxhz3tignxlxjh db <span class="hljs-string">&#x27;MXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9&#x27;</span>,<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<p>6.写脚本的时候就可以直接用byte_40E0E4进行base64【改】解码，我就直接抄大佬的base64c语言解码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#include&lt;stdio.h&gt;</span><br><span class="hljs-comment">#include&lt;string.h&gt;</span><br><span class="hljs-comment">#include&lt;stdlib.h&gt;</span><br><br>void jiemi(<span class="hljs-built_in">int</span> a,<span class="hljs-built_in">int</span> b,<span class="hljs-built_in">int</span> c,<span class="hljs-built_in">int</span> d);<br><br>char s[<span class="hljs-number">100</span>];<br><span class="hljs-built_in">int</span> i,j;<br><br>char a[]=<span class="hljs-string">&quot;abcdefqrstuvwxyzghijklmnopABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/&quot;</span>;<br><br><span class="hljs-built_in">int</span> main()<br>&#123;<br>	<span class="hljs-built_in">int</span> <span class="hljs-built_in">len</span>,len1;<br>	<span class="hljs-built_in">int</span> str1[<span class="hljs-number">100</span>];<br>	char <span class="hljs-built_in">str</span>[<span class="hljs-number">100</span>];<br><br>	printf(<span class="hljs-string">&quot;base64需要解密的字符串:&quot;</span>);<br>	gets(<span class="hljs-built_in">str</span>);<br>	<span class="hljs-built_in">len</span>=strlen(<span class="hljs-built_in">str</span>);<br><br><br>	<span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-built_in">len</span>;i++)<br>	&#123;<br>		<span class="hljs-keyword">for</span>(j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">64</span>;j++)<br>		&#123;<br>			<span class="hljs-keyword">if</span>(<span class="hljs-built_in">str</span>[i]==a[j])<br>			&#123;<br>				str1[i]=j;<br>				len1=i+<span class="hljs-number">1</span>;<br>			&#125;<br>		&#125;<br>	&#125;<br><br><br><br><br><br>	<span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>,j=<span class="hljs-number">0</span>;i&lt;=len1-<span class="hljs-number">4</span>;i+=<span class="hljs-number">4</span>,j+=<span class="hljs-number">3</span>)<br>	&#123;<br>		jiemi(str1[i],str1[i+<span class="hljs-number">1</span>],str1[i+<span class="hljs-number">2</span>],str1[i+<span class="hljs-number">3</span>]);<br>	&#125;<br><br>	<span class="hljs-keyword">if</span>(len1%<span class="hljs-number">4</span>==<span class="hljs-number">2</span>)<br>	&#123;<br>		s[j]=str1[i]&lt;&lt;<span class="hljs-number">2</span>|str1[i+<span class="hljs-number">1</span>]&gt;&gt;<span class="hljs-number">4</span>;<br>	&#125;<br>	<span class="hljs-keyword">if</span>(len1%<span class="hljs-number">4</span>==<span class="hljs-number">3</span>)<br>	&#123;<br>		s[j]=str1[i]&lt;&lt;<span class="hljs-number">2</span>|str1[i+<span class="hljs-number">1</span>]&gt;&gt;<span class="hljs-number">4</span>;<br>		s[j+<span class="hljs-number">1</span>]=str1[i+<span class="hljs-number">1</span>]&lt;&lt;<span class="hljs-number">4</span>|str1[i+<span class="hljs-number">2</span>]&gt;&gt;<span class="hljs-number">2</span>;<br>	&#125;<br><br>	printf(<span class="hljs-string">&quot;\n解密之后:&quot;</span>);<br>	puts(s);<br>	putchar(<span class="hljs-string">&#x27;\n&#x27;</span>);<br>	system(<span class="hljs-string">&quot;pause&quot;</span>);<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br>void jiemi(<span class="hljs-built_in">int</span> a,<span class="hljs-built_in">int</span> b,<span class="hljs-built_in">int</span> c,<span class="hljs-built_in">int</span> d)<br>&#123;<br>	s[j]=a&lt;&lt;<span class="hljs-number">2</span>|b&gt;&gt;<span class="hljs-number">4</span>;<br>	s[j+<span class="hljs-number">1</span>]=b&lt;&lt;<span class="hljs-number">4</span>|c&gt;&gt;<span class="hljs-number">2</span>;<br>	s[j+<span class="hljs-number">2</span>]=c&lt;&lt;<span class="hljs-number">6</span>|d;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>7.运行结果<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170446261.png" srcset="/img/loading.gif" lazyload alt="image-20220802170446261"></p>
<h2 id="Youngter-drive"><a href="#Youngter-drive" class="headerlink" title="Youngter-drive"></a>Youngter-drive</h2><p>文件需要先脱壳，同样都是UPX的壳，老办法就可以了<br />1.首先ida打开看main函数反汇编</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> __thiscall <span class="hljs-title">main_0</span><span class="hljs-params">(<span class="hljs-keyword">void</span> *<span class="hljs-keyword">this</span>)</span></span><br><span class="hljs-function"></span>&#123;<br>  HANDLE v2; <span class="hljs-comment">// [esp+D0h] [ebp-14h]</span><br>  HANDLE hObject; <span class="hljs-comment">// [esp+DCh] [ebp-8h]</span><br><br>  sub_4110FF(<span class="hljs-keyword">this</span>);<br>  ::hObject = CreateMutexW(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>  j_strcpy(Dest, &amp;Source);<br>  hObject = CreateThread(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, (LPTHREAD_START_ROUTINE)StartAddress, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>  v2 = CreateThread(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, sub_41119F, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>  CloseHandle(hObject);<br>  CloseHandle(v2);<br>  <span class="hljs-keyword">while</span> ( dword_418008 != <span class="hljs-number">-1</span> )<br>    ;<br>  sub_411190();<br>  CloseHandle(::hObject);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这里有个新知识点CreateThread()创建线程，这里调用了两次，调用A再调用B，调用B完了之后再调用A，交替执行，顺序这方面不确定<br />2.先看StartAddress里面的</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> __stdcall <span class="hljs-title">StartAddress_0</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a1)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    WaitForSingleObject(hObject, <span class="hljs-number">0xFFFFFFFF</span>);<br>    <span class="hljs-keyword">if</span> ( dword_418008 &gt; <span class="hljs-number">-1</span> )<br>    &#123;<br>      sub_41112C((<span class="hljs-keyword">int</span>)&amp;Source, dword_418008);<br>      --dword_418008;<br>      Sleep(<span class="hljs-number">0x64</span>u);<br>    &#125;<br>    ReleaseMutex(hObject);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>点进这个sub_41112C看一下<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170526409.png" srcset="/img/loading.gif" lazyload alt="image-20220802170526409"><br />这个是堆栈不平衡，解决办法就是找到这个函数，光标放到pop ebp，然后Alt+K把0x4改成0<img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170541719.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />改好之后直接F5就可以看到反汇编代码了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">char</span> *__cdecl <span class="hljs-title">sub_411940</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a1, <span class="hljs-keyword">int</span> a2)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">char</span> *result; <span class="hljs-comment">// eax</span><br>  <span class="hljs-keyword">char</span> v3; <span class="hljs-comment">// [esp+D3h] [ebp-5h]</span><br><br>  v3 = *(_BYTE *)(a2 + a1);<br>  <span class="hljs-keyword">if</span> ( (v3 &lt; <span class="hljs-number">97</span> || v3 &gt; <span class="hljs-number">122</span>) &amp;&amp; (v3 &lt; <span class="hljs-number">65</span> || v3 &gt; <span class="hljs-number">90</span>) )<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">if</span> ( v3 &lt; <span class="hljs-number">97</span> || v3 &gt; <span class="hljs-number">122</span> )<br>  &#123;<br>    result = off_418000[<span class="hljs-number">0</span>];<br>    *(_BYTE *)(a2 + a1) = off_418000[<span class="hljs-number">0</span>][*(<span class="hljs-keyword">char</span> *)(a2 + a1) - <span class="hljs-number">38</span>];<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    result = off_418000[<span class="hljs-number">0</span>];<br>    *(_BYTE *)(a2 + a1) = off_418000[<span class="hljs-number">0</span>][*(<span class="hljs-keyword">char</span> *)(a2 + a1) - <span class="hljs-number">96</span>];<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>也就是说这个就是将(a1+a2)数组中的大写字母-38，小写字母-96，其对应的十进制是off_418000中对应字符串的位置，然后将这个字符赋给a1+a2<br />简单来说，就是将原来字符串的字母替换为 off_418000中的字符，大写的字符转成 off_418000中的小写，小写的字符转成 off_418000中的大写字符<br />3.接着我们看另一个线程的，也就是sub_41119F</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> __stdcall <span class="hljs-title">sub_411B10</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a1)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    WaitForSingleObject(hObject, <span class="hljs-number">0xFFFFFFFF</span>);<br>    <span class="hljs-keyword">if</span> ( dword_418008 &gt; <span class="hljs-number">-1</span> )<br>    &#123;<br>      Sleep(<span class="hljs-number">0x64</span>u);<br>      --dword_418008;<br>    &#125;<br>    ReleaseMutex(hObject);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p> 对<strong>dword_418008</strong>变量进行减1操作<br />4.最后再看sub_411190，也就是加密过后的Source[i]与off_418004[i]进行比较</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">sub_411880</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [esp+D0h] [ebp-8h]</span><br><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">29</span>; ++i )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( Source[i] != off_418004[i] )<br>      <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\nflag&#123;%s&#125;\n\n&quot;</span>, Dest);<br>&#125;<br></code></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">.data:<span class="hljs-number">00418004</span> off_418004      dd offset aToiziztoryatou<br>.data:<span class="hljs-number">00418004</span>                                         ; DATA XREF: sub_411880+<span class="hljs-number">40</span>↑r<br>.data:<span class="hljs-number">00418004</span>                                         ; <span class="hljs-string">&quot;TOiZiZtOrYaToUwPnToBsOaOapsyS&quot;</span><br></code></pre></td></tr></table></figure>

<p>5.由于这两个线程是交替执行的，而且咱们也不知道谁先执行谁后执行<br />写脚本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c">a=<span class="hljs-string">&#x27;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&#x27;</span><br><br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-string">result=&quot;TOiZiZtOrYaToUwPnToBsOaOapsyS&quot;</span><br><span class="hljs-string">for i in range(len(result)):</span><br><span class="hljs-string">    if i%2==0:            #这个是判断谁先执行后执行的，不等于0则是第一个线程先执行</span><br><span class="hljs-string">        flag+=result[i]</span><br><span class="hljs-string">        continue</span><br><span class="hljs-string">    if (result[i].isupper()):</span><br><span class="hljs-string">        flag+=chr(a.find(result[i])+96)</span><br><span class="hljs-string">    else:</span><br><span class="hljs-string">        flag+=chr(a.find(result[i])+38)</span><br><span class="hljs-string">print(flag)</span><br><span class="hljs-string">print(len(flag))</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure>

<p><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170617438.png" srcset="/img/loading.gif" lazyload alt="image-20220802170617438"><br />字符串长度是29，而dword_418008是0x1D，从1D~0总共是30，字符串长度应该是30，最后一个字符不知道是哪个字母，就随便试，试出来是E</p>
<h2 id="HDCTF2019-Maze"><a href="#HDCTF2019-Maze" class="headerlink" title="[HDCTF2019]Maze"></a>[HDCTF2019]Maze</h2><p>1.文件有UPX壳，kali或者其他脱壳软件应该都可以，这里不再过多赘述了<br />然后用ida32位打开，看着是main函数，然后按F5没反应<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170642211.png" srcset="/img/loading.gif" lazyload alt="image-20220802170642211"></p>
<p>这个jnz要跳到call这里，然而这个call的也不是个正确的地址，这个jnz为花指令，直接nop<br />怎么nop呢?<br />首先光标在jnz那里，找到图下这个单字节修改(ida不汉化应该也是这个位置)，<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170707159.png" srcset="/img/loading.gif" lazyload alt="image-20220802170707159"><br />然后75 01都改成90，0x90也就相当于nop<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170725904.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />改好之后再来看这个call，先按D转成数据<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170742997.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />这个0xE8也相当于call的操作码，就把它nop了（实际上是把这每一个数据先nop一个，反汇编还是不行就把下一行也nop），把E8改成90即可<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171422006.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />改好之后按c再转为代码<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170809245.png" srcset="/img/loading.gif" lazyload alt="image-20220802170827617"><br />然后直接在像这种红色片段的找到第一个红色部分，按P相当于创建函数<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170845124.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />这个时候就直接F5，(这个花指令离不开学长的教诲，由于本人脑袋迟钝，学长费了好大功夫才让我明白怎么做)<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170845124.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />看到这个代码就好分析了，这个asc_408078初值为7，dword_40807C初值为0，然后通过输入wsad相关指令进行14次位移，最后满足asc_408078为5，dword_40807C为-4<br />最后找这个迷宫，大佬wp说在内存中找，那就shift+F12找字符串，这个很明显<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170904248.png" srcset="/img/loading.gif" lazyload alt="image-20220802170925527"><br />点进去然后选中这一串然后shift+E，如图所示，这个迷宫可以直接走<br />我们看到0x2B也就是迷宫入口坐标是(7,0),也就是说出口点是(5,-4)<br />也就是说wsad对应的操作就是上下左右(不反4399设计，很好)<br />正好走14步<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802170925527.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />flag也就是ssaaasaassdddw<br />😔，废物两天才写了这么一道题</p>
<h2 id="相册"><a href="#相册" class="headerlink" title="相册"></a>相册</h2><p>一道安卓逆向<br />先用jadx-gui打开<br />看这道题的描述<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171004560.png" srcset="/img/loading.gif" lazyload alt="image-20220802171004560"><br />找邮箱就可以了，那我们先搜mail<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171455619.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />我们点进第一个看一下，从mailto这个可以理解为就是发给某个邮箱，而且看这个方法里面还给提示字符串successsfully，failed判定输入的对不对<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171535731.png" srcset="/img/loading.gif" lazyload alt="image-20220802171535731"><br />那我们再来搜一下这个方法，看谁调用了它<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171557822.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />点进第二个看一下<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171632393.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />我们要找到这个mailto，再搜一下这个MAILSERVER<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171650853.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />点进第一个看一下，base64解密后调用的<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171707738.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />再搜一下<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171742989.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />点进最后这个看一下<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171801334.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />这个时候我们就要知道这个native什么意思<br />可以参考一下这两篇博客：<br /><a target="_blank" rel="noopener" href="https://www.cnblogs.com/douyamv/p/6528936.html">https://www.cnblogs.com/douyamv/p/6528936.html</a><br /><a target="_blank" rel="noopener" href="https://blog.csdn.net/z1002137615/article/details/50943869">https://blog.csdn.net/z1002137615/article/details/50943869</a><br />这个native方法实现不是在当前文件，而是在用其他语言（如C和C++）实现的文件中，这个文件就常常是 loadLibrary导入存在源文件目录下的.dll/.so文件  <br />由于我才疏学浅，不知道这个文件用jadx怎么打开<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171821364.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />所以就换APK改之理打开的<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171839950.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />打开文件夹就可以看到了<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171855179.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />刚刚说了，这种文件一般是c/c++编写的，所以我们用IDA打开<br />直接搜字符串<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171917970.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />咱们点进去就直接复制用base64解码就可以了，第二个字符串出现的邮箱就是咱们需要的了<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802171935375.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />flag{<a href="mailto:&#49;&#x38;&#50;&#x31;&#56;&#x34;&#54;&#53;&#49;&#x32;&#x35;&#x40;&#x31;&#x36;&#x33;&#46;&#x63;&#111;&#x6d;">&#49;&#x38;&#50;&#x31;&#56;&#x34;&#54;&#53;&#49;&#x32;&#x35;&#x40;&#x31;&#x36;&#x33;&#46;&#x63;&#111;&#x6d;</a>}</p>
<h2 id="FlareOn3-Challenge1"><a href="#FlareOn3-Challenge1" class="headerlink" title="[FlareOn3]Challenge1"></a>[FlareOn3]Challenge1</h2><p> 用IDA打开文件，找到main函数直接F5</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">char</span> Buffer[<span class="hljs-number">128</span>]; <span class="hljs-comment">// [esp+0h] [ebp-94h] BYREF</span><br>  <span class="hljs-keyword">char</span> *Str1; <span class="hljs-comment">// [esp+80h] [ebp-14h]</span><br>  <span class="hljs-keyword">char</span> *Str2; <span class="hljs-comment">// [esp+84h] [ebp-10h]</span><br>  HANDLE StdHandle; <span class="hljs-comment">// [esp+88h] [ebp-Ch]</span><br>  HANDLE hFile; <span class="hljs-comment">// [esp+8Ch] [ebp-8h]</span><br>  DWORD NumberOfBytesWritten; <span class="hljs-comment">// [esp+90h] [ebp-4h] BYREF</span><br><br>  hFile = GetStdHandle(<span class="hljs-number">0xFFFFFFF5</span>);<br>  StdHandle = GetStdHandle(<span class="hljs-number">0xFFFFFFF6</span>);<br>  Str2 = <span class="hljs-string">&quot;x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q&quot;</span>;<br>  WriteFile(hFile, <span class="hljs-string">&quot;Enter password:\r\n&quot;</span>, <span class="hljs-number">0x12</span>u, &amp;NumberOfBytesWritten, <span class="hljs-number">0</span>);<br>  ReadFile(StdHandle, Buffer, <span class="hljs-number">0x80</span>u, &amp;NumberOfBytesWritten, <span class="hljs-number">0</span>);<br>  Str1 = (<span class="hljs-keyword">char</span> *)sub_401260(Buffer, NumberOfBytesWritten - <span class="hljs-number">2</span>);<br>  <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strcmp</span>(Str1, Str2) )<br>    WriteFile(hFile, <span class="hljs-string">&quot;Correct!\r\n&quot;</span>, <span class="hljs-number">0xB</span>u, &amp;NumberOfBytesWritten, <span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">else</span><br>    WriteFile(hFile, <span class="hljs-string">&quot;Wrong password\r\n&quot;</span>, <span class="hljs-number">0x11</span>u, &amp;NumberOfBytesWritten, <span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>虽然看着复杂，但是其实就一base64换表加密，点进sub_401260看一下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function">_BYTE *__cdecl <span class="hljs-title">sub_401260</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a1, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> a2)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">int</span> v3; <span class="hljs-comment">// [esp+Ch] [ebp-24h]</span><br>  <span class="hljs-keyword">int</span> v4; <span class="hljs-comment">// [esp+10h] [ebp-20h]</span><br>  <span class="hljs-keyword">int</span> v5; <span class="hljs-comment">// [esp+14h] [ebp-1Ch]</span><br>  <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [esp+1Ch] [ebp-14h]</span><br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v7; <span class="hljs-comment">// [esp+20h] [ebp-10h]</span><br>  _BYTE *v8; <span class="hljs-comment">// [esp+24h] [ebp-Ch]</span><br>  <span class="hljs-keyword">int</span> v9; <span class="hljs-comment">// [esp+28h] [ebp-8h]</span><br>  <span class="hljs-keyword">int</span> v10; <span class="hljs-comment">// [esp+28h] [ebp-8h]</span><br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v11; <span class="hljs-comment">// [esp+2Ch] [ebp-4h]</span><br><br>  v8 = <span class="hljs-built_in">malloc</span>(<span class="hljs-number">4</span> * ((a2 + <span class="hljs-number">2</span>) / <span class="hljs-number">3</span>) + <span class="hljs-number">1</span>);<br>  <span class="hljs-keyword">if</span> ( !v8 )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  v11 = <span class="hljs-number">0</span>;<br>  v9 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">while</span> ( v11 &lt; a2 )<br>  &#123;<br>    v5 = *(<span class="hljs-keyword">unsigned</span> __int8 *)(v11 + a1);<br>    <span class="hljs-keyword">if</span> ( ++v11 &gt;= a2 )<br>    &#123;<br>      v4 = <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      v4 = *(<span class="hljs-keyword">unsigned</span> __int8 *)(v11 + a1);<br>      ++v11;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( v11 &gt;= a2 )<br>    &#123;<br>      v3 = <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>      v3 = *(<span class="hljs-keyword">unsigned</span> __int8 *)(v11 + a1);<br>      ++v11;<br>    &#125;<br>    v7 = v3 + (v5 &lt;&lt; <span class="hljs-number">16</span>) + (v4 &lt;&lt; <span class="hljs-number">8</span>);<br>    v8[v9] = byte_413000[(v7 &gt;&gt; <span class="hljs-number">18</span>) &amp; <span class="hljs-number">0x3F</span>];<br>    v10 = v9 + <span class="hljs-number">1</span>;<br>    v8[v10] = byte_413000[(v7 &gt;&gt; <span class="hljs-number">12</span>) &amp; <span class="hljs-number">0x3F</span>];<br>    v8[++v10] = byte_413000[(v7 &gt;&gt; <span class="hljs-number">6</span>) &amp; <span class="hljs-number">0x3F</span>];<br>    v8[++v10] = byte_413000[v3 &amp; <span class="hljs-number">0x3F</span>];<br>    v9 = v10 + <span class="hljs-number">1</span>;<br>  &#125;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; dword_413040[a2 % <span class="hljs-number">3</span>]; ++i )<br>    v8[<span class="hljs-number">4</span> * ((a2 + <span class="hljs-number">2</span>) / <span class="hljs-number">3</span>) - i - <span class="hljs-number">1</span>] = <span class="hljs-number">61</span>;<br>  v8[<span class="hljs-number">4</span> * ((a2 + <span class="hljs-number">2</span>) / <span class="hljs-number">3</span>)] = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">return</span> v8;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>看一下这个编码表byte_413000</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs c">.data:<span class="hljs-number">00413000</span> ; <span class="hljs-keyword">char</span> byte_413000[<span class="hljs-number">64</span>]<br>.data:<span class="hljs-number">00413000</span> byte_413000     db <span class="hljs-number">5</span>Ah                  ; DATA XREF: sub_401260+FC↑r<br>.data:<span class="hljs-number">00413000</span>                                         ; sub_401260+<span class="hljs-number">11</span>C↑r ...<br>.data:<span class="hljs-number">00413001</span>                 db  <span class="hljs-number">59</span>h ; Y<br>.data:<span class="hljs-number">00413002</span>                 db  <span class="hljs-number">58</span>h ; X<br>.data:<span class="hljs-number">00413003</span>                 db  <span class="hljs-number">41</span>h ; A<br>.data:<span class="hljs-number">00413004</span>                 db  <span class="hljs-number">42</span>h ; B<br>.data:<span class="hljs-number">00413005</span>                 db  <span class="hljs-number">43</span>h ; C<br>.data:<span class="hljs-number">00413006</span>                 db  <span class="hljs-number">44</span>h ; D<br>.data:<span class="hljs-number">00413007</span>                 db  <span class="hljs-number">45</span>h ; E<br>.data:<span class="hljs-number">00413008</span>                 db  <span class="hljs-number">46</span>h ; F<br>.data:<span class="hljs-number">00413009</span>                 db  <span class="hljs-number">47</span>h ; G<br>.data:<span class="hljs-number">0041300</span>A                 db  <span class="hljs-number">48</span>h ; H<br>.data:<span class="hljs-number">0041300B</span>                 db  <span class="hljs-number">49</span>h ; I<br>.data:<span class="hljs-number">0041300</span>C                 db  <span class="hljs-number">4</span>Ah ; J<br>.data:<span class="hljs-number">0041300</span>D                 db  <span class="hljs-number">4B</span>h ; K<br>.data:<span class="hljs-number">0041300</span>E                 db  <span class="hljs-number">4</span>Ch ; L<br>.data:<span class="hljs-number">0041300F</span>                 db  <span class="hljs-number">4</span>Dh ; M<br>.data:<span class="hljs-number">00413010</span>                 db  <span class="hljs-number">4</span>Eh ; N<br>.data:<span class="hljs-number">00413011</span>                 db  <span class="hljs-number">4F</span>h ; O<br>.data:<span class="hljs-number">00413012</span>                 db  <span class="hljs-number">50</span>h ; P<br>.data:<span class="hljs-number">00413013</span>                 db  <span class="hljs-number">51</span>h ; Q<br>.data:<span class="hljs-number">00413014</span>                 db  <span class="hljs-number">52</span>h ; R<br>.data:<span class="hljs-number">00413015</span>                 db  <span class="hljs-number">53</span>h ; S<br>.data:<span class="hljs-number">00413016</span>                 db  <span class="hljs-number">54</span>h ; T<br>.data:<span class="hljs-number">00413017</span>                 db  <span class="hljs-number">55</span>h ; U<br>.data:<span class="hljs-number">00413018</span>                 db  <span class="hljs-number">56</span>h ; V<br>.data:<span class="hljs-number">00413019</span>                 db  <span class="hljs-number">57</span>h ; W<br>.data:<span class="hljs-number">0041301</span>A                 db  <span class="hljs-number">7</span>Ah ; z<br>.data:<span class="hljs-number">0041301B</span>                 db  <span class="hljs-number">79</span>h ; y<br>.data:<span class="hljs-number">0041301</span>C                 db  <span class="hljs-number">78</span>h ; x<br>.data:<span class="hljs-number">0041301</span>D                 db  <span class="hljs-number">61</span>h ; a<br>.data:<span class="hljs-number">0041301</span>E                 db  <span class="hljs-number">62</span>h ; b<br>.data:<span class="hljs-number">0041301F</span>                 db  <span class="hljs-number">63</span>h ; c<br>.data:<span class="hljs-number">00413020</span>                 db  <span class="hljs-number">64</span>h ; d<br>.data:<span class="hljs-number">00413021</span>                 db  <span class="hljs-number">65</span>h ; e<br>.data:<span class="hljs-number">00413022</span>                 db  <span class="hljs-number">66</span>h ; f<br>.data:<span class="hljs-number">00413023</span>                 db  <span class="hljs-number">67</span>h ; g<br>.data:<span class="hljs-number">00413024</span>                 db  <span class="hljs-number">68</span>h ; h<br>.data:<span class="hljs-number">00413025</span>                 db  <span class="hljs-number">69</span>h ; i<br>.data:<span class="hljs-number">00413026</span>                 db  <span class="hljs-number">6</span>Ah ; j<br>.data:<span class="hljs-number">00413027</span>                 db  <span class="hljs-number">6B</span>h ; k<br>.data:<span class="hljs-number">00413028</span>                 db  <span class="hljs-number">6</span>Ch ; l<br>.data:<span class="hljs-number">00413029</span>                 db  <span class="hljs-number">6</span>Dh ; m<br>.data:<span class="hljs-number">0041302</span>A                 db  <span class="hljs-number">6</span>Eh ; n<br>.data:<span class="hljs-number">0041302B</span>                 db  <span class="hljs-number">6F</span>h ; o<br>.data:<span class="hljs-number">0041302</span>C                 db  <span class="hljs-number">70</span>h ; p<br>.data:<span class="hljs-number">0041302</span>D                 db  <span class="hljs-number">71</span>h ; q<br>.data:<span class="hljs-number">0041302</span>E                 db  <span class="hljs-number">72</span>h ; r<br>.data:<span class="hljs-number">0041302F</span>                 db  <span class="hljs-number">73</span>h ; s<br>.data:<span class="hljs-number">00413030</span>                 db  <span class="hljs-number">74</span>h ; t<br>.data:<span class="hljs-number">00413031</span>                 db  <span class="hljs-number">75</span>h ; u<br>.data:<span class="hljs-number">00413032</span>                 db  <span class="hljs-number">76</span>h ; v<br>.data:<span class="hljs-number">00413033</span>                 db  <span class="hljs-number">77</span>h ; w<br>.data:<span class="hljs-number">00413034</span>                 db  <span class="hljs-number">30</span>h ; <span class="hljs-number">0</span><br>.data:<span class="hljs-number">00413035</span>                 db  <span class="hljs-number">31</span>h ; <span class="hljs-number">1</span><br>.data:<span class="hljs-number">00413036</span>                 db  <span class="hljs-number">32</span>h ; <span class="hljs-number">2</span><br>.data:<span class="hljs-number">00413037</span>                 db  <span class="hljs-number">33</span>h ; <span class="hljs-number">3</span><br>.data:<span class="hljs-number">00413038</span>                 db  <span class="hljs-number">34</span>h ; <span class="hljs-number">4</span><br>.data:<span class="hljs-number">00413039</span>                 db  <span class="hljs-number">35</span>h ; <span class="hljs-number">5</span><br>.data:<span class="hljs-number">0041303</span>A                 db  <span class="hljs-number">36</span>h ; <span class="hljs-number">6</span><br>.data:<span class="hljs-number">0041303B</span>                 db  <span class="hljs-number">37</span>h ; <span class="hljs-number">7</span><br>.data:<span class="hljs-number">0041303</span>C                 db  <span class="hljs-number">38</span>h ; <span class="hljs-number">8</span><br>.data:<span class="hljs-number">0041303</span>D                 db  <span class="hljs-number">39</span>h ; <span class="hljs-number">9</span><br>.data:<span class="hljs-number">0041303</span>E                 db  <span class="hljs-number">2B</span>h ; +<br>.data:<span class="hljs-number">0041303F</span>                 db  <span class="hljs-number">2F</span>h ; /<br></code></pre></td></tr></table></figure>

<p>最后要说明的一点是，这里的-2不用管，无视即可</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">Str1 = (<span class="hljs-keyword">char</span> *)sub_401260(Buffer, NumberOfBytesWritten - <span class="hljs-number">2</span>);<br></code></pre></td></tr></table></figure>

<p>结果（不得不说这个网站真好用<a target="_blank" rel="noopener" href="https://icyberchef.com/">https://icyberchef.com/</a>，之前做的跟这一样换表加密题，我还苦苦搜base64解码脚本，然后把脚本里面的编码表又换了再解，太狼狈辣）<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172003781.png" srcset="/img/loading.gif" lazyload alt="image-20220802172003781"></p>
<h2 id="WUSTCTF2020-level3"><a href="#WUSTCTF2020-level3" class="headerlink" title="[WUSTCTF2020]level3"></a>[WUSTCTF2020]level3</h2><p>这道题可真的太坏辣，毕竟没做过这么样的<br />首先ida打开，main函数反汇编</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *v3; <span class="hljs-comment">// rax</span><br>  <span class="hljs-keyword">char</span> v5; <span class="hljs-comment">// [rsp+Fh] [rbp-41h]</span><br>  <span class="hljs-keyword">char</span> v6[<span class="hljs-number">56</span>]; <span class="hljs-comment">// [rsp+10h] [rbp-40h] BYREF</span><br>  <span class="hljs-keyword">unsigned</span> __int64 v7; <span class="hljs-comment">// [rsp+48h] [rbp-8h]</span><br><br>  v7 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Try my base64 program?.....\n&gt;&quot;</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%20s&quot;</span>, v6);<br>  v5 = time(<span class="hljs-number">0LL</span>);<br>  srand(v5);<br>  <span class="hljs-keyword">if</span> ( (rand() &amp; <span class="hljs-number">1</span>) != <span class="hljs-number">0</span> )<br>  &#123;<br>    v3 = (<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *)base64_encode(v6);<br>    <span class="hljs-built_in">puts</span>(v3);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Is there something wrong?&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Sorry I think it&#x27;s not prepared yet....&quot;</span>);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;And I get a strange string from my program which is different from the standard base64:&quot;</span>);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD==&quot;</span>);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;What&#x27;s wrong??&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这道题看着就一纯纯base64解码题，但其实把这个字符串base64解密过后不对，里面也没说base64换表，但其实确实是这样的<br />点进看一下确实妹说换表<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172029608.png" srcset="/img/loading.gif" lazyload alt="image-20220802172029608"><br />点进base64_table，正常表<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172052006.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />但当我们选中base64_table，Ctrl+X看一下谁还调用了，好家伙<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172123497.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />点进这个LookAtYou看一下，F5反汇编</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function">__int64 <span class="hljs-title">O_OLookAtYou</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>  __int64 result; <span class="hljs-comment">// rax</span><br>  <span class="hljs-keyword">char</span> v1; <span class="hljs-comment">// [rsp+1h] [rbp-5h]</span><br>  <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [rsp+2h] [rbp-4h]</span><br><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">9</span>; ++i )<br>  &#123;<br>    v1 = base64_table[i];<br>    base64_table[i] = base64_table[<span class="hljs-number">19</span> - i];<br>    result = <span class="hljs-number">19</span> - i;<br>    base64_table[result] = v1;<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>果然它搞的鬼，把表中前十个跟后十个换了一下，还是颠倒顺序换的<br />写脚本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">import</span> base64<br>flag=<span class="hljs-built_in">list</span>(<span class="hljs-string">&quot;d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD==&quot;</span>)<br>realflag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i in range(<span class="hljs-number">0</span>,len(flag)):<br>    <span class="hljs-keyword">if</span> ord(flag[i])&gt;<span class="hljs-number">64</span> <span class="hljs-keyword">and</span> ord(flag[i])&lt;<span class="hljs-number">85</span>:<br>            realflag+=chr(<span class="hljs-number">75</span>*<span class="hljs-number">2</span>-ord(flag[i])<span class="hljs-number">-1</span>)<br>    <span class="hljs-keyword">else</span>:<br>        realflag+=flag[i]<br>print(base64.b64decode(realflag))<br></code></pre></td></tr></table></figure>

<p>运行<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172143392.png" srcset="/img/loading.gif" lazyload alt="image-20220802172143392"></p>
<h2 id="PE"><a href="#PE" class="headerlink" title="PE"></a>PE</h2><p>这道题是学长给我们出的题，buu貌似没有<br />下载:<a target="_blank" rel="noopener" href="https://wwu.lanzouw.com/iX0Z6089p3sj%E5%AF%86%E7%A0%81:0000">https://wwu.lanzouw.com/iX0Z6089p3sj密码:0000</a><br />这个文件ida打开没有东西，也不是UPX壳<br />需要用010Editor打开<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172205313.png" srcset="/img/loading.gif" lazyload alt="image-20220802172205313"><br />然后需要将E0改成F0，原因可以看这篇博客<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_46125480/article/details/120935748?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165855205516782391874712%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=165855205516782391874712&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-1-120935748-null-null.142%5Ev33%5Epc_rank_34,185%5Ev2%5Econtrol&utm_term=PE%E6%96%87%E4%BB%B6e_lfanew%E6%80%8E%E4%B9%88%E7%9C%8B&spm=1018.2226.3001.4187">链接</a><br />就是E0指向NT文件头这个NT文件头也就是PE可以在图中看到是在F0区域，所以我们需要把E0改成F0<br />改好之后就可以用ida打开了搜main函数看其反汇编</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main_0</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">int</span> v4; <span class="hljs-comment">// eax</span><br>  <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [esp+DCh] [ebp-3Ch]</span><br>  <span class="hljs-keyword">char</span> Str[<span class="hljs-number">36</span>]; <span class="hljs-comment">// [esp+E8h] [ebp-30h] BYREF</span><br>  <span class="hljs-keyword">int</span> v7; <span class="hljs-comment">// [esp+10Ch] [ebp-Ch]</span><br><br>  __CheckForDebuggerJustMyCode(&amp;unk_42402D);<br>  v7 = <span class="hljs-number">0</span>;<br>  sub_4110DC(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cin</span>, Str);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; Str[i]; ++i )<br>    ;<br>  <span class="hljs-keyword">if</span> ( i != <span class="hljs-number">24</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>  v7 = sub_411339(Str);<br>  <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">unsigned</span> __int8)sub_4114B0(v7) )<br>    v4 = sub_41124E(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span>, <span class="hljs-string">&quot;you did it&quot;</span>);<br>  <span class="hljs-keyword">else</span><br>    v4 = sub_41124E(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span>, <span class="hljs-string">&quot;what a pity&quot;</span>);<br>  <span class="hljs-built_in">std</span>::ostream::<span class="hljs-keyword">operator</span>&lt;&lt;(v4, &amp;sub_411050);<br>  system(<span class="hljs-string">&quot;Pause&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>主要看这些，str是我们输入的，然后经过sub_411339加密得到v7，然后再让sub_4114B0(v7)返回1就可以了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs c">v7 = sub_411339(Str);<br><span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">unsigned</span> __int8)sub_4114B0(v7) )<br>    v4 = sub_41124E(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span>, <span class="hljs-string">&quot;you did it&quot;</span>);<br></code></pre></td></tr></table></figure>

<p>首先我们先看sub_411339<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172249514.png" srcset="/img/loading.gif" lazyload alt="image-20220802172249514"><br />很明显是类似base64加密，然而我们再看一下这个编码表</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs c">aAlwhs3cnyju5ep db <span class="hljs-string">&#x27;ALWhs3CNYju5EPalw7GRcny9ITep0/KVgr2BMXit4DOZkv6FQbmx8HSdoz+JUfq1&#x27;</span>,<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<p>换表了，然后我们再看sub_4114B0</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">char</span> __cdecl <span class="hljs-title">sub_4162B0</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a1)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [esp+D0h] [ebp-38h]</span><br>  <span class="hljs-keyword">char</span> v3[<span class="hljs-number">40</span>]; <span class="hljs-comment">// [esp+DCh] [ebp-2Ch] BYREF</span><br><br>  __CheckForDebuggerJustMyCode(&amp;unk_42402D);<br>  <span class="hljs-built_in">strcpy</span>(v3, <span class="hljs-string">&quot;TibrTdvzpdnV0inrpCbz9Sv6pd/V0Cnf&quot;</span>);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">33</span>; ++i )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( v3[i] != *(<span class="hljs-keyword">char</span> *)(i + a1) )<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>很明显，字符串比较，那我们只需要进行base64【改】解码<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172308875.png" srcset="/img/loading.gif" lazyload alt="image-20220802172308875"></p>
<h2 id="SUCTF2019-SignIn"><a href="#SUCTF2019-SignIn" class="headerlink" title="[SUCTF2019]SignIn"></a>[SUCTF2019]SignIn</h2><p>这道题本来是感觉麻烦，没想写，但是做完后感觉还是有很多东西值得记录<br />用IDA打开然后main函数反汇编</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function">__int64 __fastcall <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a1, <span class="hljs-keyword">char</span> **a2, <span class="hljs-keyword">char</span> **a3)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">char</span> n[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-4A0h] BYREF</span><br>  <span class="hljs-keyword">char</span> e[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+10h] [rbp-490h] BYREF</span><br>  <span class="hljs-keyword">char</span> m[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-480h] BYREF</span><br>  <span class="hljs-keyword">char</span> c[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+30h] [rbp-470h] BYREF</span><br>  <span class="hljs-keyword">char</span> flag1[<span class="hljs-number">112</span>]; <span class="hljs-comment">// [rsp+40h] [rbp-460h] BYREF</span><br>  <span class="hljs-keyword">char</span> flag2[<span class="hljs-number">1000</span>]; <span class="hljs-comment">// [rsp+B0h] [rbp-3F0h] BYREF</span><br>  <span class="hljs-keyword">unsigned</span> __int64 v10; <span class="hljs-comment">// [rsp+498h] [rbp-8h]</span><br><br>  v10 = __readfsqword(<span class="hljs-number">0x28</span>u);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;[sign in]&quot;</span>);<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;[input your flag]: &quot;</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%99s&quot;</span>, flag1);<br>  ASCII(flag1, flag2);<br>  __gmpz_init_set_str(c, <span class="hljs-string">&quot;ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35&quot;</span>, <span class="hljs-number">16LL</span>);<br>  __gmpz_init_set_str(m, flag2, <span class="hljs-number">16LL</span>);<br>  __gmpz_init_set_str(n, <span class="hljs-string">&quot;103461035900816914121390101299049044413950405173712170434161686539878160984549&quot;</span>, <span class="hljs-number">10LL</span>);<br>  __gmpz_init_set_str(e, <span class="hljs-string">&quot;65537&quot;</span>, <span class="hljs-number">10LL</span>);<br>  __gmpz_powm(m, m, e, n);<br>  <span class="hljs-keyword">if</span> ( __gmpz_cmp(m, c) )<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;GG!&quot;</span>);<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;TTTTTTTTTTql!&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0LL</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这里为了方便做题，改了一下部分函数和变量名称<br />这里的ASCII函数点进去</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">size_t</span> __fastcall <span class="hljs-title">jiami</span><span class="hljs-params">(<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *a1, __int64 a2)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">size_t</span> result; <span class="hljs-comment">// rax</span><br>  <span class="hljs-keyword">int</span> v3; <span class="hljs-comment">// [rsp+18h] [rbp-18h]</span><br>  <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [rsp+1Ch] [rbp-14h]</span><br><br>  v3 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; ; i += <span class="hljs-number">2</span> )<br>  &#123;<br>    result = <span class="hljs-built_in">strlen</span>(a1);<br>    <span class="hljs-keyword">if</span> ( v3 &gt;= result )<br>      <span class="hljs-keyword">break</span>;<br>    *(a2 + i) = byte_202010[a1[v3] &gt;&gt; <span class="hljs-number">4</span>];<br>    *(a2 + i + <span class="hljs-number">1LL</span>) = byte_202010[a1[v3++] &amp; <span class="hljs-number">0xF</span>];<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这个也没实力研究，记住是个16进制转ASCII码就可以了<br />然后返回主函数看后面，这里有几个函数可以说一下<br />__gmpz_init_set_str(rop,str,base):<br />将 str <a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%AD%97%E7%AC%A6%E6%95%B0%E7%BB%84&spm=1001.2101.3001.7020">字符数组</a>以 base 指定的进制解读成数值并写入 rop 所指向的内存  <br />__gmpz_powm(rop,base,exp,mod):<br /> 计算 base 的 exp 次方，并对 mod 取模，最后将结果写入 rop 中 <br />__gmpz_cmp(a,b)：a与b字符串比较，一样则返回0，否则为1<br />其实这道题跟RSA有密切关系<br />这是我根据反汇编整理出的，其中p，q用这个网站解的<a target="_blank" rel="noopener" href="http://www.factordb.com/">http://www.factordb.com/</a></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c">e=<span class="hljs-number">65537</span><br>n=<span class="hljs-number">103461035900816914121390101299049044413950405173712170434161686539878160984549</span><br>c=<span class="hljs-number">0</span>x ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35<br>p=<span class="hljs-number">282164587459512124844245113950593348271</span><br>q=<span class="hljs-number">366669102002966856876605669837014229419</span><br>d=?<br>m=？<br></code></pre></td></tr></table></figure>

<p>现在我们主要是求m，直接上脚本(py大佬的)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">import</span> gmpy2<br><br>e=<span class="hljs-number">65537</span><br>p=<span class="hljs-number">282164587459512124844245113950593348271</span><br>q=<span class="hljs-number">366669102002966856876605669837014229419</span><br>c=<span class="hljs-number">0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35</span><br>n=<span class="hljs-number">103461035900816914121390101299049044413950405173712170434161686539878160984549</span><br>d=gmpy2.invert(e,(p<span class="hljs-number">-1</span>)*(q<span class="hljs-number">-1</span>))<br>destr=gmpy2.powmod(c,d,n)<br>flag0 = hex(destr)[<span class="hljs-number">2</span>:]     # flag0类型为str，存的是十六进制表示的字符串<br>#[<span class="hljs-number">2</span>:]目的是把<span class="hljs-number">0</span>x抛去<br>flag1 = bytes.fromhex(flag0)  # 将其从十六进制转换为byte类型(此时已解释成字符)<br>flag = str(flag1, <span class="hljs-string">&#x27;utf-8&#x27;</span>)  # 将byte类型转换为str类型<br>print(flag)<br><br></code></pre></td></tr></table></figure>

<h2 id="MRCTF2020-hello-world-go"><a href="#MRCTF2020-hello-world-go" class="headerlink" title="[MRCTF2020]hello_world_go"></a>[MRCTF2020]hello_world_go</h2><p>这道题是用go语言写的，IDA版本够高这道题就很简单，我用的7.5的，搜字符串就搜不到<br />7.6的好像就能直接搜到，这个对于能看懂go语言的应该没啥难度<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172337814.png" srcset="/img/loading.gif" lazyload alt="image-20220802172337814"></p>
<h2 id="FlareOn4-IgniteMe"><a href="#FlareOn4-IgniteMe" class="headerlink" title="[FlareOn4]IgniteMe"></a>[FlareOn4]IgniteMe</h2><p>这个主要是学习的是动调<br />1.首先ida打开文件，打开字符串窗口，然后点进，之后反汇编<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172451025.png" srcset="/img/loading.gif" lazyload alt="image-20220802172451025"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">void</span> __noreturn <span class="hljs-title">start</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>  DWORD NumberOfBytesWritten; <span class="hljs-comment">// [esp+0h] [ebp-4h] BYREF</span><br><br>  NumberOfBytesWritten = <span class="hljs-number">0</span>;<br>  hFile = GetStdHandle(<span class="hljs-number">0xFFFFFFF6</span>);<br>  dword_403074 = GetStdHandle(<span class="hljs-number">0xFFFFFFF5</span>);<br>  WriteFile(dword_403074, aG1v3M3T3hFl4g, <span class="hljs-number">0x13</span>u, &amp;NumberOfBytesWritten, <span class="hljs-number">0</span>);<br>  sub_4010F0(NumberOfBytesWritten);  <span class="hljs-comment">//获取输入的字符串</span><br>  <span class="hljs-keyword">if</span> ( sub_401050() )<br>    WriteFile(dword_403074, aG00dJ0b, <span class="hljs-number">0xA</span>u, &amp;NumberOfBytesWritten, <span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">else</span><br>    WriteFile(dword_403074, aN0tT00H0tRWe7r, <span class="hljs-number">0x24</span>u, &amp;NumberOfBytesWritten, <span class="hljs-number">0</span>);<br>  ExitProcess(<span class="hljs-number">0</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>WriteFile在这里相当于printf<br />再看sub_4010F0(NumberOfBytesWritten)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">sub_4010F0</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> v0; <span class="hljs-comment">// eax</span><br>  <span class="hljs-keyword">char</span> Buffer[<span class="hljs-number">260</span>]; <span class="hljs-comment">// [esp+0h] [ebp-110h] BYREF</span><br>  DWORD NumberOfBytesRead; <span class="hljs-comment">// [esp+104h] [ebp-Ch] BYREF</span><br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [esp+108h] [ebp-8h]</span><br>  <span class="hljs-keyword">char</span> v5; <span class="hljs-comment">// [esp+10Fh] [ebp-1h]</span><br><br>  v5 = <span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">0x104</span>; ++i )<br>    Buffer[i] = <span class="hljs-number">0</span>;   <span class="hljs-comment">//变量初始化</span><br>  ReadFile(hFile, Buffer, <span class="hljs-number">0x104</span>u, &amp;NumberOfBytesRead, <span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; ; ++i )<br>  &#123;<br>    v0 = sub_401020(Buffer);  <span class="hljs-comment">//获取字符串的长度</span><br>    <span class="hljs-keyword">if</span> ( i &gt;= v0 )<br>      <span class="hljs-keyword">break</span>;<br>    v5 = Buffer[i];<br>    <span class="hljs-keyword">if</span> ( v5 != <span class="hljs-number">10</span> &amp;&amp; v5 != <span class="hljs-number">13</span> )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( v5 )<br>        byte_403078[i] = v5; <span class="hljs-comment">//输入的字符串都会赋给byte_403078</span><br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>最主要还得看sub_401050()</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">sub_401050</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">int</span> v1; <span class="hljs-comment">// [esp+0h] [ebp-Ch]</span><br>  <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [esp+4h] [ebp-8h]</span><br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> j; <span class="hljs-comment">// [esp+4h] [ebp-8h]</span><br>  <span class="hljs-keyword">char</span> v4; <span class="hljs-comment">// [esp+Bh] [ebp-1h]</span><br><br>  v1 = sub_401020(byte_403078);  <span class="hljs-comment">//获取长度</span><br>  v4 = sub_401000();  <span class="hljs-comment">//通过动调或者有的大佬用的计算器结合自己所学的硬解出来</span><br>  <span class="hljs-keyword">for</span> ( i = v1 - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; --i )<br>  &#123;<br>    byte_403180[i] = v4 ^ byte_403078[i];<br>    v4 = byte_403078[i];<br>  &#125;<br>  <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">0x27</span>; ++j )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( byte_403180[j] != (<span class="hljs-keyword">unsigned</span> __int8)byte_403000[j] )<br>      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>搞一下v4，直接ida动调就可以了，先在v4那块下断点<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172526087.png" srcset="/img/loading.gif" lazyload alt="image-20220802172526087"><br />然后点三角开始动调，先F5<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172544107.png" srcset="/img/loading.gif" lazyload alt="image.png">然后随便往程序输入字符回车，然后F8单步执行，点进v4，可知v4=4<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172601690.png" srcset="/img/loading.gif" lazyload alt="image-20220802172601690"><br />接下来就是异或，字符串比较，接下来就直接写脚本<br />c++初学，尝试了一下</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;string.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    <span class="hljs-keyword">char</span> byte_403180[<span class="hljs-number">100</span>] = &#123; <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x6C</span>,<br>                             <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x6E</span>,<br>                             <span class="hljs-number">0x56</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x13</span>,<br>                             <span class="hljs-number">0x17</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x69</span> &#125;;<br>    <span class="hljs-keyword">int</span> v4 = <span class="hljs-number">4</span>;<br>    <span class="hljs-keyword">int</span> v1 = <span class="hljs-built_in">strlen</span>(byte_403180);<br>    <span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">char</span> byte_403078[<span class="hljs-number">100</span>] = &#123; <span class="hljs-number">0</span> &#125;;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = v1 - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; --i)<br>    &#123;<br>        byte_403078[i] = v4 ^ byte_403180[i];<br>        v4 = byte_403078[i];<br>    &#125;<br>    <br>    cout &lt;&lt; <span class="hljs-string">&quot;flag&#123;&quot;</span>&lt;&lt;byte_403078&lt;&lt;<span class="hljs-string">&quot;&#125;&quot;</span>&lt;&lt; endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    <br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="WUSTCTF2020-Cr0ssfun"><a href="#WUSTCTF2020-Cr0ssfun" class="headerlink" title="[WUSTCTF2020]Cr0ssfun"></a>[WUSTCTF2020]Cr0ssfun</h2><p>这道题没什么思维难度<br />首先看反汇编</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **argv, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> **envp)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">char</span> v4[<span class="hljs-number">48</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-30h] BYREF</span><br><br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot; _    _ _   _ _____ _____   _____           &quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;| |  | | | | /  ___|_   _| /  ___|          &quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;| |  | | | | \\ `--.  | |   \\ `--.  ___  ___ &quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;| |/\\| | | | |`--. \\ | |    `--. \\/ _ \\/ __|&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\\  /\\  / |_| /\\__/ / | |   /\\__/ /  __/ (__ &quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot; \\/  \\/ \\___/\\____/  \\_/   \\____/ \\___|\\___|&quot;</span>);<br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Input the flag&quot;</span>);<br>    __isoc99_scanf(<span class="hljs-string">&quot;%s&quot;</span>, v4);<br>    <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)<span class="hljs-built_in">check</span>((__int64)v4) == <span class="hljs-number">1</span> )<br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;0ops, your flag seems fake.&quot;</span>);<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;==============================&quot;</span>);<br>    <span class="hljs-built_in">rewind</span>(_bss_start);<br>  &#125;<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Your flag is correct, go and submit it!&quot;</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>也就是让if判定成立就可以，点进去就会发现</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">_BOOL8 __fastcall <span class="hljs-title">iven_is_handsome</span><span class="hljs-params">(_BYTE *a1)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">return</span> a1[<span class="hljs-number">10</span>] == <span class="hljs-number">112</span><br>      &amp;&amp; a1[<span class="hljs-number">13</span>] == <span class="hljs-number">64</span><br>      &amp;&amp; a1[<span class="hljs-number">3</span>] == <span class="hljs-number">102</span><br>      &amp;&amp; a1[<span class="hljs-number">26</span>] == <span class="hljs-number">114</span><br>      &amp;&amp; a1[<span class="hljs-number">20</span>] == <span class="hljs-number">101</span><br>      &amp;&amp; (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)<span class="hljs-built_in">iven_is_c0ol</span>(a1);<br>&#125;<br><span class="hljs-function">_BOOL8 __fastcall <span class="hljs-title">iven_is_c0ol</span><span class="hljs-params">(_BYTE *a1)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">return</span> a1[<span class="hljs-number">7</span>] == <span class="hljs-number">48</span><br>      &amp;&amp; a1[<span class="hljs-number">16</span>] == <span class="hljs-number">95</span><br>      &amp;&amp; a1[<span class="hljs-number">11</span>] == <span class="hljs-number">112</span><br>      &amp;&amp; a1[<span class="hljs-number">23</span>] == <span class="hljs-number">101</span><br>      &amp;&amp; a1[<span class="hljs-number">30</span>] == <span class="hljs-number">117</span><br>      &amp;&amp; (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)<span class="hljs-built_in">iven_1s_educated</span>(a1);<br>&#125;<br><span class="hljs-function">_BOOL8 __fastcall <span class="hljs-title">iven_1s_educated</span><span class="hljs-params">(_BYTE *a1)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">return</span> *a1 == <span class="hljs-number">119</span> &amp;&amp; a1[<span class="hljs-number">6</span>] == <span class="hljs-number">50</span> &amp;&amp; a1[<span class="hljs-number">22</span>] == <span class="hljs-number">115</span> &amp;&amp; a1[<span class="hljs-number">31</span>] == <span class="hljs-number">110</span> &amp;&amp; a1[<span class="hljs-number">12</span>] == <span class="hljs-number">95</span> &amp;&amp; (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)<span class="hljs-built_in">iven_1s_brave</span>(a1);<br>&#125;<br><span class="hljs-function">_BOOL8 __fastcall <span class="hljs-title">iven_1s_brave</span><span class="hljs-params">(_BYTE *a1)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">return</span> a1[<span class="hljs-number">15</span>] == <span class="hljs-number">100</span><br>      &amp;&amp; a1[<span class="hljs-number">8</span>] == <span class="hljs-number">123</span><br>      &amp;&amp; a1[<span class="hljs-number">18</span>] == <span class="hljs-number">51</span><br>      &amp;&amp; a1[<span class="hljs-number">28</span>] == <span class="hljs-number">95</span><br>      &amp;&amp; a1[<span class="hljs-number">21</span>] == <span class="hljs-number">114</span><br>      &amp;&amp; (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)<span class="hljs-built_in">iven_1s_great</span>(a1);<br>&#125;<br><span class="hljs-function">_BOOL8 __fastcall <span class="hljs-title">iven_1s_great</span><span class="hljs-params">(_BYTE *a1)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">return</span> a1[<span class="hljs-number">2</span>] == <span class="hljs-number">116</span><br>      &amp;&amp; a1[<span class="hljs-number">9</span>] == <span class="hljs-number">99</span><br>      &amp;&amp; a1[<span class="hljs-number">32</span>] == <span class="hljs-number">125</span><br>      &amp;&amp; a1[<span class="hljs-number">19</span>] == <span class="hljs-number">118</span><br>      &amp;&amp; a1[<span class="hljs-number">5</span>] == <span class="hljs-number">48</span><br>      &amp;&amp; a1[<span class="hljs-number">14</span>] == <span class="hljs-number">110</span><br>      &amp;&amp; (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)<span class="hljs-built_in">iven_and_grace</span>(a1);<br>&#125;<br><span class="hljs-function">_BOOL8 __fastcall <span class="hljs-title">iven_and_grace</span><span class="hljs-params">(_BYTE *a1)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">return</span> a1[<span class="hljs-number">4</span>] == <span class="hljs-number">50</span> &amp;&amp; a1[<span class="hljs-number">17</span>] == <span class="hljs-number">114</span> &amp;&amp; a1[<span class="hljs-number">29</span>] == <span class="hljs-number">102</span> &amp;&amp; a1[<span class="hljs-number">17</span>] == <span class="hljs-number">114</span> &amp;&amp; a1[<span class="hljs-number">24</span>] == <span class="hljs-number">95</span> &amp;&amp; (<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span>)<span class="hljs-built_in">finally_fun</span>(a1);<br>&#125;<br><span class="hljs-function">_BOOL8 __fastcall <span class="hljs-title">finally_fun</span><span class="hljs-params">(_BYTE *a1)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">return</span> a1[<span class="hljs-number">1</span>] == <span class="hljs-number">99</span> &amp;&amp; a1[<span class="hljs-number">25</span>] == <span class="hljs-number">64</span> &amp;&amp; a1[<span class="hljs-number">27</span>] == <span class="hljs-number">101</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>就直接对着解对应的ASCII码就可以了</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cpp">a1=[<span class="hljs-number">119</span>,<span class="hljs-number">99</span>,<span class="hljs-number">116</span>,<span class="hljs-number">102</span>,<span class="hljs-number">50</span>,<span class="hljs-number">48</span>,<span class="hljs-number">50</span>,<span class="hljs-number">48</span>,<span class="hljs-number">123</span>,<span class="hljs-number">99</span>,<span class="hljs-number">112</span>,<span class="hljs-number">112</span>,<span class="hljs-number">95</span>,<span class="hljs-number">64</span>,<span class="hljs-number">110</span>,<span class="hljs-number">100</span>,<span class="hljs-number">95</span>,<span class="hljs-number">114</span>,<span class="hljs-number">51</span>,<span class="hljs-number">118</span>,<span class="hljs-number">101</span>,<span class="hljs-number">114</span>,<span class="hljs-number">115</span>,<span class="hljs-number">101</span>,<span class="hljs-number">95</span>,<span class="hljs-number">64</span>,<span class="hljs-number">114</span>,<span class="hljs-number">101</span>,<span class="hljs-number">95</span>,<span class="hljs-number">102</span>,<span class="hljs-number">117</span>,<span class="hljs-number">110</span>,<span class="hljs-number">125</span>]<br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i in <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(a1)):<br>    flag+=<span class="hljs-built_in">chr</span>(a1[i])<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<p>flag：wctf2020{cpp_@nd_r3verse_@re_fun}</p>
<h2 id="FlareOn6-Overlong"><a href="#FlareOn6-Overlong" class="headerlink" title="[FlareOn6]Overlong"></a>[FlareOn6]Overlong</h2><p>打开反汇编</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> __stdcall <span class="hljs-title">start</span><span class="hljs-params">(<span class="hljs-keyword">int</span> a1, <span class="hljs-keyword">int</span> a2, <span class="hljs-keyword">int</span> a3, <span class="hljs-keyword">int</span> a4)</span></span><br><span class="hljs-function"></span>&#123;<br>  CHAR Text[<span class="hljs-number">128</span>]; <span class="hljs-comment">// [esp+0h] [ebp-84h] BYREF</span><br>  <span class="hljs-keyword">int</span> v6; <span class="hljs-comment">// [esp+80h] [ebp-4h]</span><br><br>  v6 = <span class="hljs-built_in">sub_401160</span>(Text, &amp;unk_402008, <span class="hljs-number">28</span>);<br>  Text[v6] = <span class="hljs-number">0</span>;<br>  <span class="hljs-built_in">MessageBoxA</span>(<span class="hljs-number">0</span>, Text, Caption, <span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>看一下sub_401160</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">sub_401160</span><span class="hljs-params">(<span class="hljs-keyword">char</span> *a1, <span class="hljs-keyword">int</span> a2, <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> a3)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> i; <span class="hljs-comment">// [esp+4h] [ebp-4h]</span><br><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; a3; ++i )<br>  &#123;<br>    a2 += <span class="hljs-built_in">sub_401000</span>(a1, a2);<br>    <span class="hljs-keyword">if</span> ( !*a1++ )<br>      <span class="hljs-keyword">break</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> i;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>再看sub_401000，这个加密函数有点复杂</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> __cdecl <span class="hljs-title">sub_401000</span><span class="hljs-params">(_BYTE *a1, <span class="hljs-keyword">char</span> *a2)</span></span><br><span class="hljs-function"></span>&#123;<br>  <span class="hljs-keyword">int</span> v3; <span class="hljs-comment">// [esp+0h] [ebp-8h]</span><br>  <span class="hljs-keyword">char</span> v4; <span class="hljs-comment">// [esp+4h] [ebp-4h]</span><br><br>  <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">int</span>)(<span class="hljs-keyword">unsigned</span> __int8)*a2 &gt;&gt; <span class="hljs-number">3</span> == <span class="hljs-number">30</span> )<br>  &#123;<br>    v4 = a2[<span class="hljs-number">3</span>] &amp; <span class="hljs-number">0x3F</span> | ((a2[<span class="hljs-number">2</span>] &amp; <span class="hljs-number">0x3F</span>) &lt;&lt; <span class="hljs-number">6</span>);<br>    v3 = <span class="hljs-number">4</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">int</span>)(<span class="hljs-keyword">unsigned</span> __int8)*a2 &gt;&gt; <span class="hljs-number">4</span> == <span class="hljs-number">14</span> )<br>  &#123;<br>    v4 = a2[<span class="hljs-number">2</span>] &amp; <span class="hljs-number">0x3F</span> | ((a2[<span class="hljs-number">1</span>] &amp; <span class="hljs-number">0x3F</span>) &lt;&lt; <span class="hljs-number">6</span>);<br>    v3 = <span class="hljs-number">3</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ( (<span class="hljs-keyword">int</span>)(<span class="hljs-keyword">unsigned</span> __int8)*a2 &gt;&gt; <span class="hljs-number">5</span> == <span class="hljs-number">6</span> )<br>  &#123;<br>    v4 = a2[<span class="hljs-number">1</span>] &amp; <span class="hljs-number">0x3F</span> | ((*a2 &amp; <span class="hljs-number">0x1F</span>) &lt;&lt; <span class="hljs-number">6</span>);<br>    v3 = <span class="hljs-number">2</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v4 = *a2;<br>    v3 = <span class="hljs-number">1</span>;<br>  &#125;<br>  *a1 = v4;<br>  <span class="hljs-keyword">return</span> v3;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>但是这道题你会发现，没有让我们向程序中输入字符<br />运行程序也是只有一个弹窗，当然它也没壳，只不过这个弹窗好像是有什么东西还没告诉我们<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172629979.png" srcset="/img/loading.gif" lazyload alt="image-20220802172629979"><br />回过头看加密这一行</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp">v6 = <span class="hljs-built_in">sub_401160</span>(Text, &amp;unk_402008, <span class="hljs-number">28</span>);<br></code></pre></td></tr></table></figure>

<p>我们再看unk_402008，已经要大于28了，说明28这块应该是一个比较大的数</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><code class="hljs cpp">db <span class="hljs-number">0E0</span>h                 ; DATA XREF: start+B↑o<br>.rdata:<span class="hljs-number">00402009</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">0040200</span>A                 db  <span class="hljs-number">89</span>h<br>.rdata:<span class="hljs-number">0040200B</span>                 db <span class="hljs-number">0</span>C0h<br>.rdata:<span class="hljs-number">0040200</span>C                 db <span class="hljs-number">0</span>A0h<br>.rdata:<span class="hljs-number">0040200</span>D                 db <span class="hljs-number">0</span>C1h<br>.rdata:<span class="hljs-number">0040200</span>E                 db <span class="hljs-number">0</span>AEh<br>.rdata:<span class="hljs-number">0040200F</span>                 db <span class="hljs-number">0E0</span>h<br>.rdata:<span class="hljs-number">00402010</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">00402011</span>                 db <span class="hljs-number">0</span>A5h<br>.rdata:<span class="hljs-number">00402012</span>                 db <span class="hljs-number">0</span>C1h<br>.rdata:<span class="hljs-number">00402013</span>                 db <span class="hljs-number">0B</span>6h<br>.rdata:<span class="hljs-number">00402014</span>                 db <span class="hljs-number">0F</span>0h<br>.rdata:<span class="hljs-number">00402015</span>                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">00402016</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">00402017</span>                 db <span class="hljs-number">0</span>A5h<br>.rdata:<span class="hljs-number">00402018</span>                 db <span class="hljs-number">0E0</span>h<br>.rdata:<span class="hljs-number">00402019</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">0040201</span>A                 db <span class="hljs-number">0B</span>2h<br>.rdata:<span class="hljs-number">0040201B</span>                 db <span class="hljs-number">0F</span>0h<br>.rdata:<span class="hljs-number">0040201</span>C                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">0040201</span>D                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">0040201</span>E                 db <span class="hljs-number">0</span>A0h<br>.rdata:<span class="hljs-number">0040201F</span>                 db <span class="hljs-number">0E0</span>h<br>.rdata:<span class="hljs-number">00402020</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">00402021</span>                 db <span class="hljs-number">0</span>A2h<br>.rdata:<span class="hljs-number">00402022</span>                 db  <span class="hljs-number">72</span>h ; r<br>.rdata:<span class="hljs-number">00402023</span>                 db  <span class="hljs-number">6F</span>h ; o<br>.rdata:<span class="hljs-number">00402024</span>                 db <span class="hljs-number">0</span>C1h<br>.rdata:<span class="hljs-number">00402025</span>                 db <span class="hljs-number">0</span>ABh<br>.rdata:<span class="hljs-number">00402026</span>                 db  <span class="hljs-number">65</span>h ; e<br>.rdata:<span class="hljs-number">00402027</span>                 db <span class="hljs-number">0E0</span>h<br>.rdata:<span class="hljs-number">00402028</span>                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">00402029</span>                 db <span class="hljs-number">0</span>A0h<br>.rdata:<span class="hljs-number">0040202</span>A                 db <span class="hljs-number">0E0</span>h<br>.rdata:<span class="hljs-number">0040202B</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">0040202</span>C                 db <span class="hljs-number">0B</span>4h<br>.rdata:<span class="hljs-number">0040202</span>D                 db <span class="hljs-number">0E0</span>h<br>.rdata:<span class="hljs-number">0040202</span>E                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">0040202F</span>                 db <span class="hljs-number">0</span>A8h<br>.rdata:<span class="hljs-number">00402030</span>                 db <span class="hljs-number">0</span>C1h<br>.rdata:<span class="hljs-number">00402031</span>                 db <span class="hljs-number">0</span>A5h<br>.rdata:<span class="hljs-number">00402032</span>                 db  <span class="hljs-number">20</span>h<br>.rdata:<span class="hljs-number">00402033</span>                 db <span class="hljs-number">0</span>C1h<br>.rdata:<span class="hljs-number">00402034</span>                 db <span class="hljs-number">0</span>A5h<br>.rdata:<span class="hljs-number">00402035</span>                 db <span class="hljs-number">0E0</span>h<br>.rdata:<span class="hljs-number">00402036</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">00402037</span>                 db <span class="hljs-number">0</span>AEh<br>.rdata:<span class="hljs-number">00402038</span>                 db  <span class="hljs-number">63</span>h ; c<br>.rdata:<span class="hljs-number">00402039</span>                 db <span class="hljs-number">0</span>C1h<br>.rdata:<span class="hljs-number">0040203</span>A                 db <span class="hljs-number">0</span>AFh<br>.rdata:<span class="hljs-number">0040203B</span>                 db <span class="hljs-number">0E0</span>h<br>.rdata:<span class="hljs-number">0040203</span>C                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">0040203</span>D                 db <span class="hljs-number">0</span>A4h<br>.rdata:<span class="hljs-number">0040203</span>E                 db <span class="hljs-number">0F</span>0h<br>.rdata:<span class="hljs-number">0040203F</span>                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">00402040</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">00402041</span>                 db <span class="hljs-number">0</span>A9h<br>.rdata:<span class="hljs-number">00402042</span>                 db  <span class="hljs-number">6</span>Eh ; n<br>.rdata:<span class="hljs-number">00402043</span>                 db <span class="hljs-number">0</span>C1h<br>.rdata:<span class="hljs-number">00402044</span>                 db <span class="hljs-number">0</span>A7h<br>.rdata:<span class="hljs-number">00402045</span>                 db <span class="hljs-number">0</span>C0h<br>.rdata:<span class="hljs-number">00402046</span>                 db <span class="hljs-number">0B</span>Ah<br>.rdata:<span class="hljs-number">00402047</span>                 db  <span class="hljs-number">20</span>h<br>.rdata:<span class="hljs-number">00402048</span>                 db  <span class="hljs-number">49</span>h ; I<br>.rdata:<span class="hljs-number">00402049</span>                 db <span class="hljs-number">0F</span>0h<br>.rdata:<span class="hljs-number">0040204</span>A                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">0040204B</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">0040204</span>C                 db  <span class="hljs-number">9F</span>h<br>.rdata:<span class="hljs-number">0040204</span>D                 db <span class="hljs-number">0</span>C1h<br>.rdata:<span class="hljs-number">0040204</span>E                 db <span class="hljs-number">0</span>A1h<br>.rdata:<span class="hljs-number">0040204F</span>                 db <span class="hljs-number">0</span>C1h<br>.rdata:<span class="hljs-number">00402050</span>                 db  <span class="hljs-number">9F</span>h<br>.rdata:<span class="hljs-number">00402051</span>                 db <span class="hljs-number">0</span>C1h<br>.rdata:<span class="hljs-number">00402052</span>                 db  <span class="hljs-number">8</span>Dh<br>.rdata:<span class="hljs-number">00402053</span>                 db <span class="hljs-number">0E0</span>h<br>.rdata:<span class="hljs-number">00402054</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">00402055</span>                 db  <span class="hljs-number">9F</span>h<br>.rdata:<span class="hljs-number">00402056</span>                 db <span class="hljs-number">0</span>C1h<br>.rdata:<span class="hljs-number">00402057</span>                 db <span class="hljs-number">0B</span>4h<br>.rdata:<span class="hljs-number">00402058</span>                 db <span class="hljs-number">0F</span>0h<br>.rdata:<span class="hljs-number">00402059</span>                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">0040205</span>A                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">0040205B</span>                 db  <span class="hljs-number">9F</span>h<br>.rdata:<span class="hljs-number">0040205</span>C                 db <span class="hljs-number">0F</span>0h<br>.rdata:<span class="hljs-number">0040205</span>D                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">0040205</span>E                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">0040205F</span>                 db <span class="hljs-number">0</span>A8h<br>.rdata:<span class="hljs-number">00402060</span>                 db <span class="hljs-number">0</span>C1h<br>.rdata:<span class="hljs-number">00402061</span>                 db  <span class="hljs-number">9F</span>h<br>.rdata:<span class="hljs-number">00402062</span>                 db <span class="hljs-number">0F</span>0h<br>.rdata:<span class="hljs-number">00402063</span>                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">00402064</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">00402065</span>                 db <span class="hljs-number">0</span>A5h<br>.rdata:<span class="hljs-number">00402066</span>                 db <span class="hljs-number">0E0</span>h<br>.rdata:<span class="hljs-number">00402067</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">00402068</span>                 db  <span class="hljs-number">9F</span>h<br>.rdata:<span class="hljs-number">00402069</span>                 db <span class="hljs-number">0</span>C1h<br>.rdata:<span class="hljs-number">0040206</span>A                 db <span class="hljs-number">0</span>A5h<br>.rdata:<span class="hljs-number">0040206B</span>                 db <span class="hljs-number">0E0</span>h<br>.rdata:<span class="hljs-number">0040206</span>C                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">0040206</span>D                 db  <span class="hljs-number">9F</span>h<br>.rdata:<span class="hljs-number">0040206</span>E                 db <span class="hljs-number">0F</span>0h<br>.rdata:<span class="hljs-number">0040206F</span>                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">00402070</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">00402071</span>                 db <span class="hljs-number">0</span>AEh<br>.rdata:<span class="hljs-number">00402072</span>                 db <span class="hljs-number">0</span>C1h<br>.rdata:<span class="hljs-number">00402073</span>                 db  <span class="hljs-number">9F</span>h<br>.rdata:<span class="hljs-number">00402074</span>                 db <span class="hljs-number">0F</span>0h<br>.rdata:<span class="hljs-number">00402075</span>                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">00402076</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">00402077</span>                 db  <span class="hljs-number">83</span>h<br>.rdata:<span class="hljs-number">00402078</span>                 db <span class="hljs-number">0</span>C1h<br>.rdata:<span class="hljs-number">00402079</span>                 db  <span class="hljs-number">9F</span>h<br>.rdata:<span class="hljs-number">0040207</span>A                 db <span class="hljs-number">0E0</span>h<br>.rdata:<span class="hljs-number">0040207B</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">0040207</span>C                 db <span class="hljs-number">0</span>AFh<br>.rdata:<span class="hljs-number">0040207</span>D                 db <span class="hljs-number">0E0</span>h<br>.rdata:<span class="hljs-number">0040207</span>E                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">0040207F</span>                 db  <span class="hljs-number">9F</span>h<br>.rdata:<span class="hljs-number">00402080</span>                 db <span class="hljs-number">0</span>C1h<br>.rdata:<span class="hljs-number">00402081</span>                 db  <span class="hljs-number">84</span>h<br>.rdata:<span class="hljs-number">00402082</span>                 db  <span class="hljs-number">5F</span>h ; _<br>.rdata:<span class="hljs-number">00402083</span>                 db <span class="hljs-number">0E0</span>h<br>.rdata:<span class="hljs-number">00402084</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">00402085</span>                 db <span class="hljs-number">0</span>A9h<br>.rdata:<span class="hljs-number">00402086</span>                 db <span class="hljs-number">0F</span>0h<br>.rdata:<span class="hljs-number">00402087</span>                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">00402088</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">00402089</span>                 db  <span class="hljs-number">9F</span>h<br>.rdata:<span class="hljs-number">0040208</span>A                 db  <span class="hljs-number">6</span>Eh ; n<br>.rdata:<span class="hljs-number">0040208B</span>                 db <span class="hljs-number">0E0</span>h<br>.rdata:<span class="hljs-number">0040208</span>C                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">0040208</span>D                 db  <span class="hljs-number">9F</span>h<br>.rdata:<span class="hljs-number">0040208</span>E                 db <span class="hljs-number">0E0</span>h<br>.rdata:<span class="hljs-number">0040208F</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">00402090</span>                 db <span class="hljs-number">0</span>A7h<br>.rdata:<span class="hljs-number">00402091</span>                 db <span class="hljs-number">0E0</span>h<br>.rdata:<span class="hljs-number">00402092</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">00402093</span>                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">00402094</span>                 db <span class="hljs-number">0F</span>0h<br>.rdata:<span class="hljs-number">00402095</span>                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">00402096</span>                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">00402097</span>                 db <span class="hljs-number">0</span>A6h<br>.rdata:<span class="hljs-number">00402098</span>                 db <span class="hljs-number">0F</span>0h<br>.rdata:<span class="hljs-number">00402099</span>                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">0040209</span>A                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">0040209B</span>                 db <span class="hljs-number">0</span>ACh<br>.rdata:<span class="hljs-number">0040209</span>C                 db <span class="hljs-number">0E0</span>h<br>.rdata:<span class="hljs-number">0040209</span>D                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">0040209</span>E                 db <span class="hljs-number">0</span>A1h<br>.rdata:<span class="hljs-number">0040209F</span>                 db <span class="hljs-number">0</span>C1h<br>.rdata:<span class="hljs-number">004020</span>A0                 db <span class="hljs-number">0B</span>2h<br>.rdata:<span class="hljs-number">004020</span>A1                 db <span class="hljs-number">0</span>C1h<br>.rdata:<span class="hljs-number">004020</span>A2                 db <span class="hljs-number">0</span>A5h<br>.rdata:<span class="hljs-number">004020</span>A3                 db <span class="hljs-number">0F</span>0h<br>.rdata:<span class="hljs-number">004020</span>A4                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">004020</span>A5                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">004020</span>A6                 db <span class="hljs-number">0</span>ADh<br>.rdata:<span class="hljs-number">004020</span>A7                 db <span class="hljs-number">0F</span>0h<br>.rdata:<span class="hljs-number">004020</span>A8                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">004020</span>A9                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">004020</span>AA                 db <span class="hljs-number">0</span>AFh<br>.rdata:<span class="hljs-number">004020</span>AB                 db  <span class="hljs-number">6</span>Eh ; n<br>.rdata:<span class="hljs-number">004020</span>AC                 db <span class="hljs-number">0</span>C0h<br>.rdata:<span class="hljs-number">004020</span>AD                 db <span class="hljs-number">0</span>AEh<br>.rdata:<span class="hljs-number">004020</span>AE                 db <span class="hljs-number">0F</span>0h<br>.rdata:<span class="hljs-number">004020</span>AF                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">004020B</span>0                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">004020B</span>1                 db <span class="hljs-number">0</span>A3h<br>.rdata:<span class="hljs-number">004020B</span>2                 db  <span class="hljs-number">6F</span>h ; o<br>.rdata:<span class="hljs-number">004020B</span>3                 db <span class="hljs-number">0F</span>0h<br>.rdata:<span class="hljs-number">004020B</span>4                 db  <span class="hljs-number">80</span>h ; €<br>.rdata:<span class="hljs-number">004020B</span>5                 db  <span class="hljs-number">81</span>h<br>.rdata:<span class="hljs-number">004020B</span>6                 db <span class="hljs-number">0</span>ADh<br></code></pre></td></tr></table></figure>

<p>我在这里下了个断点<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172652187.png" srcset="/img/loading.gif" lazyload alt="image-20220802172652187"><br />然后动调也就跟着运行到这里，0x1C就是28<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172735875.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />那我们先用OD看一下<br />把这一块改成AF，因为总共有0xAF个数据<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172943319.png" srcset="/img/loading.gif" lazyload alt="image-20220802172754180"><br />但是改完程序没法运行，这个时候我们就要用到010Editor，搜1C然后把1C改成AF<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172754180.png" srcset="/img/loading.gif" lazyload alt="image-20220802172811880"><br />保存运行<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802172811880.png" srcset="/img/loading.gif" lazyload alt="image.png"></p>
<h3 id="疑惑："><a href="#疑惑：" class="headerlink" title="疑惑："></a>疑惑：</h3><p>为什么不能直接改？<br />用010Editor改过的程序再用OD打开可以看到这里是push -0x51<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802173027002.png" srcset="/img/loading.gif" lazyload alt="image-20220802173027002"></p>
<h2 id="UTCTF2020-basic-re"><a href="#UTCTF2020-basic-re" class="headerlink" title="[UTCTF2020]basic-re"></a>[UTCTF2020]basic-re</h2><p>flag<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802173041206.png" srcset="/img/loading.gif" lazyload alt="image-20220802173041206"></p>
<h2 id="BJDCTF2020-BJD-hamburger-competition"><a href="#BJDCTF2020-BJD-hamburger-competition" class="headerlink" title="[BJDCTF2020]BJD hamburger competition"></a>[BJDCTF2020]BJD hamburger competition</h2><p>首先下好文件，映入眼帘的是老八汉堡店<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802173059279.png" srcset="/img/loading.gif" lazyload alt="image-20220802173059279"><br />然后我玩了一会发现并没有什么可以触发flag的东西<br />我们需要知道Unity3D一般是C#写的，这个东西反汇编用的是ILSpy<br />反汇编BJD hamburger competition_Data\Managed\Assembly-CSharp.dll<br />一般C#需要反汇编的都是这么个路径<br />然后File-&gt;Save Code到一个空文件夹<br />双击即可<img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802173119806.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />查找线索字符<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802173139929.png" srcset="/img/loading.gif" lazyload alt="image-20220802173139929"><br />然后我们需要先sha1解密str，然后md5加密<br />str=1001<br />但就在md5加密这里就出现了问题<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802173158271.png" srcset="/img/loading.gif" lazyload alt="image-20220802173158271"><br />会发现这些交哪个都不对<br />需要看一下这里md5加密的方法</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">string</span> <span class="hljs-title">Md5</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> str</span>)</span><br>&#123;<br>    <span class="hljs-built_in">byte</span>[] bytes = Encoding.UTF8.GetBytes(str);<br>    <span class="hljs-built_in">byte</span>[] arg_1D_0 = MD5.Create().ComputeHash(bytes);<br>    StringBuilder stringBuilder = <span class="hljs-keyword">new</span> StringBuilder();<br>    <span class="hljs-built_in">byte</span>[] array = arg_1D_0;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; array.Length; i++)<br>    &#123;<br>        <span class="hljs-built_in">byte</span> b = array[i];<br>        stringBuilder.Append(b.ToString(<span class="hljs-string">&quot;X2&quot;</span>));<br>    &#125;<br>    <span class="hljs-keyword">return</span> stringBuilder.ToString().Substring(<span class="hljs-number">0</span>, <span class="hljs-number">20</span>);<br>	&#125;<br></code></pre></td></tr></table></figure>

<p>ToString(“X2”)是告诉我们是需要大写的<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802173212318.png" srcset="/img/loading.gif" lazyload alt="image-20220802173212318"><br />看最后一行，搜一下Substring()<br /><img src="https://save-img-1303838282.cos.ap-nanjing.myqcloud.com/image-20220802173241091.png" srcset="/img/loading.gif" lazyload alt="image.png"><br />也就是说只需要20个字符<br />flag{B8C37E33DEFDE51CF91E1E03E}</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/RE/" class="category-chain-item">RE</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/BUUCTF/">#BUUCTF</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>BUUCTF RE（一）</div>
      <div>http://mywangzai.github.io/2022/08/02/BUUCTFRE（一）/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>旺仔</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年8月2日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/08/05/c-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/" title="c++学习笔记（一）">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">c++学习笔记（一）</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/04/28/C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0base64%E5%8A%A0%E5%AF%86/" title="C语言实现base64加密">
                        <span class="hidden-mobile">C语言实现base64加密</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
